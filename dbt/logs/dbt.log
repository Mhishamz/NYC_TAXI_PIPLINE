[0m14:11:22.561112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596066bb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596049beb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596049be9e0>]}


============================== 14:11:22.601646 | f5162fa8-8bde-4db8-898a-d849f70efda5 ==============================
[0m14:11:22.601646 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:11:22.602455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /dbt --project-dir /dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:11:22.755924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5162fa8-8bde-4db8-898a-d849f70efda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596049bee00>]}
[0m14:11:22.769683 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ng4uh6nj'
[0m14:11:22.770344 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:11:22.879881 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:11:22.881608 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:11:22.971605 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:11:22.981050 [info ] [MainThread]: Updating lock file in file path: /dbt/package-lock.yml
[0m14:11:22.983143 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pc7s7qgr'
[0m14:11:22.986785 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:11:23.209041 [info ] [MainThread]: Installed from version 1.1.1
[0m14:11:23.209736 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:11:23.210317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f5162fa8-8bde-4db8-898a-d849f70efda5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75960494f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75960494c520>]}
[0m14:11:23.210872 [info ] [MainThread]: 
[0m14:11:23.211346 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:11:23.213507 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.72930396, "process_user_time": 2.168851, "process_kernel_time": 0.221792, "process_mem_max_rss": "91656", "process_in_blocks": "76464", "process_out_blocks": "2848"}
[0m14:11:23.214397 [debug] [MainThread]: Command `dbt deps` succeeded at 14:11:23.214206 after 0.73 seconds
[0m14:11:23.215453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596066bb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596049be9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596049be770>]}
[0m14:11:23.216082 [debug] [MainThread]: Flushing usage events
[0m14:51:33.996098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ee29d1cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ee31b1ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ee0cd5000>]}


============================== 14:51:34.005046 | 5e431708-0b58-4bf4-b4fd-239b65f576ca ==============================
[0m14:51:34.005046 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:51:34.005716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /dbt --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m14:51:34.098578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e431708-0b58-4bf4-b4fd-239b65f576ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ee175e710>]}
[0m14:51:34.119610 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-byupiz1d'
[0m14:51:34.120109 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:51:34.186790 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:51:34.188309 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:51:34.255856 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:51:34.272791 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:51:34.487511 [info ] [MainThread]: Installed from version 1.1.1
[0m14:51:34.488119 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:51:34.488729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5e431708-0b58-4bf4-b4fd-239b65f576ca', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ee0c5d270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ee0c1ead0>]}
[0m14:51:34.489302 [info ] [MainThread]: 
[0m14:51:34.489794 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:51:34.491753 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.53937817, "process_user_time": 2.124142, "process_kernel_time": 0.187162, "process_mem_max_rss": "91500", "process_in_blocks": "41864", "process_out_blocks": "2840"}
[0m14:51:34.492371 [debug] [MainThread]: Command `dbt deps` succeeded at 14:51:34.492239 after 0.54 seconds
[0m14:51:34.492701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ee29d1cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ee0cbc100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ee0cd6f80>]}
[0m14:51:34.493077 [debug] [MainThread]: Flushing usage events
[0m15:54:52.523997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e96de4bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e96c135210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e96c134f70>]}


============================== 15:54:52.549119 | f32e4fe2-76dd-4d7d-a4a8-8b81a392714b ==============================
[0m15:54:52.549119 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:54:52.550209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /dbt --project-dir /dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:54:52.643649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f32e4fe2-76dd-4d7d-a4a8-8b81a392714b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e96cbba6b0>]}
[0m15:54:52.672063 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-v5cf3x6t'
[0m15:54:52.672521 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:54:53.451720 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:54:53.453399 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:54:54.016951 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:54:54.022744 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:54:54.247579 [info ] [MainThread]: Installed from version 1.1.1
[0m15:54:54.248230 [info ] [MainThread]: Updated version available: 1.3.3
[0m15:54:54.248864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f32e4fe2-76dd-4d7d-a4a8-8b81a392714b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e96c07f1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e96c07f7f0>]}
[0m15:54:54.249268 [info ] [MainThread]: 
[0m15:54:54.249678 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m15:54:54.250946 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.8348492, "process_user_time": 2.217552, "process_kernel_time": 0.192569, "process_mem_max_rss": "91476", "process_in_blocks": "78672", "process_out_blocks": "2840"}
[0m15:54:54.251452 [debug] [MainThread]: Command `dbt deps` succeeded at 15:54:54.251334 after 1.84 seconds
[0m15:54:54.251815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e96de4bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e96c0c4730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e96c136e30>]}
[0m15:54:54.252171 [debug] [MainThread]: Flushing usage events
[0m22:44:57.231806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da51d03730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da4ffbab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da4ffbb550>]}


============================== 22:44:57.414436 | d56b13cd-d7d1-4303-abcb-d0d31875d85d ==============================
[0m22:44:57.414436 [info ] [MainThread]: Running with dbt=1.7.4
[0m22:44:57.415268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /dbt --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m22:44:57.513573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd56b13cd-d7d1-4303-abcb-d0d31875d85d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da50a9e620>]}
[0m22:44:57.559030 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-n22dqsb4'
[0m22:44:57.559575 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:44:57.685020 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:44:57.687645 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:44:57.744350 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:44:57.750653 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:44:57.976380 [info ] [MainThread]: Installed from version 1.1.1
[0m22:44:57.976902 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:44:57.977490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd56b13cd-d7d1-4303-abcb-d0d31875d85d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da4fdaac80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da4fda9f00>]}
[0m22:44:57.977914 [info ] [MainThread]: 
[0m22:44:57.978296 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:44:57.979605 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.90843785, "process_user_time": 2.297693, "process_kernel_time": 0.226772, "process_mem_max_rss": "91916", "process_in_blocks": "78840", "process_out_blocks": "2840"}
[0m22:44:57.980124 [debug] [MainThread]: Command `dbt deps` succeeded at 22:44:57.980000 after 0.91 seconds
[0m22:44:57.980481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da51d03730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da4ff42e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da4ffb9e40>]}
[0m22:44:57.980848 [debug] [MainThread]: Flushing usage events
[0m23:02:19.375301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c0a1a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bec92230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bec921d0>]}


============================== 23:02:19.379130 | ec3ddfea-7e8f-4933-99f1-09657a6cae08 ==============================
[0m23:02:19.379130 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:02:19.379827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt --select silver', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:02:20.301302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec3ddfea-7e8f-4933-99f1-09657a6cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bec922f0>]}
[0m23:02:20.394847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec3ddfea-7e8f-4933-99f1-09657a6cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bd244dc0>]}
[0m23:02:20.396382 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m23:02:20.410199 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:02:20.410799 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:02:20.411195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ec3ddfea-7e8f-4933-99f1-09657a6cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bd40dcf0>]}
[0m23:02:22.186891 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_taxi.bronze
[0m23:02:22.192544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec3ddfea-7e8f-4933-99f1-09657a6cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bca3d570>]}
[0m23:02:22.211932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec3ddfea-7e8f-4933-99f1-09657a6cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bc89fcd0>]}
[0m23:02:22.212527 [info ] [MainThread]: Found 4 models, 51 tests, 1 source, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m23:02:22.212969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec3ddfea-7e8f-4933-99f1-09657a6cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bc8a2500>]}
[0m23:02:22.215447 [info ] [MainThread]: 
[0m23:02:22.216644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:02:22.221883 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw'
[0m23:02:22.237454 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw"
[0m23:02:22.237870 [debug] [ThreadPool]: On list_nyc_taxi_dw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:02:22.238193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:22.262834 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:02:22.264303 [debug] [ThreadPool]: On list_nyc_taxi_dw: Close
[0m23:02:22.267269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw, now create_nyc_taxi_dw_public_silver)
[0m23:02:22.268065 [debug] [ThreadPool]: Creating schema "database: "nyc_taxi_dw"
schema: "public_silver"
"
[0m23:02:22.273355 [debug] [ThreadPool]: Using postgres connection "create_nyc_taxi_dw_public_silver"
[0m23:02:22.273698 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_silver: BEGIN
[0m23:02:22.273988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:02:22.279133 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:02:22.279742 [debug] [ThreadPool]: Using postgres connection "create_nyc_taxi_dw_public_silver"
[0m23:02:22.280204 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "create_nyc_taxi_dw_public_silver"} */
create schema if not exists "public_silver"
[0m23:02:22.298479 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:02:22.301680 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_silver: COMMIT
[0m23:02:22.302081 [debug] [ThreadPool]: Using postgres connection "create_nyc_taxi_dw_public_silver"
[0m23:02:22.302421 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_silver: COMMIT
[0m23:02:22.303386 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:02:22.303730 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_silver: Close
[0m23:02:22.306147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nyc_taxi_dw_public_silver, now list_nyc_taxi_dw_public_gold)
[0m23:02:22.307047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw_public_silver'
[0m23:02:22.312877 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:02:22.315023 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:02:22.315396 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: BEGIN
[0m23:02:22.315731 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: BEGIN
[0m23:02:22.316032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:02:22.316349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:22.331880 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:02:22.332638 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:02:22.333681 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_silver"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m23:02:22.333053 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:02:22.334229 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:02:22.334765 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_gold"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m23:02:22.352636 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:02:22.354929 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: ROLLBACK
[0m23:02:22.353269 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:02:22.356504 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: ROLLBACK
[0m23:02:22.356941 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: Close
[0m23:02:22.357267 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: Close
[0m23:02:22.365134 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:22.365641 [debug] [MainThread]: On master: BEGIN
[0m23:02:22.366032 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:02:22.372017 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:02:22.372362 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:22.372762 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:02:22.378840 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:02:22.380223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec3ddfea-7e8f-4933-99f1-09657a6cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bd1c4340>]}
[0m23:02:22.380869 [debug] [MainThread]: On master: ROLLBACK
[0m23:02:22.381308 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:22.381642 [debug] [MainThread]: On master: BEGIN
[0m23:02:22.382162 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:02:22.382495 [debug] [MainThread]: On master: COMMIT
[0m23:02:22.382781 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:22.383054 [debug] [MainThread]: On master: COMMIT
[0m23:02:22.383444 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:02:22.383752 [debug] [MainThread]: On master: Close
[0m23:02:22.384593 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:02:22.385217 [info ] [MainThread]: 
[0m23:02:22.403601 [debug] [Thread-1 (]: Began running node model.nyc_taxi.cleaned_taxi_trips
[0m23:02:22.404279 [info ] [Thread-1 (]: 1 of 1 START sql table model public_silver.cleaned_taxi_trips .................. [RUN]
[0m23:02:22.405184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw_public_silver, now model.nyc_taxi.cleaned_taxi_trips)
[0m23:02:22.405625 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi.cleaned_taxi_trips
[0m23:02:22.418653 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi.cleaned_taxi_trips"
[0m23:02:22.419876 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.cleaned_taxi_trips (compile): 23:02:22.405824 => 23:02:22.419562
[0m23:02:22.420391 [debug] [Thread-1 (]: Began executing node model.nyc_taxi.cleaned_taxi_trips
[0m23:02:22.462708 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi.cleaned_taxi_trips"
[0m23:02:22.463826 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:02:22.464378 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: BEGIN
[0m23:02:22.464792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:22.469962 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:02:22.470393 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:02:22.470997 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

  
    

  create  table "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips__dbt_tmp"
  
  
    as
  
  (
    

/*
  Silver Layer: cleaned_taxi_trips
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Transforms raw bronze strings into typed, cleaned, validated records.
  Business rules applied:
    - Cast all numeric strings to NUMERIC/INTEGER
    - Parse datetimes from ISO strings
    - Derive trip duration, speed, per-mile cost
    - Map payment_type codes to labels
    - Filter obvious bad records (negative fares, zero distance, etc.)
    - Deduplicate on business key
*/

WITH source AS (

    SELECT *
    FROM "nyc_taxi_dw"."bronze"."raw_taxi_trips"

),

cast_and_clean AS (

    SELECT
        ingestion_id,
        batch_id,
        ingested_at,

        -- Vendor
        NULLIF(TRIM(vendor_id), '')::INTEGER                       AS vendor_id,

        -- Timestamps
        tpep_pickup_datetime::TIMESTAMP                            AS pickup_datetime,
        tpep_dropoff_datetime::TIMESTAMP                           AS dropoff_datetime,

        -- Passengers & distance
        NULLIF(TRIM(passenger_count), '')::INTEGER                 AS passenger_count,
        NULLIF(TRIM(trip_distance), '')::NUMERIC(10, 2)            AS trip_distance_miles,

        -- Location IDs
        NULLIF(TRIM(pu_location_id), '')::INTEGER                  AS pickup_location_id,
        NULLIF(TRIM(do_location_id), '')::INTEGER                  AS dropoff_location_id,

        -- Rate & flags
        NULLIF(TRIM(rate_code_id), '')::INTEGER                    AS rate_code_id,
        TRIM(store_and_fwd_flag)                                   AS store_and_fwd_flag,

        -- Payment
        NULLIF(TRIM(payment_type), '')::INTEGER                    AS payment_type_code,
        CASE TRIM(payment_type)
            WHEN '1' THEN 'Credit Card'
            WHEN '2' THEN 'Cash'
            WHEN '3' THEN 'No Charge'
            WHEN '4' THEN 'Dispute'
            WHEN '5' THEN 'Unknown'
            WHEN '6' THEN 'Voided Trip'
            ELSE          'Other'
        END                                                        AS payment_type_label,

        -- Fare components
        NULLIF(TRIM(fare_amount), '')::NUMERIC(10, 2)              AS fare_amount,
        NULLIF(TRIM(extra), '')::NUMERIC(10, 2)                    AS extra,
        NULLIF(TRIM(mta_tax), '')::NUMERIC(10, 2)                  AS mta_tax,
        NULLIF(TRIM(tip_amount), '')::NUMERIC(10, 2)               AS tip_amount,
        NULLIF(TRIM(tolls_amount), '')::NUMERIC(10, 2)             AS tolls_amount,
        NULLIF(TRIM(improvement_surcharge), '')::NUMERIC(10, 2)    AS improvement_surcharge,
        NULLIF(TRIM(congestion_surcharge), '')::NUMERIC(10, 2)     AS congestion_surcharge,
        NULLIF(TRIM(airport_fee), '')::NUMERIC(10, 2)              AS airport_fee,
        NULLIF(TRIM(total_amount), '')::NUMERIC(10, 2)             AS total_amount

    FROM source
    WHERE tpep_pickup_datetime IS NOT NULL
      AND tpep_dropoff_datetime IS NOT NULL
      AND total_amount IS NOT NULL

),

enrich AS (

    SELECT
        *,
        -- Derived metrics
        EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) / 60.0
                                                                    AS trip_duration_mins,
        CASE
            WHEN trip_distance_miles > 0
             AND EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) > 0
            THEN trip_distance_miles
                 / (EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) / 3600.0)
            ELSE NULL
        END                                                         AS avg_speed_mph,
        CASE
            WHEN trip_distance_miles > 0
            THEN total_amount / trip_distance_miles
            ELSE NULL
        END                                                         AS cost_per_mile,
        CASE
            WHEN total_amount > 0
            THEN tip_amount / total_amount
            ELSE 0
        END                                                         AS tip_percentage,

        -- Date parts for partitioning / BI
        DATE(pickup_datetime)                                       AS pickup_date,
        EXTRACT(HOUR FROM pickup_datetime)::INTEGER                 AS pickup_hour,
        TO_CHAR(pickup_datetime, 'Day')                            AS pickup_day_of_week,
        EXTRACT(MONTH FROM pickup_datetime)::INTEGER                AS pickup_month,
        EXTRACT(YEAR FROM pickup_datetime)::INTEGER                 AS pickup_year

    FROM cast_and_clean

),

deduplicated AS (

    SELECT *,
        ROW_NUMBER() OVER (
            PARTITION BY pickup_datetime, dropoff_datetime, vendor_id, total_amount
            ORDER BY ingestion_id DESC
        ) AS rn
    FROM enrich

),

validated AS (

    SELECT *
    FROM deduplicated
    WHERE rn = 1
      -- Business rule filters
      AND total_amount  > 0
      AND fare_amount   >= 0
      AND trip_distance_miles >= 0
      AND passenger_count BETWEEN 1 AND 8
      AND trip_duration_mins BETWEEN 1 AND 360  -- 1 min to 6 hrs
      AND pickup_datetime < dropoff_datetime

)

SELECT
    -- Surrogate key
    md5(cast(coalesce(cast(pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                                           AS trip_id,

    ingestion_id,
    batch_id,
    ingested_at,
    vendor_id,
    pickup_datetime,
    dropoff_datetime,
    pickup_date,
    pickup_hour,
    pickup_day_of_week,
    pickup_month,
    pickup_year,
    passenger_count,
    trip_distance_miles,
    pickup_location_id,
    dropoff_location_id,
    rate_code_id,
    store_and_fwd_flag,
    payment_type_code,
    payment_type_label,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    congestion_surcharge,
    airport_fee,
    total_amount,
    trip_duration_mins,
    avg_speed_mph,
    cost_per_mile,
    tip_percentage

FROM validated
  );
  
[0m23:02:22.544546 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "4.0"

[0m23:02:22.545076 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: ROLLBACK
[0m23:02:22.545784 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.cleaned_taxi_trips (execute): 23:02:22.420723 => 23:02:22.545540
[0m23:02:22.546208 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: Close
[0m23:02:22.553295 [debug] [Thread-1 (]: Database Error in model cleaned_taxi_trips (models/silver/cleaned_taxi_trips.sql)
  invalid input syntax for type integer: "4.0"
  compiled Code at target/run/nyc_taxi/models/silver/cleaned_taxi_trips.sql
[0m23:02:22.553927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec3ddfea-7e8f-4933-99f1-09657a6cae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bd40e170>]}
[0m23:02:22.554833 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_silver.cleaned_taxi_trips ......... [[31mERROR[0m in 0.15s]
[0m23:02:22.555976 [debug] [Thread-1 (]: Finished running node model.nyc_taxi.cleaned_taxi_trips
[0m23:02:22.557972 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:22.558568 [debug] [MainThread]: On master: BEGIN
[0m23:02:22.559065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:02:22.565639 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:02:22.565990 [debug] [MainThread]: On master: COMMIT
[0m23:02:22.566300 [debug] [MainThread]: Using postgres connection "master"
[0m23:02:22.566613 [debug] [MainThread]: On master: COMMIT
[0m23:02:22.567007 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:02:22.567317 [debug] [MainThread]: On master: Close
[0m23:02:22.568124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:22.568530 [debug] [MainThread]: Connection 'list_nyc_taxi_dw_public_gold' was properly closed.
[0m23:02:22.568858 [debug] [MainThread]: Connection 'model.nyc_taxi.cleaned_taxi_trips' was properly closed.
[0m23:02:22.569231 [info ] [MainThread]: 
[0m23:02:22.569908 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m23:02:22.570692 [debug] [MainThread]: Command end result
[0m23:02:22.582279 [info ] [MainThread]: 
[0m23:02:22.582906 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:02:22.583323 [info ] [MainThread]: 
[0m23:02:22.583751 [error] [MainThread]:   Database Error in model cleaned_taxi_trips (models/silver/cleaned_taxi_trips.sql)
  invalid input syntax for type integer: "4.0"
  compiled Code at target/run/nyc_taxi/models/silver/cleaned_taxi_trips.sql
[0m23:02:22.584149 [info ] [MainThread]: 
[0m23:02:22.584598 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:02:22.659506 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.3471642, "process_user_time": 4.210502, "process_kernel_time": 0.144507, "process_mem_max_rss": "114692", "process_in_blocks": "17568", "process_out_blocks": "4096", "command_success": false}
[0m23:02:22.660482 [debug] [MainThread]: Command `dbt run` failed at 23:02:22.660243 after 3.35 seconds
[0m23:02:22.661055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7c0a1a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bec922f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7bd2d5540>]}
[0m23:02:22.661618 [debug] [MainThread]: Flushing usage events
[0m23:08:23.263643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b0d95b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b0bbd2260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b0bbd2200>]}


============================== 23:08:23.266440 | 7724a934-78ac-492b-9f76-649b34b702df ==============================
[0m23:08:23.266440 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:08:23.267145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt --select silver', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:08:23.449140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7724a934-78ac-492b-9f76-649b34b702df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b0bbd2320>]}
[0m23:08:23.574506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7724a934-78ac-492b-9f76-649b34b702df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b0a187250>]}
[0m23:08:23.575473 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m23:08:23.602541 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:08:23.686259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:08:23.687905 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/silver/cleaned_taxi_trips.sql
[0m23:08:24.115402 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_taxi.bronze
[0m23:08:24.124142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7724a934-78ac-492b-9f76-649b34b702df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b09d400d0>]}
[0m23:08:24.143693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7724a934-78ac-492b-9f76-649b34b702df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b09e66a10>]}
[0m23:08:24.144231 [info ] [MainThread]: Found 4 models, 51 tests, 1 source, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m23:08:24.144704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7724a934-78ac-492b-9f76-649b34b702df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b09df2e00>]}
[0m23:08:24.146461 [info ] [MainThread]: 
[0m23:08:24.147353 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:08:24.148450 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw'
[0m23:08:24.159061 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw"
[0m23:08:24.159427 [debug] [ThreadPool]: On list_nyc_taxi_dw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:08:24.159737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:24.166231 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m23:08:24.167440 [debug] [ThreadPool]: On list_nyc_taxi_dw: Close
[0m23:08:24.169459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw, now list_nyc_taxi_dw_public_silver)
[0m23:08:24.175064 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:08:24.175864 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw_public_gold'
[0m23:08:24.176271 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: BEGIN
[0m23:08:24.178766 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:08:24.179126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:08:24.179477 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: BEGIN
[0m23:08:24.180075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:24.186497 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:08:24.187057 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:08:24.187481 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:08:24.187854 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_silver"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m23:08:24.188212 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:08:24.188710 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_gold"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m23:08:24.191876 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:08:24.192253 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:08:24.193321 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: ROLLBACK
[0m23:08:24.194370 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: ROLLBACK
[0m23:08:24.194883 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: Close
[0m23:08:24.195217 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: Close
[0m23:08:24.201272 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:24.201642 [debug] [MainThread]: On master: BEGIN
[0m23:08:24.201940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:08:24.206484 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:08:24.206826 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:24.207205 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:08:24.210323 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:08:24.211384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7724a934-78ac-492b-9f76-649b34b702df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b09d2f640>]}
[0m23:08:24.211835 [debug] [MainThread]: On master: ROLLBACK
[0m23:08:24.212273 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:24.212593 [debug] [MainThread]: On master: BEGIN
[0m23:08:24.213094 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:08:24.213490 [debug] [MainThread]: On master: COMMIT
[0m23:08:24.213786 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:24.214058 [debug] [MainThread]: On master: COMMIT
[0m23:08:24.214452 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:08:24.214780 [debug] [MainThread]: On master: Close
[0m23:08:24.215604 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:08:24.216284 [info ] [MainThread]: 
[0m23:08:24.219424 [debug] [Thread-1 (]: Began running node model.nyc_taxi.cleaned_taxi_trips
[0m23:08:24.220128 [info ] [Thread-1 (]: 1 of 1 START sql table model public_silver.cleaned_taxi_trips .................. [RUN]
[0m23:08:24.221082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw_public_gold, now model.nyc_taxi.cleaned_taxi_trips)
[0m23:08:24.221676 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi.cleaned_taxi_trips
[0m23:08:24.239148 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi.cleaned_taxi_trips"
[0m23:08:24.240196 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.cleaned_taxi_trips (compile): 23:08:24.222042 => 23:08:24.239892
[0m23:08:24.240760 [debug] [Thread-1 (]: Began executing node model.nyc_taxi.cleaned_taxi_trips
[0m23:08:24.278986 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi.cleaned_taxi_trips"
[0m23:08:24.279762 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:08:24.280176 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: BEGIN
[0m23:08:24.280558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:24.285765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:08:24.286157 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:08:24.286769 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

  
    

  create  table "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips__dbt_tmp"
  
  
    as
  
  (
    

/*
  Silver Layer: cleaned_taxi_trips
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Transforms raw bronze strings into typed, cleaned, validated records.
  Business rules applied:
    - Cast all numeric strings to NUMERIC/INTEGER
    - Parse datetimes from ISO strings
    - Derive trip duration, speed, per-mile cost
    - Map payment_type codes to labels
    - Filter obvious bad records (negative fares, zero distance, etc.)
    - Deduplicate on business key
*/

WITH source AS (

    SELECT *
    FROM "nyc_taxi_dw"."bronze"."raw_taxi_trips"

),

cast_and_clean AS (

    SELECT
        ingestion_id,
        batch_id,
        ingested_at,

        -- Vendor
        NULLIF(TRIM(vendor_id), '')::FLOAT::INTEGER                       AS vendor_id,

        -- Timestamps
        tpep_pickup_datetime::TIMESTAMP                            AS pickup_datetime,
        tpep_dropoff_datetime::TIMESTAMP                           AS dropoff_datetime,

        -- Passengers & distance
        NULLIF(TRIM(passenger_count), '')::FLOAT::INTEGER                 AS passenger_count,
        NULLIF(TRIM(trip_distance), '')::NUMERIC(10, 2)            AS trip_distance_miles,

        -- Location IDs
        NULLIF(TRIM(pu_location_id), '')::FLOAT::INTEGER                  AS pickup_location_id,
        NULLIF(TRIM(do_location_id), '')::FLOAT::INTEGER                  AS dropoff_location_id,

        -- Rate & flags
        NULLIF(TRIM(rate_code_id), '')::FLOAT::INTEGER                    AS rate_code_id,
        TRIM(store_and_fwd_flag)                                   AS store_and_fwd_flag,

        -- Payment
        NULLIF(TRIM(payment_type), '')::FLOAT::INTEGER                    AS payment_type_code,
        CASE TRIM(payment_type)
            WHEN '1' THEN 'Credit Card'
            WHEN '2' THEN 'Cash'
            WHEN '3' THEN 'No Charge'
            WHEN '4' THEN 'Dispute'
            WHEN '5' THEN 'Unknown'
            WHEN '6' THEN 'Voided Trip'
            ELSE          'Other'
        END                                                        AS payment_type_label,

        -- Fare components
        NULLIF(TRIM(fare_amount), '')::NUMERIC(10, 2)              AS fare_amount,
        NULLIF(TRIM(extra), '')::NUMERIC(10, 2)                    AS extra,
        NULLIF(TRIM(mta_tax), '')::NUMERIC(10, 2)                  AS mta_tax,
        NULLIF(TRIM(tip_amount), '')::NUMERIC(10, 2)               AS tip_amount,
        NULLIF(TRIM(tolls_amount), '')::NUMERIC(10, 2)             AS tolls_amount,
        NULLIF(TRIM(improvement_surcharge), '')::NUMERIC(10, 2)    AS improvement_surcharge,
        NULLIF(TRIM(congestion_surcharge), '')::NUMERIC(10, 2)     AS congestion_surcharge,
        NULLIF(TRIM(airport_fee), '')::NUMERIC(10, 2)              AS airport_fee,
        NULLIF(TRIM(total_amount), '')::NUMERIC(10, 2)             AS total_amount

    FROM source
    WHERE tpep_pickup_datetime IS NOT NULL
      AND tpep_dropoff_datetime IS NOT NULL
      AND total_amount IS NOT NULL

),

enrich AS (

    SELECT
        *,
        -- Derived metrics
        EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) / 60.0
                                                                    AS trip_duration_mins,
        CASE
            WHEN trip_distance_miles > 0
             AND EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) > 0
            THEN trip_distance_miles
                 / (EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) / 3600.0)
            ELSE NULL
        END                                                         AS avg_speed_mph,
        CASE
            WHEN trip_distance_miles > 0
            THEN total_amount / trip_distance_miles
            ELSE NULL
        END                                                         AS cost_per_mile,
        CASE
            WHEN total_amount > 0
            THEN tip_amount / total_amount
            ELSE 0
        END                                                         AS tip_percentage,

        -- Date parts for partitioning / BI
        DATE(pickup_datetime)                                       AS pickup_date,
        EXTRACT(HOUR FROM pickup_datetime)::INTEGER                 AS pickup_hour,
        TO_CHAR(pickup_datetime, 'Day')                            AS pickup_day_of_week,
        EXTRACT(MONTH FROM pickup_datetime)::INTEGER                AS pickup_month,
        EXTRACT(YEAR FROM pickup_datetime)::INTEGER                 AS pickup_year

    FROM cast_and_clean

),

deduplicated AS (

    SELECT *,
        ROW_NUMBER() OVER (
            PARTITION BY pickup_datetime, dropoff_datetime, vendor_id, total_amount
            ORDER BY ingestion_id DESC
        ) AS rn
    FROM enrich

),

validated AS (

    SELECT *
    FROM deduplicated
    WHERE rn = 1
      -- Business rule filters
      AND total_amount  > 0
      AND fare_amount   >= 0
      AND trip_distance_miles >= 0
      AND passenger_count BETWEEN 1 AND 8
      AND trip_duration_mins BETWEEN 1 AND 360  -- 1 min to 6 hrs
      AND pickup_datetime < dropoff_datetime

)

SELECT
    -- Surrogate key
    md5(cast(coalesce(cast(pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                                           AS trip_id,

    ingestion_id,
    batch_id,
    ingested_at,
    vendor_id,
    pickup_datetime,
    dropoff_datetime,
    pickup_date,
    pickup_hour,
    pickup_day_of_week,
    pickup_month,
    pickup_year,
    passenger_count,
    trip_distance_miles,
    pickup_location_id,
    dropoff_location_id,
    rate_code_id,
    store_and_fwd_flag,
    payment_type_code,
    payment_type_label,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    congestion_surcharge,
    airport_fee,
    total_amount,
    trip_duration_mins,
    avg_speed_mph,
    cost_per_mile,
    tip_percentage

FROM validated
  );
  
[0m23:08:24.373111 [debug] [Thread-1 (]: Postgres adapter: Postgres error: integer out of range

[0m23:08:24.374046 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: ROLLBACK
[0m23:08:24.374877 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.cleaned_taxi_trips (execute): 23:08:24.241098 => 23:08:24.374647
[0m23:08:24.375261 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: Close
[0m23:08:24.377839 [debug] [Thread-1 (]: Database Error in model cleaned_taxi_trips (models/silver/cleaned_taxi_trips.sql)
  integer out of range
  compiled Code at target/run/nyc_taxi/models/silver/cleaned_taxi_trips.sql
[0m23:08:24.378503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7724a934-78ac-492b-9f76-649b34b702df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b09b7e710>]}
[0m23:08:24.379136 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_silver.cleaned_taxi_trips ......... [[31mERROR[0m in 0.16s]
[0m23:08:24.379944 [debug] [Thread-1 (]: Finished running node model.nyc_taxi.cleaned_taxi_trips
[0m23:08:24.381456 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:24.381780 [debug] [MainThread]: On master: BEGIN
[0m23:08:24.382353 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:08:24.388014 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:08:24.388618 [debug] [MainThread]: On master: COMMIT
[0m23:08:24.388963 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:24.389247 [debug] [MainThread]: On master: COMMIT
[0m23:08:24.389667 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:08:24.389970 [debug] [MainThread]: On master: Close
[0m23:08:24.390797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:24.391195 [debug] [MainThread]: Connection 'list_nyc_taxi_dw_public_silver' was properly closed.
[0m23:08:24.391567 [debug] [MainThread]: Connection 'model.nyc_taxi.cleaned_taxi_trips' was properly closed.
[0m23:08:24.391961 [info ] [MainThread]: 
[0m23:08:24.392604 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m23:08:24.393572 [debug] [MainThread]: Command end result
[0m23:08:24.407633 [info ] [MainThread]: 
[0m23:08:24.408139 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:08:24.408692 [info ] [MainThread]: 
[0m23:08:24.409157 [error] [MainThread]:   Database Error in model cleaned_taxi_trips (models/silver/cleaned_taxi_trips.sql)
  integer out of range
  compiled Code at target/run/nyc_taxi/models/silver/cleaned_taxi_trips.sql
[0m23:08:24.409582 [info ] [MainThread]: 
[0m23:08:24.410036 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:08:24.410985 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1984164, "process_user_time": 2.973025, "process_kernel_time": 0.131322, "process_mem_max_rss": "112360", "process_out_blocks": "4072", "command_success": false, "process_in_blocks": "0"}
[0m23:08:24.411706 [debug] [MainThread]: Command `dbt run` failed at 23:08:24.411531 after 1.20 seconds
[0m23:08:24.412205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b0d95b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b0a187250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b09ca4fd0>]}
[0m23:08:24.412740 [debug] [MainThread]: Flushing usage events
[0m23:10:14.961601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7289aaf3a980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7289a919e260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7289a919e200>]}


============================== 23:10:14.964104 | 7aca928b-9802-4407-b395-ca8b33094a6e ==============================
[0m23:10:14.964104 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:10:14.964775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt --select silver', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:10:15.172422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7aca928b-9802-4407-b395-ca8b33094a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7289a919e320>]}
[0m23:10:15.262139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7aca928b-9802-4407-b395-ca8b33094a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7289a77540a0>]}
[0m23:10:15.262970 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m23:10:15.277257 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:10:15.333499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:10:15.337102 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/silver/cleaned_taxi_trips.sql
[0m23:10:15.896132 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_taxi.bronze
[0m23:10:15.901555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7aca928b-9802-4407-b395-ca8b33094a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7289a72f80d0>]}
[0m23:10:15.916431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7aca928b-9802-4407-b395-ca8b33094a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7289a7252a10>]}
[0m23:10:15.917170 [info ] [MainThread]: Found 4 models, 51 tests, 1 source, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m23:10:15.917670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aca928b-9802-4407-b395-ca8b33094a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7289a73e2e00>]}
[0m23:10:15.919943 [info ] [MainThread]: 
[0m23:10:15.920895 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:10:15.922300 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw'
[0m23:10:15.937270 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw"
[0m23:10:15.937817 [debug] [ThreadPool]: On list_nyc_taxi_dw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:10:15.938233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:15.948567 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m23:10:15.950333 [debug] [ThreadPool]: On list_nyc_taxi_dw: Close
[0m23:10:15.953844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw_public_silver'
[0m23:10:15.964260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw, now list_nyc_taxi_dw_public_gold)
[0m23:10:15.963231 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:10:15.970354 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: BEGIN
[0m23:10:15.970829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:15.972423 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:10:15.972893 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: BEGIN
[0m23:10:15.973295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:10:15.988912 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:10:15.990792 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:10:15.989785 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:10:15.991781 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_gold"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m23:10:15.992859 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:10:15.994873 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_silver"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m23:10:16.000548 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:10:16.002383 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: ROLLBACK
[0m23:10:16.004539 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:10:16.011464 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: ROLLBACK
[0m23:10:16.012048 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: Close
[0m23:10:16.013326 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: Close
[0m23:10:16.023878 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:16.024433 [debug] [MainThread]: On master: BEGIN
[0m23:10:16.024872 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:10:16.033632 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:10:16.034285 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:16.034844 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:10:16.040137 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:10:16.041364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aca928b-9802-4407-b395-ca8b33094a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7289a713fe80>]}
[0m23:10:16.041854 [debug] [MainThread]: On master: ROLLBACK
[0m23:10:16.042304 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:16.042662 [debug] [MainThread]: On master: BEGIN
[0m23:10:16.043168 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:10:16.043510 [debug] [MainThread]: On master: COMMIT
[0m23:10:16.043794 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:16.044061 [debug] [MainThread]: On master: COMMIT
[0m23:10:16.044445 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:10:16.044771 [debug] [MainThread]: On master: Close
[0m23:10:16.045601 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:10:16.046385 [info ] [MainThread]: 
[0m23:10:16.049064 [debug] [Thread-1 (]: Began running node model.nyc_taxi.cleaned_taxi_trips
[0m23:10:16.049586 [info ] [Thread-1 (]: 1 of 1 START sql table model public_silver.cleaned_taxi_trips .................. [RUN]
[0m23:10:16.050425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw_public_gold, now model.nyc_taxi.cleaned_taxi_trips)
[0m23:10:16.050829 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi.cleaned_taxi_trips
[0m23:10:16.063271 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi.cleaned_taxi_trips"
[0m23:10:16.064248 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.cleaned_taxi_trips (compile): 23:10:16.051063 => 23:10:16.063905
[0m23:10:16.065025 [debug] [Thread-1 (]: Began executing node model.nyc_taxi.cleaned_taxi_trips
[0m23:10:16.101742 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi.cleaned_taxi_trips"
[0m23:10:16.102525 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:10:16.102928 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: BEGIN
[0m23:10:16.103261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:16.108515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:10:16.108955 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:10:16.109577 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

  
    

  create  table "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips__dbt_tmp"
  
  
    as
  
  (
    

/*
  Silver Layer: cleaned_taxi_trips
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Transforms raw bronze strings into typed, cleaned, validated records.
  Business rules applied:
    - Cast all numeric strings to NUMERIC/INTEGER
    - Parse datetimes from ISO strings
    - Derive trip duration, speed, per-mile cost
    - Map payment_type codes to labels
    - Filter obvious bad records (negative fares, zero distance, etc.)
    - Deduplicate on business key
*/

WITH source AS (

    SELECT *
    FROM "nyc_taxi_dw"."bronze"."raw_taxi_trips"

),

cast_and_clean AS (

    SELECT
        ingestion_id,
        batch_id,
        ingested_at,

        -- Vendor
        NULLIF(TRIM(vendor_id), '')::FLOAT::BIGINT                       AS vendor_id,

        -- Timestamps
        tpep_pickup_datetime::TIMESTAMP                            AS pickup_datetime,
        tpep_dropoff_datetime::TIMESTAMP                           AS dropoff_datetime,

        -- Passengers & distance
        NULLIF(TRIM(passenger_count), '')::FLOAT::BIGINT                 AS passenger_count,
        NULLIF(TRIM(trip_distance), '')::NUMERIC(10, 2)            AS trip_distance_miles,

        -- Location IDs
        NULLIF(TRIM(pu_location_id), '')::FLOAT::BIGINT                  AS pickup_location_id,
        NULLIF(TRIM(do_location_id), '')::FLOAT::BIGINT                  AS dropoff_location_id,

        -- Rate & flags
        NULLIF(TRIM(rate_code_id), '')::FLOAT::BIGINT                    AS rate_code_id,
        TRIM(store_and_fwd_flag)                                   AS store_and_fwd_flag,

        -- Payment
        NULLIF(TRIM(payment_type), '')::FLOAT::BIGINT                    AS payment_type_code,
        CASE TRIM(payment_type)
            WHEN '1' THEN 'Credit Card'
            WHEN '2' THEN 'Cash'
            WHEN '3' THEN 'No Charge'
            WHEN '4' THEN 'Dispute'
            WHEN '5' THEN 'Unknown'
            WHEN '6' THEN 'Voided Trip'
            ELSE          'Other'
        END                                                        AS payment_type_label,

        -- Fare components
        NULLIF(TRIM(fare_amount), '')::NUMERIC(10, 2)              AS fare_amount,
        NULLIF(TRIM(extra), '')::NUMERIC(10, 2)                    AS extra,
        NULLIF(TRIM(mta_tax), '')::NUMERIC(10, 2)                  AS mta_tax,
        NULLIF(TRIM(tip_amount), '')::NUMERIC(10, 2)               AS tip_amount,
        NULLIF(TRIM(tolls_amount), '')::NUMERIC(10, 2)             AS tolls_amount,
        NULLIF(TRIM(improvement_surcharge), '')::NUMERIC(10, 2)    AS improvement_surcharge,
        NULLIF(TRIM(congestion_surcharge), '')::NUMERIC(10, 2)     AS congestion_surcharge,
        NULLIF(TRIM(airport_fee), '')::NUMERIC(10, 2)              AS airport_fee,
        NULLIF(TRIM(total_amount), '')::NUMERIC(10, 2)             AS total_amount

    FROM source
    WHERE tpep_pickup_datetime IS NOT NULL
      AND tpep_dropoff_datetime IS NOT NULL
      AND total_amount IS NOT NULL

),

enrich AS (

    SELECT
        *,
        -- Derived metrics
        EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) / 60.0
                                                                    AS trip_duration_mins,
        CASE
            WHEN trip_distance_miles > 0
             AND EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) > 0
            THEN trip_distance_miles
                 / (EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) / 3600.0)
            ELSE NULL
        END                                                         AS avg_speed_mph,
        CASE
            WHEN trip_distance_miles > 0
            THEN total_amount / trip_distance_miles
            ELSE NULL
        END                                                         AS cost_per_mile,
        CASE
            WHEN total_amount > 0
            THEN tip_amount / total_amount
            ELSE 0
        END                                                         AS tip_percentage,

        -- Date parts for partitioning / BI
        DATE(pickup_datetime)                                       AS pickup_date,
        EXTRACT(HOUR FROM pickup_datetime)::BIGINT                 AS pickup_hour,
        TO_CHAR(pickup_datetime, 'Day')                            AS pickup_day_of_week,
        EXTRACT(MONTH FROM pickup_datetime)::BIGINT                AS pickup_month,
        EXTRACT(YEAR FROM pickup_datetime)::BIGINT                 AS pickup_year

    FROM cast_and_clean

),

deduplicated AS (

    SELECT *,
        ROW_NUMBER() OVER (
            PARTITION BY pickup_datetime, dropoff_datetime, vendor_id, total_amount
            ORDER BY ingestion_id DESC
        ) AS rn
    FROM enrich

),

validated AS (

    SELECT *
    FROM deduplicated
    WHERE rn = 1
      -- Business rule filters
      AND total_amount  > 0
      AND fare_amount   >= 0
      AND trip_distance_miles >= 0
      AND passenger_count BETWEEN 0 AND 20
      AND trip_duration_mins BETWEEN 1 AND 360  -- 1 min to 6 hrs
      AND pickup_datetime < dropoff_datetime

)

SELECT
    -- Surrogate key
    md5(cast(coalesce(cast(pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                                           AS trip_id,

    ingestion_id,
    batch_id,
    ingested_at,
    vendor_id,
    pickup_datetime,
    dropoff_datetime,
    pickup_date,
    pickup_hour,
    pickup_day_of_week,
    pickup_month,
    pickup_year,
    passenger_count,
    trip_distance_miles,
    pickup_location_id,
    dropoff_location_id,
    rate_code_id,
    store_and_fwd_flag,
    payment_type_code,
    payment_type_label,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    congestion_surcharge,
    airport_fee,
    total_amount,
    trip_duration_mins,
    avg_speed_mph,
    cost_per_mile,
    tip_percentage

FROM validated
  );
  
[0m23:10:16.159804 [debug] [Thread-1 (]: Postgres adapter: Postgres error: bigint out of range

[0m23:10:16.160393 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: ROLLBACK
[0m23:10:16.161620 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.cleaned_taxi_trips (execute): 23:10:16.065322 => 23:10:16.161258
[0m23:10:16.162262 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: Close
[0m23:10:16.164936 [debug] [Thread-1 (]: Database Error in model cleaned_taxi_trips (models/silver/cleaned_taxi_trips.sql)
  bigint out of range
  compiled Code at target/run/nyc_taxi/models/silver/cleaned_taxi_trips.sql
[0m23:10:16.165545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aca928b-9802-4407-b395-ca8b33094a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7289a714a710>]}
[0m23:10:16.166156 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_silver.cleaned_taxi_trips ......... [[31mERROR[0m in 0.12s]
[0m23:10:16.166907 [debug] [Thread-1 (]: Finished running node model.nyc_taxi.cleaned_taxi_trips
[0m23:10:16.168451 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:16.168772 [debug] [MainThread]: On master: BEGIN
[0m23:10:16.169052 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:10:16.175071 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:10:16.175457 [debug] [MainThread]: On master: COMMIT
[0m23:10:16.175806 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:16.176099 [debug] [MainThread]: On master: COMMIT
[0m23:10:16.176498 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:10:16.176816 [debug] [MainThread]: On master: Close
[0m23:10:16.177628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:16.178006 [debug] [MainThread]: Connection 'model.nyc_taxi.cleaned_taxi_trips' was properly closed.
[0m23:10:16.178303 [debug] [MainThread]: Connection 'list_nyc_taxi_dw_public_silver' was properly closed.
[0m23:10:16.178682 [info ] [MainThread]: 
[0m23:10:16.179266 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m23:10:16.180039 [debug] [MainThread]: Command end result
[0m23:10:16.192584 [info ] [MainThread]: 
[0m23:10:16.193189 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:10:16.193656 [info ] [MainThread]: 
[0m23:10:16.194090 [error] [MainThread]:   Database Error in model cleaned_taxi_trips (models/silver/cleaned_taxi_trips.sql)
  bigint out of range
  compiled Code at target/run/nyc_taxi/models/silver/cleaned_taxi_trips.sql
[0m23:10:16.194536 [info ] [MainThread]: 
[0m23:10:16.194956 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:10:16.195991 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2830269, "process_user_time": 3.016731, "process_kernel_time": 0.134842, "process_mem_max_rss": "112496", "process_out_blocks": "4064", "command_success": false, "process_in_blocks": "0"}
[0m23:10:16.196649 [debug] [MainThread]: Command `dbt run` failed at 23:10:16.196468 after 1.28 seconds
[0m23:10:16.197185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7289aaf3a980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7289a77540a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7289a7290fd0>]}
[0m23:10:16.197747 [debug] [MainThread]: Flushing usage events
[0m23:11:54.572930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbff7747af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbff59798a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbff5979840>]}


============================== 23:11:54.581040 | ed5b2117-63d4-4b9e-9f02-4cb413628218 ==============================
[0m23:11:54.581040 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:11:54.582597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt --select silver', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:11:54.938854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed5b2117-63d4-4b9e-9f02-4cb413628218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbff5979960>]}
[0m23:11:55.025699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed5b2117-63d4-4b9e-9f02-4cb413628218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbff4120190>]}
[0m23:11:55.026801 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m23:11:55.042775 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:11:55.074112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:11:55.074962 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/silver/cleaned_taxi_trips.sql
[0m23:11:55.496720 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_taxi.bronze
[0m23:11:55.502442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed5b2117-63d4-4b9e-9f02-4cb413628218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbff3af40d0>]}
[0m23:11:55.517459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed5b2117-63d4-4b9e-9f02-4cb413628218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbff3c1ea70>]}
[0m23:11:55.518085 [info ] [MainThread]: Found 4 models, 51 tests, 1 source, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m23:11:55.518642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed5b2117-63d4-4b9e-9f02-4cb413628218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbff3ba9f60>]}
[0m23:11:55.520944 [info ] [MainThread]: 
[0m23:11:55.521948 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:11:55.523386 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw'
[0m23:11:55.539014 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw"
[0m23:11:55.539627 [debug] [ThreadPool]: On list_nyc_taxi_dw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:11:55.540080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:55.554184 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m23:11:55.556252 [debug] [ThreadPool]: On list_nyc_taxi_dw: Close
[0m23:11:55.559491 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw_public_silver'
[0m23:11:55.566227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw, now list_nyc_taxi_dw_public_gold)
[0m23:11:55.570084 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:11:55.577699 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: BEGIN
[0m23:11:55.577127 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:11:55.578745 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: BEGIN
[0m23:11:55.578161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:55.579223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:11:55.596049 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:11:55.597599 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:11:55.596972 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:11:55.598766 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:11:55.598183 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_gold"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m23:11:55.599328 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_silver"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m23:11:55.606603 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:11:55.607314 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:11:55.610773 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: ROLLBACK
[0m23:11:55.609103 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: ROLLBACK
[0m23:11:55.611516 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: Close
[0m23:11:55.612033 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: Close
[0m23:11:55.628800 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:55.629711 [debug] [MainThread]: On master: BEGIN
[0m23:11:55.630226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:11:55.646385 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:11:55.647358 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:55.648077 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:11:55.660131 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:11:55.662093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed5b2117-63d4-4b9e-9f02-4cb413628218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbff3a57e20>]}
[0m23:11:55.662864 [debug] [MainThread]: On master: ROLLBACK
[0m23:11:55.664604 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:55.665109 [debug] [MainThread]: On master: BEGIN
[0m23:11:55.665876 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:11:55.666563 [debug] [MainThread]: On master: COMMIT
[0m23:11:55.667075 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:55.667580 [debug] [MainThread]: On master: COMMIT
[0m23:11:55.668330 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:11:55.668851 [debug] [MainThread]: On master: Close
[0m23:11:55.669936 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:11:55.670958 [info ] [MainThread]: 
[0m23:11:55.674161 [debug] [Thread-1 (]: Began running node model.nyc_taxi.cleaned_taxi_trips
[0m23:11:55.674944 [info ] [Thread-1 (]: 1 of 1 START sql table model public_silver.cleaned_taxi_trips .................. [RUN]
[0m23:11:55.675883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw_public_gold, now model.nyc_taxi.cleaned_taxi_trips)
[0m23:11:55.676272 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi.cleaned_taxi_trips
[0m23:11:55.690461 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi.cleaned_taxi_trips"
[0m23:11:55.691236 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.cleaned_taxi_trips (compile): 23:11:55.676511 => 23:11:55.690965
[0m23:11:55.691642 [debug] [Thread-1 (]: Began executing node model.nyc_taxi.cleaned_taxi_trips
[0m23:11:55.734127 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi.cleaned_taxi_trips"
[0m23:11:55.735047 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:11:55.735742 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: BEGIN
[0m23:11:55.736285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:11:55.753353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:11:55.754308 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:11:55.755990 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

  
    

  create  table "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips__dbt_tmp"
  
  
    as
  
  (
    

/*
  Silver Layer: cleaned_taxi_trips
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Transforms raw bronze strings into typed, cleaned, validated records.
  Business rules applied:
    - Cast all numeric strings to NUMERIC/INTEGER
    - Parse datetimes from ISO strings
    - Derive trip duration, speed, per-mile cost
    - Map payment_type codes to labels
    - Filter obvious bad records (negative fares, zero distance, etc.)
    - Deduplicate on business key
*/

WITH source AS (

    SELECT *
    FROM "nyc_taxi_dw"."bronze"."raw_taxi_trips"

),

cast_and_clean AS (

    SELECT
        ingestion_id,
        batch_id,
        ingested_at,

        -- Vendor (safe cast: only cast if looks like a small integer)
        CASE WHEN vendor_id ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(vendor_id)::NUMERIC::INTEGER END            AS vendor_id,

        -- Timestamps
        tpep_pickup_datetime::TIMESTAMP                            AS pickup_datetime,
        tpep_dropoff_datetime::TIMESTAMP                           AS dropoff_datetime,

        -- Passengers & distance
        CASE WHEN passenger_count ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(passenger_count)::NUMERIC::INTEGER END      AS passenger_count,
        CASE WHEN trip_distance ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(trip_distance)::NUMERIC(10,2) END           AS trip_distance_miles,

        -- Location IDs
        CASE WHEN pu_location_id ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(pu_location_id)::NUMERIC::INTEGER END       AS pickup_location_id,
        CASE WHEN do_location_id ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(do_location_id)::NUMERIC::INTEGER END       AS dropoff_location_id,

        -- Rate & flags
        CASE WHEN rate_code_id ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(rate_code_id)::NUMERIC::INTEGER END         AS rate_code_id,
        TRIM(store_and_fwd_flag)                                   AS store_and_fwd_flag,

        -- Payment
        CASE WHEN payment_type ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(payment_type)::NUMERIC::INTEGER END         AS payment_type_code,
        CASE TRIM(payment_type)
            WHEN '1' THEN 'Credit Card'
            WHEN '2' THEN 'Cash'
            WHEN '3' THEN 'No Charge'
            WHEN '4' THEN 'Dispute'
            WHEN '5' THEN 'Unknown'
            WHEN '6' THEN 'Voided Trip'
            ELSE          'Other'
        END                                                        AS payment_type_label,

        -- Fare components (safe cast: NULL if not a valid decimal)
        CASE WHEN fare_amount ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(fare_amount)::NUMERIC(10,2) END             AS fare_amount,
        CASE WHEN extra ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(extra)::NUMERIC(10,2) END                   AS extra,
        CASE WHEN mta_tax ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(mta_tax)::NUMERIC(10,2) END                 AS mta_tax,
        CASE WHEN tip_amount ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(tip_amount)::NUMERIC(10,2) END              AS tip_amount,
        CASE WHEN tolls_amount ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(tolls_amount)::NUMERIC(10,2) END            AS tolls_amount,
        CASE WHEN improvement_surcharge ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(improvement_surcharge)::NUMERIC(10,2) END   AS improvement_surcharge,
        CASE WHEN congestion_surcharge ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(congestion_surcharge)::NUMERIC(10,2) END    AS congestion_surcharge,
        CASE WHEN airport_fee ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(airport_fee)::NUMERIC(10,2) END             AS airport_fee,
        CASE WHEN total_amount ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(total_amount)::NUMERIC(10,2) END            AS total_amount

    FROM source
    WHERE tpep_pickup_datetime IS NOT NULL
      AND tpep_dropoff_datetime IS NOT NULL
      AND total_amount IS NOT NULL

),

enrich AS (

    SELECT
        *,
        -- Derived metrics
        EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) / 60.0
                                                                    AS trip_duration_mins,
        CASE
            WHEN trip_distance_miles > 0
             AND EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) > 0
            THEN trip_distance_miles
                 / (EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) / 3600.0)
            ELSE NULL
        END                                                         AS avg_speed_mph,
        CASE
            WHEN trip_distance_miles > 0
            THEN total_amount / trip_distance_miles
            ELSE NULL
        END                                                         AS cost_per_mile,
        CASE
            WHEN total_amount > 0
            THEN tip_amount / total_amount
            ELSE 0
        END                                                         AS tip_percentage,

        -- Date parts for partitioning / BI
        DATE(pickup_datetime)                                       AS pickup_date,
        EXTRACT(HOUR FROM pickup_datetime)::BIGINT                 AS pickup_hour,
        TO_CHAR(pickup_datetime, 'Day')                            AS pickup_day_of_week,
        EXTRACT(MONTH FROM pickup_datetime)::BIGINT                AS pickup_month,
        EXTRACT(YEAR FROM pickup_datetime)::BIGINT                 AS pickup_year

    FROM cast_and_clean

),

deduplicated AS (

    SELECT *,
        ROW_NUMBER() OVER (
            PARTITION BY pickup_datetime, dropoff_datetime, vendor_id, total_amount
            ORDER BY ingestion_id DESC
        ) AS rn
    FROM enrich

),

validated AS (

    SELECT *
    FROM deduplicated
    WHERE rn = 1
      -- Business rule filters
      AND total_amount  > 0
      AND fare_amount   >= 0
      AND trip_distance_miles >= 0
      AND passenger_count BETWEEN 0 AND 20
      AND trip_duration_mins BETWEEN 1 AND 360  -- 1 min to 6 hrs
      AND pickup_datetime < dropoff_datetime

)

SELECT
    -- Surrogate key
    md5(cast(coalesce(cast(pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                                           AS trip_id,

    ingestion_id,
    batch_id,
    ingested_at,
    vendor_id,
    pickup_datetime,
    dropoff_datetime,
    pickup_date,
    pickup_hour,
    pickup_day_of_week,
    pickup_month,
    pickup_year,
    passenger_count,
    trip_distance_miles,
    pickup_location_id,
    dropoff_location_id,
    rate_code_id,
    store_and_fwd_flag,
    payment_type_code,
    payment_type_label,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    congestion_surcharge,
    airport_fee,
    total_amount,
    trip_duration_mins,
    avg_speed_mph,
    cost_per_mile,
    tip_percentage

FROM validated
  );
  
[0m23:11:56.019877 [debug] [Thread-1 (]: SQL status: SELECT 9103 in 0.0 seconds
[0m23:11:56.030569 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:11:56.031322 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */
alter table "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m23:11:56.032375 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:11:56.045891 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:11:56.046622 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

    create  index if not exists
  "7e431652093a74c451bca713aed4de7a"
  on "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips" using btree
  (pickup_datetime);
  
[0m23:11:56.053614 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:11:56.055464 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:11:56.055874 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

    create  index if not exists
  "8e3df6ed8d8be64bec9b97c7727e05fe"
  on "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips" using btree
  (vendor_id);
  
[0m23:11:56.060687 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:11:56.062471 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:11:56.062883 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

    create  index if not exists
  "f3e76a6bed7ac04f55eb934d2f870ce3"
  on "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips" using btree
  (payment_type);
  
[0m23:11:56.066252 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "payment_type" does not exist

[0m23:11:56.066848 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: ROLLBACK
[0m23:11:56.067864 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.cleaned_taxi_trips (execute): 23:11:55.691853 => 23:11:56.067518
[0m23:11:56.068489 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: Close
[0m23:11:56.074901 [debug] [Thread-1 (]: Database Error in model cleaned_taxi_trips (models/silver/cleaned_taxi_trips.sql)
  column "payment_type" does not exist
  compiled Code at target/run/nyc_taxi/models/silver/cleaned_taxi_trips.sql
[0m23:11:56.075733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed5b2117-63d4-4b9e-9f02-4cb413628218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbff3988be0>]}
[0m23:11:56.076735 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_silver.cleaned_taxi_trips ......... [[31mERROR[0m in 0.40s]
[0m23:11:56.077800 [debug] [Thread-1 (]: Finished running node model.nyc_taxi.cleaned_taxi_trips
[0m23:11:56.080367 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:56.080975 [debug] [MainThread]: On master: BEGIN
[0m23:11:56.081513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:11:56.089050 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:11:56.089683 [debug] [MainThread]: On master: COMMIT
[0m23:11:56.090112 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:56.090413 [debug] [MainThread]: On master: COMMIT
[0m23:11:56.090811 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:11:56.091130 [debug] [MainThread]: On master: Close
[0m23:11:56.091943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:56.092365 [debug] [MainThread]: Connection 'model.nyc_taxi.cleaned_taxi_trips' was properly closed.
[0m23:11:56.092727 [debug] [MainThread]: Connection 'list_nyc_taxi_dw_public_silver' was properly closed.
[0m23:11:56.093133 [info ] [MainThread]: 
[0m23:11:56.093586 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m23:11:56.094376 [debug] [MainThread]: Command end result
[0m23:11:56.106186 [info ] [MainThread]: 
[0m23:11:56.106657 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:11:56.107070 [info ] [MainThread]: 
[0m23:11:56.107489 [error] [MainThread]:   Database Error in model cleaned_taxi_trips (models/silver/cleaned_taxi_trips.sql)
  column "payment_type" does not exist
  compiled Code at target/run/nyc_taxi/models/silver/cleaned_taxi_trips.sql
[0m23:11:56.107889 [info ] [MainThread]: 
[0m23:11:56.108326 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:11:56.109229 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6330999, "process_user_time": 3.111975, "process_kernel_time": 0.124479, "process_mem_max_rss": "112820", "process_out_blocks": "4080", "command_success": false, "process_in_blocks": "0"}
[0m23:11:56.109770 [debug] [MainThread]: Command `dbt run` failed at 23:11:56.109650 after 1.63 seconds
[0m23:11:56.110130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbff7747af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbff3a626e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbff3c64a00>]}
[0m23:11:56.110510 [debug] [MainThread]: Flushing usage events
[0m23:20:51.141029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78105097b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78105114eec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78104ec65bd0>]}


============================== 23:20:51.160729 | 547ca582-7904-4a20-bac6-7a6316720297 ==============================
[0m23:20:51.160729 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:20:51.161513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt --select silver', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:20:51.461991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '547ca582-7904-4a20-bac6-7a6316720297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78105114eec0>]}
[0m23:20:51.551899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '547ca582-7904-4a20-bac6-7a6316720297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78104d1632e0>]}
[0m23:20:51.553273 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m23:20:51.572026 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:20:51.652850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:20:51.653276 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:20:51.654258 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_taxi.bronze
[0m23:20:51.660667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '547ca582-7904-4a20-bac6-7a6316720297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78104ce3cd60>]}
[0m23:20:51.684989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '547ca582-7904-4a20-bac6-7a6316720297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78104cffcdf0>]}
[0m23:20:51.685719 [info ] [MainThread]: Found 4 models, 51 tests, 1 source, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m23:20:51.686166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '547ca582-7904-4a20-bac6-7a6316720297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78104cffcfd0>]}
[0m23:20:51.688685 [info ] [MainThread]: 
[0m23:20:51.689522 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:20:51.690632 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw'
[0m23:20:51.702641 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw"
[0m23:20:51.703222 [debug] [ThreadPool]: On list_nyc_taxi_dw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:20:51.703816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:51.744553 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:20:51.746146 [debug] [ThreadPool]: On list_nyc_taxi_dw: Close
[0m23:20:51.747984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw, now create_nyc_taxi_dw_public_silver)
[0m23:20:51.748949 [debug] [ThreadPool]: Creating schema "database: "nyc_taxi_dw"
schema: "public_silver"
"
[0m23:20:51.754145 [debug] [ThreadPool]: Using postgres connection "create_nyc_taxi_dw_public_silver"
[0m23:20:51.754509 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_silver: BEGIN
[0m23:20:51.754810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:51.761322 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:20:51.761706 [debug] [ThreadPool]: Using postgres connection "create_nyc_taxi_dw_public_silver"
[0m23:20:51.762037 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "create_nyc_taxi_dw_public_silver"} */
create schema if not exists "public_silver"
[0m23:20:51.771381 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:20:51.772937 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_silver: COMMIT
[0m23:20:51.773518 [debug] [ThreadPool]: Using postgres connection "create_nyc_taxi_dw_public_silver"
[0m23:20:51.774016 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_silver: COMMIT
[0m23:20:51.776394 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:20:51.776725 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_silver: Close
[0m23:20:51.779152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nyc_taxi_dw_public_silver, now list_nyc_taxi_dw_public_silver)
[0m23:20:51.785240 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw_public_gold'
[0m23:20:51.788318 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:20:51.791049 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:20:51.791605 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: BEGIN
[0m23:20:51.792594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:51.792072 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: BEGIN
[0m23:20:51.793315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:51.801796 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:20:51.802320 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:20:51.802698 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:20:51.803065 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_silver"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m23:20:51.803442 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:20:51.803941 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_gold"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m23:20:51.842706 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:20:51.843226 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:20:51.844436 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: ROLLBACK
[0m23:20:51.845529 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: ROLLBACK
[0m23:20:51.846053 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: Close
[0m23:20:51.847026 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: Close
[0m23:20:51.852775 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:51.853142 [debug] [MainThread]: On master: BEGIN
[0m23:20:51.853461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:20:51.858371 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:20:51.858703 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:51.859089 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:20:51.870200 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:20:51.871631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '547ca582-7904-4a20-bac6-7a6316720297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78104ce78d30>]}
[0m23:20:51.872162 [debug] [MainThread]: On master: ROLLBACK
[0m23:20:51.872684 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:51.873017 [debug] [MainThread]: On master: BEGIN
[0m23:20:51.873587 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:20:51.873923 [debug] [MainThread]: On master: COMMIT
[0m23:20:51.874208 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:51.874506 [debug] [MainThread]: On master: COMMIT
[0m23:20:51.874885 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:20:51.875199 [debug] [MainThread]: On master: Close
[0m23:20:51.876049 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:20:51.876563 [info ] [MainThread]: 
[0m23:20:51.885635 [debug] [Thread-1 (]: Began running node model.nyc_taxi.cleaned_taxi_trips
[0m23:20:51.886792 [info ] [Thread-1 (]: 1 of 1 START sql table model public_silver.cleaned_taxi_trips .................. [RUN]
[0m23:20:51.887672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw_public_gold, now model.nyc_taxi.cleaned_taxi_trips)
[0m23:20:51.888091 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi.cleaned_taxi_trips
[0m23:20:51.954191 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi.cleaned_taxi_trips"
[0m23:20:51.955065 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.cleaned_taxi_trips (compile): 23:20:51.888315 => 23:20:51.954795
[0m23:20:51.955473 [debug] [Thread-1 (]: Began executing node model.nyc_taxi.cleaned_taxi_trips
[0m23:20:51.995114 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi.cleaned_taxi_trips"
[0m23:20:51.996401 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:20:51.997111 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: BEGIN
[0m23:20:51.997652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:52.005381 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:20:52.005867 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:20:52.006834 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

  
    

  create  table "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips__dbt_tmp"
  
  
    as
  
  (
    

/*
  Silver Layer: cleaned_taxi_trips
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Transforms raw bronze strings into typed, cleaned, validated records.
  Business rules applied:
    - Cast all numeric strings to NUMERIC/INTEGER
    - Parse datetimes from ISO strings
    - Derive trip duration, speed, per-mile cost
    - Map payment_type codes to labels
    - Filter obvious bad records (negative fares, zero distance, etc.)
    - Deduplicate on business key
*/

WITH source AS (

    SELECT *
    FROM "nyc_taxi_dw"."bronze"."raw_taxi_trips"

),

cast_and_clean AS (

    SELECT
        ingestion_id,
        batch_id,
        ingested_at,

        -- Vendor (safe cast: only cast if looks like a small integer)
        CASE WHEN vendor_id ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(vendor_id)::NUMERIC::INTEGER END            AS vendor_id,

        -- Timestamps
        tpep_pickup_datetime::TIMESTAMP                            AS pickup_datetime,
        tpep_dropoff_datetime::TIMESTAMP                           AS dropoff_datetime,

        -- Passengers & distance
        CASE WHEN passenger_count ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(passenger_count)::NUMERIC::INTEGER END      AS passenger_count,
        CASE WHEN trip_distance ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(trip_distance)::NUMERIC(10,2) END           AS trip_distance_miles,

        -- Location IDs
        CASE WHEN pu_location_id ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(pu_location_id)::NUMERIC::INTEGER END       AS pickup_location_id,
        CASE WHEN do_location_id ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(do_location_id)::NUMERIC::INTEGER END       AS dropoff_location_id,

        -- Rate & flags
        CASE WHEN rate_code_id ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(rate_code_id)::NUMERIC::INTEGER END         AS rate_code_id,
        TRIM(store_and_fwd_flag)                                   AS store_and_fwd_flag,

        -- Payment
        CASE WHEN payment_type ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(payment_type)::NUMERIC::INTEGER END         AS payment_type_code,
        CASE TRIM(payment_type)
            WHEN '1' THEN 'Credit Card'
            WHEN '2' THEN 'Cash'
            WHEN '3' THEN 'No Charge'
            WHEN '4' THEN 'Dispute'
            WHEN '5' THEN 'Unknown'
            WHEN '6' THEN 'Voided Trip'
            ELSE          'Other'
        END                                                        AS payment_type_label,

        -- Fare components (safe cast: NULL if not a valid decimal)
        CASE WHEN fare_amount ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(fare_amount)::NUMERIC(10,2) END             AS fare_amount,
        CASE WHEN extra ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(extra)::NUMERIC(10,2) END                   AS extra,
        CASE WHEN mta_tax ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(mta_tax)::NUMERIC(10,2) END                 AS mta_tax,
        CASE WHEN tip_amount ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(tip_amount)::NUMERIC(10,2) END              AS tip_amount,
        CASE WHEN tolls_amount ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(tolls_amount)::NUMERIC(10,2) END            AS tolls_amount,
        CASE WHEN improvement_surcharge ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(improvement_surcharge)::NUMERIC(10,2) END   AS improvement_surcharge,
        CASE WHEN congestion_surcharge ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(congestion_surcharge)::NUMERIC(10,2) END    AS congestion_surcharge,
        CASE WHEN airport_fee ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(airport_fee)::NUMERIC(10,2) END             AS airport_fee,
        CASE WHEN total_amount ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(total_amount)::NUMERIC(10,2) END            AS total_amount

    FROM source
    WHERE tpep_pickup_datetime IS NOT NULL
      AND tpep_dropoff_datetime IS NOT NULL
      AND total_amount IS NOT NULL

),

enrich AS (

    SELECT
        *,
        -- Derived metrics
        EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) / 60.0
                                                                    AS trip_duration_mins,
        CASE
            WHEN trip_distance_miles > 0
             AND EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) > 0
            THEN trip_distance_miles
                 / (EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) / 3600.0)
            ELSE NULL
        END                                                         AS avg_speed_mph,
        CASE
            WHEN trip_distance_miles > 0
            THEN total_amount / trip_distance_miles
            ELSE NULL
        END                                                         AS cost_per_mile,
        CASE
            WHEN total_amount > 0
            THEN tip_amount / total_amount
            ELSE 0
        END                                                         AS tip_percentage,

        -- Date parts for partitioning / BI
        DATE(pickup_datetime)                                       AS pickup_date,
        EXTRACT(HOUR FROM pickup_datetime)::BIGINT                 AS pickup_hour,
        TO_CHAR(pickup_datetime, 'Day')                            AS pickup_day_of_week,
        EXTRACT(MONTH FROM pickup_datetime)::BIGINT                AS pickup_month,
        EXTRACT(YEAR FROM pickup_datetime)::BIGINT                 AS pickup_year

    FROM cast_and_clean

),

deduplicated AS (

    SELECT *,
        ROW_NUMBER() OVER (
            PARTITION BY pickup_datetime, dropoff_datetime, vendor_id, total_amount
            ORDER BY ingestion_id DESC
        ) AS rn
    FROM enrich

),

validated AS (

    SELECT *
    FROM deduplicated
    WHERE rn = 1
      -- Business rule filters
      AND total_amount  > 0
      AND fare_amount   >= 0
      AND trip_distance_miles >= 0
      AND passenger_count BETWEEN 0 AND 20
      AND trip_duration_mins BETWEEN 1 AND 360  -- 1 min to 6 hrs
      AND pickup_datetime < dropoff_datetime

)

SELECT
    -- Surrogate key
    md5(cast(coalesce(cast(pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                                           AS trip_id,

    ingestion_id,
    batch_id,
    ingested_at,
    vendor_id,
    pickup_datetime,
    dropoff_datetime,
    pickup_date,
    pickup_hour,
    pickup_day_of_week,
    pickup_month,
    pickup_year,
    passenger_count,
    trip_distance_miles,
    pickup_location_id,
    dropoff_location_id,
    rate_code_id,
    store_and_fwd_flag,
    payment_type_code,
    payment_type_label,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    congestion_surcharge,
    airport_fee,
    total_amount,
    trip_duration_mins,
    avg_speed_mph,
    cost_per_mile,
    tip_percentage

FROM validated
  );
  
[0m23:20:52.294064 [debug] [Thread-1 (]: SQL status: SELECT 9103 in 0.0 seconds
[0m23:20:52.300465 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:20:52.300922 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */
alter table "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m23:20:52.301606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:20:52.313765 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:20:52.314192 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

    create  index if not exists
  "0c6e78172ab2d1a70b882c7c2940683b"
  on "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips" using btree
  (pickup_datetime);
  
[0m23:20:52.321142 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:20:52.323641 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:20:52.324231 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

    create  index if not exists
  "7a461396ef40942d9e6bcb1832d8f46a"
  on "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips" using btree
  (vendor_id);
  
[0m23:20:52.330597 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:20:52.333142 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:20:52.333748 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

    create  index if not exists
  "fdd40a4404a56f595e787faaa8aa1314"
  on "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips" using btree
  (payment_type);
  
[0m23:20:52.337223 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "payment_type" does not exist

[0m23:20:52.338526 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: ROLLBACK
[0m23:20:52.339274 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.cleaned_taxi_trips (execute): 23:20:51.955701 => 23:20:52.339042
[0m23:20:52.339877 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: Close
[0m23:20:52.346676 [debug] [Thread-1 (]: Database Error in model cleaned_taxi_trips (models/silver/cleaned_taxi_trips.sql)
  column "payment_type" does not exist
  compiled Code at target/run/nyc_taxi/models/silver/cleaned_taxi_trips.sql
[0m23:20:52.347965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '547ca582-7904-4a20-bac6-7a6316720297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78104d1605b0>]}
[0m23:20:52.349007 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_silver.cleaned_taxi_trips ......... [[31mERROR[0m in 0.46s]
[0m23:20:52.350295 [debug] [Thread-1 (]: Finished running node model.nyc_taxi.cleaned_taxi_trips
[0m23:20:52.352749 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:52.353217 [debug] [MainThread]: On master: BEGIN
[0m23:20:52.353670 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:20:52.362513 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:20:52.362926 [debug] [MainThread]: On master: COMMIT
[0m23:20:52.363254 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:52.363578 [debug] [MainThread]: On master: COMMIT
[0m23:20:52.363983 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:20:52.364306 [debug] [MainThread]: On master: Close
[0m23:20:52.365145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:20:52.365544 [debug] [MainThread]: Connection 'list_nyc_taxi_dw_public_silver' was properly closed.
[0m23:20:52.365871 [debug] [MainThread]: Connection 'model.nyc_taxi.cleaned_taxi_trips' was properly closed.
[0m23:20:52.366253 [info ] [MainThread]: 
[0m23:20:52.367055 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m23:20:52.367813 [debug] [MainThread]: Command end result
[0m23:20:52.380402 [info ] [MainThread]: 
[0m23:20:52.380999 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:20:52.381478 [info ] [MainThread]: 
[0m23:20:52.381913 [error] [MainThread]:   Database Error in model cleaned_taxi_trips (models/silver/cleaned_taxi_trips.sql)
  column "payment_type" does not exist
  compiled Code at target/run/nyc_taxi/models/silver/cleaned_taxi_trips.sql
[0m23:20:52.382324 [info ] [MainThread]: 
[0m23:20:52.382778 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:20:52.384847 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3192376, "process_user_time": 2.799906, "process_kernel_time": 0.242869, "process_mem_max_rss": "107848", "process_in_blocks": "87928", "process_out_blocks": "3520", "command_success": false}
[0m23:20:52.385423 [debug] [MainThread]: Command `dbt run` failed at 23:20:52.385273 after 1.32 seconds
[0m23:20:52.385796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78105097b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78104eb5d780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78104d31e470>]}
[0m23:20:52.386186 [debug] [MainThread]: Flushing usage events
[0m23:32:29.392718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c61be67d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c5fe19840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c5fe197e0>]}


============================== 23:32:29.397081 | a1e6ad69-cbdf-42f9-a55f-655d527f950a ==============================
[0m23:32:29.397081 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:32:29.397734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt --select silver', 'send_anonymous_usage_stats': 'True'}
[0m23:32:29.633773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1e6ad69-cbdf-42f9-a55f-655d527f950a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c5fe19900>]}
[0m23:32:29.763846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1e6ad69-cbdf-42f9-a55f-655d527f950a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c5e5c0100>]}
[0m23:32:29.765271 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m23:32:29.779149 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:32:29.845107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:32:29.846142 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/silver/cleaned_taxi_trips.sql
[0m23:32:30.361519 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_taxi.bronze
[0m23:32:30.366995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1e6ad69-cbdf-42f9-a55f-655d527f950a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c5df940d0>]}
[0m23:32:30.382151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1e6ad69-cbdf-42f9-a55f-655d527f950a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c5e0be710>]}
[0m23:32:30.382717 [info ] [MainThread]: Found 4 models, 51 tests, 1 source, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m23:32:30.383132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1e6ad69-cbdf-42f9-a55f-655d527f950a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c5defd090>]}
[0m23:32:30.384898 [info ] [MainThread]: 
[0m23:32:30.385739 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:30.386809 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw'
[0m23:32:30.397710 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw"
[0m23:32:30.398107 [debug] [ThreadPool]: On list_nyc_taxi_dw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:32:30.398508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:30.407626 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m23:32:30.408973 [debug] [ThreadPool]: On list_nyc_taxi_dw: Close
[0m23:32:30.411680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw, now list_nyc_taxi_dw_public_gold)
[0m23:32:30.417926 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:32:30.418395 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: BEGIN
[0m23:32:30.419284 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw_public_silver'
[0m23:32:30.419817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:30.423598 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:32:30.425959 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: BEGIN
[0m23:32:30.426444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:30.433714 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:32:30.434373 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:32:30.434925 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_gold"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m23:32:30.437618 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:32:30.438038 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:32:30.439167 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_silver"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m23:32:30.444043 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:32:30.445895 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: ROLLBACK
[0m23:32:30.446416 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:32:30.447575 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: ROLLBACK
[0m23:32:30.447924 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: Close
[0m23:32:30.448887 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: Close
[0m23:32:30.454627 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:30.454976 [debug] [MainThread]: On master: BEGIN
[0m23:32:30.455267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:30.460060 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:32:30.460405 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:30.460792 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:32:30.463948 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:32:30.465048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1e6ad69-cbdf-42f9-a55f-655d527f950a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c5df87970>]}
[0m23:32:30.465535 [debug] [MainThread]: On master: ROLLBACK
[0m23:32:30.465968 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:30.466282 [debug] [MainThread]: On master: BEGIN
[0m23:32:30.466802 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:32:30.467113 [debug] [MainThread]: On master: COMMIT
[0m23:32:30.467404 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:30.467675 [debug] [MainThread]: On master: COMMIT
[0m23:32:30.468043 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:32:30.468391 [debug] [MainThread]: On master: Close
[0m23:32:30.469215 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:32:30.470167 [info ] [MainThread]: 
[0m23:32:30.473764 [debug] [Thread-1 (]: Began running node model.nyc_taxi.cleaned_taxi_trips
[0m23:32:30.474593 [info ] [Thread-1 (]: 1 of 1 START sql table model public_silver.cleaned_taxi_trips .................. [RUN]
[0m23:32:30.475965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw_public_gold, now model.nyc_taxi.cleaned_taxi_trips)
[0m23:32:30.476874 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi.cleaned_taxi_trips
[0m23:32:30.493032 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi.cleaned_taxi_trips"
[0m23:32:30.493813 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.cleaned_taxi_trips (compile): 23:32:30.477474 => 23:32:30.493552
[0m23:32:30.494194 [debug] [Thread-1 (]: Began executing node model.nyc_taxi.cleaned_taxi_trips
[0m23:32:30.535692 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi.cleaned_taxi_trips"
[0m23:32:30.536799 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:32:30.537376 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: BEGIN
[0m23:32:30.537885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:30.550859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:32:30.551540 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:32:30.552712 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

  
    

  create  table "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips__dbt_tmp"
  
  
    as
  
  (
    

/*
  Silver Layer: cleaned_taxi_trips
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Transforms raw bronze strings into typed, cleaned, validated records.
  Business rules applied:
    - Cast all numeric strings to NUMERIC/INTEGER
    - Parse datetimes from ISO strings
    - Derive trip duration, speed, per-mile cost
    - Map payment_type codes to labels
    - Filter obvious bad records (negative fares, zero distance, etc.)
    - Deduplicate on business key
*/

WITH source AS (

    SELECT *
    FROM "nyc_taxi_dw"."bronze"."raw_taxi_trips"

),

cast_and_clean AS (

    SELECT
        ingestion_id,
        batch_id,
        ingested_at,

        -- Vendor (safe cast: only cast if looks like a small integer)
        CASE WHEN TRIM(COALESCE(vendor_id, '')) ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(vendor_id)::NUMERIC::INTEGER END            AS vendor_id,

        -- Timestamps
        tpep_pickup_datetime::TIMESTAMP                            AS pickup_datetime,
        tpep_dropoff_datetime::TIMESTAMP                           AS dropoff_datetime,

        -- Passengers & distance
        CASE WHEN TRIM(COALESCE(passenger_count, '')) ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(passenger_count)::NUMERIC::INTEGER END      AS passenger_count,
        CASE WHEN TRIM(COALESCE(trip_distance, '')) ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(trip_distance)::NUMERIC(10,2) END           AS trip_distance_miles,

        -- Location IDs
        CASE WHEN TRIM(COALESCE(pu_location_id, '')) ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(pu_location_id)::NUMERIC::INTEGER END       AS pickup_location_id,
        CASE WHEN TRIM(COALESCE(do_location_id, '')) ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(do_location_id)::NUMERIC::INTEGER END       AS dropoff_location_id,

        -- Rate & flags
        CASE WHEN TRIM(COALESCE(rate_code_id, '')) ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(rate_code_id)::NUMERIC::INTEGER END         AS rate_code_id,
        TRIM(store_and_fwd_flag)                                   AS store_and_fwd_flag,

        -- Payment
        CASE WHEN TRIM(COALESCE(payment_type, '')) ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(payment_type)::NUMERIC::INTEGER END         AS payment_type_code,
        CASE TRIM(payment_type)
            WHEN '1' THEN 'Credit Card'
            WHEN '2' THEN 'Cash'
            WHEN '3' THEN 'No Charge'
            WHEN '4' THEN 'Dispute'
            WHEN '5' THEN 'Unknown'
            WHEN '6' THEN 'Voided Trip'
            ELSE          'Other'
        END                                                        AS payment_type_label,

        -- Fare components (safe cast: NULL if not a valid decimal)
        CASE WHEN fare_amount ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(fare_amount)::NUMERIC(10,2) END             AS fare_amount,
        CASE WHEN extra ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(extra)::NUMERIC(10,2) END                   AS extra,
        CASE WHEN mta_tax ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(mta_tax)::NUMERIC(10,2) END                 AS mta_tax,
        CASE WHEN tip_amount ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(tip_amount)::NUMERIC(10,2) END              AS tip_amount,
        CASE WHEN tolls_amount ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(tolls_amount)::NUMERIC(10,2) END            AS tolls_amount,
        CASE WHEN improvement_surcharge ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(improvement_surcharge)::NUMERIC(10,2) END   AS improvement_surcharge,
        CASE WHEN congestion_surcharge ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(congestion_surcharge)::NUMERIC(10,2) END    AS congestion_surcharge,
        CASE WHEN airport_fee ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(airport_fee)::NUMERIC(10,2) END             AS airport_fee,
        CASE WHEN total_amount ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(total_amount)::NUMERIC(10,2) END            AS total_amount

    FROM source
    WHERE tpep_pickup_datetime IS NOT NULL
      AND tpep_dropoff_datetime IS NOT NULL
      AND total_amount IS NOT NULL

),

enrich AS (

    SELECT
        *,
        -- Derived metrics
        EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) / 60.0
                                                                    AS trip_duration_mins,
        CASE
            WHEN trip_distance_miles > 0
             AND EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) > 0
            THEN trip_distance_miles
                 / (EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) / 3600.0)
            ELSE NULL
        END                                                         AS avg_speed_mph,
        CASE
            WHEN trip_distance_miles > 0
            THEN total_amount / trip_distance_miles
            ELSE NULL
        END                                                         AS cost_per_mile,
        CASE
            WHEN total_amount > 0
            THEN tip_amount / total_amount
            ELSE 0
        END                                                         AS tip_percentage,

        -- Date parts for partitioning / BI
        DATE(pickup_datetime)                                       AS pickup_date,
        EXTRACT(HOUR FROM pickup_datetime)::BIGINT                 AS pickup_hour,
        TO_CHAR(pickup_datetime, 'Day')                            AS pickup_day_of_week,
        EXTRACT(MONTH FROM pickup_datetime)::BIGINT                AS pickup_month,
        EXTRACT(YEAR FROM pickup_datetime)::BIGINT                 AS pickup_year

    FROM cast_and_clean

),

deduplicated AS (

    SELECT *,
        ROW_NUMBER() OVER (
            PARTITION BY pickup_datetime, dropoff_datetime, vendor_id, total_amount
            ORDER BY ingestion_id DESC
        ) AS rn
    FROM enrich

),

validated AS (

    SELECT *
    FROM deduplicated
    WHERE rn = 1
      -- Business rule filters
      AND total_amount  > 0
      AND fare_amount   >= 0
      AND trip_distance_miles >= 0
      AND passenger_count BETWEEN 0 AND 20
      AND trip_duration_mins BETWEEN 1 AND 360  -- 1 min to 6 hrs
      AND pickup_datetime < dropoff_datetime

)

SELECT
    -- Surrogate key
    md5(cast(coalesce(cast(pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                                           AS trip_id,

    ingestion_id,
    batch_id,
    ingested_at,
    vendor_id,
    pickup_datetime,
    dropoff_datetime,
    pickup_date,
    pickup_hour,
    pickup_day_of_week,
    pickup_month,
    pickup_year,
    passenger_count,
    trip_distance_miles,
    pickup_location_id,
    dropoff_location_id,
    rate_code_id,
    store_and_fwd_flag,
    payment_type_code,
    payment_type_label,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    congestion_surcharge,
    airport_fee,
    total_amount,
    trip_duration_mins,
    avg_speed_mph,
    cost_per_mile,
    tip_percentage

FROM validated
  );
  
[0m23:32:30.849175 [debug] [Thread-1 (]: SQL status: SELECT 9103 in 0.0 seconds
[0m23:32:30.856698 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:32:30.857214 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */
alter table "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m23:32:30.857984 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:32:30.870195 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:32:30.870891 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

    create  index if not exists
  "3c431b61eee5243493def228b73289e1"
  on "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips" using btree
  (pickup_datetime);
  
[0m23:32:30.879256 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:32:30.881206 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:32:30.881659 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

    create  index if not exists
  "88da01ca752263920c60325be2b3d18f"
  on "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips" using btree
  (vendor_id);
  
[0m23:32:30.886168 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:32:30.887845 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:32:30.888232 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

    create  index if not exists
  "dcf8ea04d9e9d51e502bf7334402300e"
  on "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips" using btree
  (payment_type_code);
  
[0m23:32:30.894766 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:32:30.896843 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:32:30.897229 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

        ANALYZE "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
      
[0m23:32:30.986778 [debug] [Thread-1 (]: SQL status: ANALYZE in 0.0 seconds
[0m23:32:31.001639 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: COMMIT
[0m23:32:31.002164 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:32:31.002592 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: COMMIT
[0m23:32:31.015650 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:32:31.024762 [debug] [Thread-1 (]: Applying DROP to: "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips__dbt_backup"
[0m23:32:31.031195 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:32:31.031831 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */
drop table if exists "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips__dbt_backup" cascade
[0m23:32:31.032736 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:32:31.034896 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.cleaned_taxi_trips (execute): 23:32:30.494438 => 23:32:31.034622
[0m23:32:31.035510 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: Close
[0m23:32:31.037769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1e6ad69-cbdf-42f9-a55f-655d527f950a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c5de7add0>]}
[0m23:32:31.038551 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_silver.cleaned_taxi_trips ............. [[32mSELECT 9103[0m in 0.56s]
[0m23:32:31.039280 [debug] [Thread-1 (]: Finished running node model.nyc_taxi.cleaned_taxi_trips
[0m23:32:31.041619 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:31.042054 [debug] [MainThread]: On master: BEGIN
[0m23:32:31.042482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:32:31.049031 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:32:31.049425 [debug] [MainThread]: On master: COMMIT
[0m23:32:31.049733 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:31.050024 [debug] [MainThread]: On master: COMMIT
[0m23:32:31.050442 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:32:31.050776 [debug] [MainThread]: On master: Close
[0m23:32:31.051667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:31.052043 [debug] [MainThread]: Connection 'model.nyc_taxi.cleaned_taxi_trips' was properly closed.
[0m23:32:31.052404 [debug] [MainThread]: Connection 'list_nyc_taxi_dw_public_silver' was properly closed.
[0m23:32:31.052850 [info ] [MainThread]: 
[0m23:32:31.053384 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m23:32:31.054175 [debug] [MainThread]: Command end result
[0m23:32:31.066137 [info ] [MainThread]: 
[0m23:32:31.066760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:32:31.067238 [info ] [MainThread]: 
[0m23:32:31.067699 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:32:31.069656 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.722387, "process_user_time": 3.032149, "process_kernel_time": 0.151757, "process_mem_max_rss": "113024", "process_in_blocks": "27424", "process_out_blocks": "4072"}
[0m23:32:31.070186 [debug] [MainThread]: Command `dbt run` succeeded at 23:32:31.070062 after 1.72 seconds
[0m23:32:31.070565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c61be67d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c5de09090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7c5e5c0100>]}
[0m23:32:31.070935 [debug] [MainThread]: Flushing usage events
[0m23:34:13.083130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca005d26290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca003f8a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca003f8a170>]}


============================== 23:34:13.086433 | d0146ee7-c8b2-4856-bed9-9c0dbb1d95c5 ==============================
[0m23:34:13.086433 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:34:13.087034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt --select gold', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:34:13.260912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0146ee7-c8b2-4856-bed9-9c0dbb1d95c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca0027cafe0>]}
[0m23:34:13.352767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0146ee7-c8b2-4856-bed9-9c0dbb1d95c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca002543f40>]}
[0m23:34:13.353622 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m23:34:13.366048 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:34:13.397020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:34:13.397477 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:34:13.398390 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_taxi.bronze
[0m23:34:13.404351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0146ee7-c8b2-4856-bed9-9c0dbb1d95c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca00222bf10>]}
[0m23:34:13.422702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0146ee7-c8b2-4856-bed9-9c0dbb1d95c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca0023e87c0>]}
[0m23:34:13.423470 [info ] [MainThread]: Found 4 models, 51 tests, 1 source, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m23:34:13.423979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0146ee7-c8b2-4856-bed9-9c0dbb1d95c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca0023e8b80>]}
[0m23:34:13.426329 [info ] [MainThread]: 
[0m23:34:13.427399 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:34:13.429126 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw'
[0m23:34:13.445532 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw"
[0m23:34:13.446026 [debug] [ThreadPool]: On list_nyc_taxi_dw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:34:13.446380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:13.453043 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m23:34:13.454318 [debug] [ThreadPool]: On list_nyc_taxi_dw: Close
[0m23:34:13.455803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw, now create_nyc_taxi_dw_public_gold)
[0m23:34:13.456662 [debug] [ThreadPool]: Creating schema "database: "nyc_taxi_dw"
schema: "public_gold"
"
[0m23:34:13.461843 [debug] [ThreadPool]: Using postgres connection "create_nyc_taxi_dw_public_gold"
[0m23:34:13.462196 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_gold: BEGIN
[0m23:34:13.462507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:13.467687 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.468088 [debug] [ThreadPool]: Using postgres connection "create_nyc_taxi_dw_public_gold"
[0m23:34:13.468431 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_gold: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "create_nyc_taxi_dw_public_gold"} */
create schema if not exists "public_gold"
[0m23:34:13.469084 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:34:13.470016 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_gold: COMMIT
[0m23:34:13.470370 [debug] [ThreadPool]: Using postgres connection "create_nyc_taxi_dw_public_gold"
[0m23:34:13.470661 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_gold: COMMIT
[0m23:34:13.477464 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:34:13.477821 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_gold: Close
[0m23:34:13.480569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nyc_taxi_dw_public_gold, now list_nyc_taxi_dw_public_gold)
[0m23:34:13.481359 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw_public_silver'
[0m23:34:13.487186 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:34:13.489372 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:34:13.489747 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: BEGIN
[0m23:34:13.490083 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: BEGIN
[0m23:34:13.490409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:13.490721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:13.497912 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.498237 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.498588 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:34:13.498921 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:34:13.499272 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_silver"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m23:34:13.499662 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_gold"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m23:34:13.503329 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:34:13.505186 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: ROLLBACK
[0m23:34:13.505642 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:13.507191 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: ROLLBACK
[0m23:34:13.507741 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: Close
[0m23:34:13.508059 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: Close
[0m23:34:13.515516 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:13.515904 [debug] [MainThread]: On master: BEGIN
[0m23:34:13.516188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:34:13.522625 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.523145 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:13.523878 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:34:13.529238 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:34:13.530977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0146ee7-c8b2-4856-bed9-9c0dbb1d95c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca0022777f0>]}
[0m23:34:13.531608 [debug] [MainThread]: On master: ROLLBACK
[0m23:34:13.532138 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:13.532641 [debug] [MainThread]: On master: BEGIN
[0m23:34:13.533432 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.534013 [debug] [MainThread]: On master: COMMIT
[0m23:34:13.534467 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:13.534840 [debug] [MainThread]: On master: COMMIT
[0m23:34:13.535359 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:34:13.535829 [debug] [MainThread]: On master: Close
[0m23:34:13.539006 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:34:13.539636 [info ] [MainThread]: 
[0m23:34:13.585313 [debug] [Thread-1 (]: Began running node model.nyc_taxi.daily_trip_summary
[0m23:34:13.585758 [debug] [Thread-2 (]: Began running node model.nyc_taxi.hourly_demand_heatmap
[0m23:34:13.586090 [debug] [Thread-3 (]: Began running node model.nyc_taxi.payment_analysis
[0m23:34:13.586653 [info ] [Thread-1 (]: 1 of 3 START sql table model public_gold.daily_trip_summary .................... [RUN]
[0m23:34:13.587315 [info ] [Thread-2 (]: 2 of 3 START sql table model public_gold.hourly_demand_heatmap ................. [RUN]
[0m23:34:13.588031 [info ] [Thread-3 (]: 3 of 3 START sql table model public_gold.payment_analysis ...................... [RUN]
[0m23:34:13.588832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw_public_silver, now model.nyc_taxi.daily_trip_summary)
[0m23:34:13.589496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw_public_gold, now model.nyc_taxi.hourly_demand_heatmap)
[0m23:34:13.590211 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nyc_taxi.payment_analysis'
[0m23:34:13.590639 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi.daily_trip_summary
[0m23:34:13.591013 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi.hourly_demand_heatmap
[0m23:34:13.591390 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi.payment_analysis
[0m23:34:13.615273 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi.hourly_demand_heatmap"
[0m23:34:13.615826 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi.daily_trip_summary"
[0m23:34:13.620321 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi.payment_analysis"
[0m23:34:13.623125 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.daily_trip_summary (compile): 23:34:13.591690 => 23:34:13.622800
[0m23:34:13.623753 [debug] [Thread-1 (]: Began executing node model.nyc_taxi.daily_trip_summary
[0m23:34:13.624384 [debug] [Thread-2 (]: Timing info for model.nyc_taxi.hourly_demand_heatmap (compile): 23:34:13.612182 => 23:34:13.623983
[0m23:34:13.630180 [debug] [Thread-2 (]: Began executing node model.nyc_taxi.hourly_demand_heatmap
[0m23:34:13.637812 [debug] [Thread-3 (]: Timing info for model.nyc_taxi.payment_analysis (compile): 23:34:13.616139 => 23:34:13.637459
[0m23:34:13.687691 [debug] [Thread-3 (]: Began executing node model.nyc_taxi.payment_analysis
[0m23:34:13.687158 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi.hourly_demand_heatmap"
[0m23:34:13.686549 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi.daily_trip_summary"
[0m23:34:13.691626 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi.payment_analysis"
[0m23:34:13.693992 [debug] [Thread-2 (]: Using postgres connection "model.nyc_taxi.hourly_demand_heatmap"
[0m23:34:13.694574 [debug] [Thread-2 (]: On model.nyc_taxi.hourly_demand_heatmap: BEGIN
[0m23:34:13.695055 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.daily_trip_summary"
[0m23:34:13.695826 [debug] [Thread-1 (]: On model.nyc_taxi.daily_trip_summary: BEGIN
[0m23:34:13.695390 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:34:13.696165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:13.696494 [debug] [Thread-3 (]: Using postgres connection "model.nyc_taxi.payment_analysis"
[0m23:34:13.697399 [debug] [Thread-3 (]: On model.nyc_taxi.payment_analysis: BEGIN
[0m23:34:13.697897 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:34:13.706622 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.707235 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.daily_trip_summary"
[0m23:34:13.708239 [debug] [Thread-1 (]: On model.nyc_taxi.daily_trip_summary: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.daily_trip_summary"} */

  
    

  create  table "nyc_taxi_dw"."public_gold"."daily_trip_summary__dbt_tmp"
  
  
    as
  
  (
    

/*
  Gold Layer: daily_trip_summary
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Business-ready daily aggregation of NYC taxi trips.
  Directly consumed by Power BI dashboards.
  Metrics: trips, revenue, tips, distances, duration, passenger counts.
*/

WITH base AS (

    SELECT *
    FROM "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"

),

daily_agg AS (

    SELECT
        pickup_date,
        pickup_year,
        pickup_month,
        vendor_id,
        payment_type_label,

        -- Volume
        COUNT(*)                                                AS total_trips,
        SUM(passenger_count)                                    AS total_passengers,

        -- Revenue
        ROUND(SUM(total_amount)::NUMERIC, 2)                   AS total_revenue,
        ROUND(AVG(total_amount)::NUMERIC, 2)                   AS avg_fare_per_trip,
        ROUND(SUM(fare_amount)::NUMERIC, 2)                    AS total_base_fare,
        ROUND(SUM(tip_amount)::NUMERIC, 2)                     AS total_tips,
        ROUND(AVG(tip_percentage)::NUMERIC, 4)                 AS avg_tip_rate,
        ROUND(SUM(tolls_amount)::NUMERIC, 2)                   AS total_tolls,
        ROUND(SUM(congestion_surcharge)::NUMERIC, 2)           AS total_congestion_surcharge,

        -- Distance
        ROUND(SUM(trip_distance_miles)::NUMERIC, 2)            AS total_distance_miles,
        ROUND(AVG(trip_distance_miles)::NUMERIC, 2)            AS avg_distance_miles,

        -- Duration
        ROUND(AVG(trip_duration_mins)::NUMERIC, 2)             AS avg_duration_mins,
        ROUND(SUM(trip_duration_mins)::NUMERIC, 2)             AS total_duration_mins,

        -- Speed & cost efficiency
        ROUND(AVG(avg_speed_mph)::NUMERIC, 2)                  AS avg_speed_mph,
        ROUND(AVG(cost_per_mile)::NUMERIC, 2)                  AS avg_cost_per_mile,

        -- Peak hour (mode)
        MODE() WITHIN GROUP (ORDER BY pickup_hour)             AS peak_pickup_hour

    FROM base
    GROUP BY
        pickup_date,
        pickup_year,
        pickup_month,
        vendor_id,
        payment_type_label

)

SELECT
    -- Surrogate key
    md5(cast(coalesce(cast(pickup_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(payment_type_label as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                                       AS summary_id,

    pickup_date,
    pickup_year,
    pickup_month,
    TO_CHAR(pickup_date, 'Month')                              AS month_name,
    TO_CHAR(pickup_date, 'Day')                                AS day_of_week,
    vendor_id,
    CASE vendor_id
        WHEN 1 THEN 'Creative Mobile Technologies'
        WHEN 2 THEN 'VeriFone Inc.'
        ELSE        'Unknown Vendor'
    END                                                         AS vendor_name,
    payment_type_label,
    total_trips,
    total_passengers,
    total_revenue,
    avg_fare_per_trip,
    total_base_fare,
    total_tips,
    avg_tip_rate,
    total_tolls,
    total_congestion_surcharge,
    total_distance_miles,
    avg_distance_miles,
    avg_duration_mins,
    total_duration_mins,
    avg_speed_mph,
    avg_cost_per_mile,
    peak_pickup_hour,
    NOW()                                                       AS last_updated_at

FROM daily_agg
  );
  
[0m23:34:13.708726 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.709510 [debug] [Thread-3 (]: Using postgres connection "model.nyc_taxi.payment_analysis"
[0m23:34:13.709003 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.710215 [debug] [Thread-3 (]: On model.nyc_taxi.payment_analysis: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.payment_analysis"} */

  
    

  create  table "nyc_taxi_dw"."public_gold"."payment_analysis__dbt_tmp"
  
  
    as
  
  (
    

/*
  Gold Layer: payment_analysis
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Payment type breakdown with tipping behavior analysis.
  Drives donut charts and tip behavior dashboards in Power BI.
*/

WITH base AS (

    SELECT *
    FROM "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"

),

payment_agg AS (

    SELECT
        payment_type_code,
        payment_type_label,
        COUNT(*)                                           AS trip_count,
        ROUND(SUM(total_amount)::NUMERIC, 2)              AS total_revenue,
        ROUND(AVG(total_amount)::NUMERIC, 2)              AS avg_fare,
        ROUND(SUM(tip_amount)::NUMERIC, 2)                AS total_tips,
        ROUND(AVG(tip_amount)::NUMERIC, 2)                AS avg_tip,
        ROUND(AVG(tip_percentage)::NUMERIC, 4)            AS avg_tip_rate,
        COUNT(*) FILTER (WHERE tip_amount > 0)            AS tipped_trips,
        ROUND(AVG(trip_distance_miles)::NUMERIC, 2)       AS avg_distance,
        ROUND(AVG(trip_duration_mins)::NUMERIC, 2)        AS avg_duration_mins
    FROM base
    GROUP BY payment_type_code, payment_type_label

),

totals AS (
    SELECT SUM(trip_count) AS grand_total_trips,
           SUM(total_revenue) AS grand_total_revenue
    FROM payment_agg
)

SELECT
    p.*,
    ROUND((p.trip_count::NUMERIC / t.grand_total_trips) * 100, 2) AS pct_of_total_trips,
    ROUND((p.total_revenue::NUMERIC / t.grand_total_revenue) * 100, 2) AS pct_of_total_revenue,
    ROUND((p.tipped_trips::NUMERIC / NULLIF(p.trip_count, 0)) * 100, 2) AS tip_frequency_pct,
    NOW() AS last_updated_at
FROM payment_agg p
CROSS JOIN totals t
ORDER BY trip_count DESC
  );
  
[0m23:34:13.710961 [debug] [Thread-2 (]: Using postgres connection "model.nyc_taxi.hourly_demand_heatmap"
[0m23:34:13.712402 [debug] [Thread-2 (]: On model.nyc_taxi.hourly_demand_heatmap: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.hourly_demand_heatmap"} */

  
    

  create  table "nyc_taxi_dw"."public_gold"."hourly_demand_heatmap__dbt_tmp"
  
  
    as
  
  (
    

/*
  Gold Layer: hourly_demand_heatmap
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Hour-of-day Ã— Day-of-week demand matrix for Power BI heatmap visuals.
*/

WITH base AS (

    SELECT
        pickup_hour,
        pickup_day_of_week,
        pickup_date,
        EXTRACT(DOW FROM pickup_datetime)::INTEGER AS day_of_week_num,
        total_amount,
        trip_distance_miles,
        trip_duration_mins
    FROM "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"

)

SELECT
    pickup_hour,
    pickup_day_of_week,
    day_of_week_num,
    COUNT(*)                                          AS trip_count,
    ROUND(AVG(total_amount)::NUMERIC, 2)             AS avg_fare,
    ROUND(AVG(trip_distance_miles)::NUMERIC, 2)      AS avg_distance,
    ROUND(AVG(trip_duration_mins)::NUMERIC, 2)       AS avg_duration_mins,
    ROUND(SUM(total_amount)::NUMERIC, 2)             AS total_revenue,
    NOW()                                             AS last_updated_at

FROM base
GROUP BY pickup_hour, pickup_day_of_week, day_of_week_num
ORDER BY day_of_week_num, pickup_hour
  );
  
[0m23:34:13.748282 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m23:34:13.749080 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.0 seconds
[0m23:34:13.763514 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.0 seconds
[0m23:34:13.775691 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.daily_trip_summary"
[0m23:34:13.780766 [debug] [Thread-1 (]: On model.nyc_taxi.daily_trip_summary: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.daily_trip_summary"} */
alter table "nyc_taxi_dw"."public_gold"."daily_trip_summary__dbt_tmp" rename to "daily_trip_summary"
[0m23:34:13.781747 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:34:13.778722 [debug] [Thread-2 (]: Using postgres connection "model.nyc_taxi.hourly_demand_heatmap"
[0m23:34:13.788094 [debug] [Thread-2 (]: On model.nyc_taxi.hourly_demand_heatmap: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.hourly_demand_heatmap"} */
alter table "nyc_taxi_dw"."public_gold"."hourly_demand_heatmap__dbt_tmp" rename to "hourly_demand_heatmap"
[0m23:34:13.780124 [debug] [Thread-3 (]: Using postgres connection "model.nyc_taxi.payment_analysis"
[0m23:34:13.788817 [debug] [Thread-3 (]: On model.nyc_taxi.payment_analysis: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.payment_analysis"} */
alter table "nyc_taxi_dw"."public_gold"."payment_analysis__dbt_tmp" rename to "payment_analysis"
[0m23:34:13.789419 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:34:13.801431 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:34:13.819386 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.daily_trip_summary"
[0m23:34:13.845494 [debug] [Thread-1 (]: On model.nyc_taxi.daily_trip_summary: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.daily_trip_summary"} */

    create  index if not exists
  "ce050c90e8f4919dcf20de3ec1110df4"
  on "nyc_taxi_dw"."public_gold"."daily_trip_summary" using btree
  (pickup_date);
  
[0m23:34:13.853600 [debug] [Thread-2 (]: On model.nyc_taxi.hourly_demand_heatmap: COMMIT
[0m23:34:13.863166 [debug] [Thread-2 (]: Using postgres connection "model.nyc_taxi.hourly_demand_heatmap"
[0m23:34:13.865618 [debug] [Thread-2 (]: On model.nyc_taxi.hourly_demand_heatmap: COMMIT
[0m23:34:13.867181 [debug] [Thread-3 (]: On model.nyc_taxi.payment_analysis: COMMIT
[0m23:34:13.868755 [debug] [Thread-3 (]: Using postgres connection "model.nyc_taxi.payment_analysis"
[0m23:34:13.869692 [debug] [Thread-3 (]: On model.nyc_taxi.payment_analysis: COMMIT
[0m23:34:13.873713 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:34:13.885770 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:34:13.900955 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:34:13.902475 [debug] [Thread-1 (]: On model.nyc_taxi.daily_trip_summary: COMMIT
[0m23:34:13.910114 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.daily_trip_summary"
[0m23:34:13.910737 [debug] [Thread-1 (]: On model.nyc_taxi.daily_trip_summary: COMMIT
[0m23:34:13.909493 [debug] [Thread-2 (]: Applying DROP to: "nyc_taxi_dw"."public_gold"."hourly_demand_heatmap__dbt_backup"
[0m23:34:13.908788 [debug] [Thread-3 (]: Applying DROP to: "nyc_taxi_dw"."public_gold"."payment_analysis__dbt_backup"
[0m23:34:13.919828 [debug] [Thread-3 (]: Using postgres connection "model.nyc_taxi.payment_analysis"
[0m23:34:13.922572 [debug] [Thread-3 (]: On model.nyc_taxi.payment_analysis: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.payment_analysis"} */
drop table if exists "nyc_taxi_dw"."public_gold"."payment_analysis__dbt_backup" cascade
[0m23:34:13.922059 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:34:13.921438 [debug] [Thread-2 (]: Using postgres connection "model.nyc_taxi.hourly_demand_heatmap"
[0m23:34:13.927592 [debug] [Thread-2 (]: On model.nyc_taxi.hourly_demand_heatmap: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.hourly_demand_heatmap"} */
drop table if exists "nyc_taxi_dw"."public_gold"."hourly_demand_heatmap__dbt_backup" cascade
[0m23:34:13.926992 [debug] [Thread-1 (]: Applying DROP to: "nyc_taxi_dw"."public_gold"."daily_trip_summary__dbt_backup"
[0m23:34:13.929115 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.daily_trip_summary"
[0m23:34:13.929608 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:34:13.930061 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:34:13.930623 [debug] [Thread-1 (]: On model.nyc_taxi.daily_trip_summary: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.daily_trip_summary"} */
drop table if exists "nyc_taxi_dw"."public_gold"."daily_trip_summary__dbt_backup" cascade
[0m23:34:13.936421 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:34:13.933245 [debug] [Thread-3 (]: Timing info for model.nyc_taxi.payment_analysis (execute): 23:34:13.687933 => 23:34:13.932941
[0m23:34:13.935476 [debug] [Thread-2 (]: Timing info for model.nyc_taxi.hourly_demand_heatmap (execute): 23:34:13.648396 => 23:34:13.935178
[0m23:34:13.938611 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.daily_trip_summary (execute): 23:34:13.624710 => 23:34:13.938261
[0m23:34:13.939236 [debug] [Thread-3 (]: On model.nyc_taxi.payment_analysis: Close
[0m23:34:13.945816 [debug] [Thread-1 (]: On model.nyc_taxi.daily_trip_summary: Close
[0m23:34:13.940206 [debug] [Thread-2 (]: On model.nyc_taxi.hourly_demand_heatmap: Close
[0m23:34:13.949694 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0146ee7-c8b2-4856-bed9-9c0dbb1d95c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca002121d20>]}
[0m23:34:13.956621 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0146ee7-c8b2-4856-bed9-9c0dbb1d95c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca00228f670>]}
[0m23:34:13.965549 [info ] [Thread-3 (]: 3 of 3 OK created sql table model public_gold.payment_analysis ................. [[32mSELECT 4[0m in 0.36s]
[0m23:34:13.968609 [debug] [Thread-3 (]: Finished running node model.nyc_taxi.payment_analysis
[0m23:34:13.966404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0146ee7-c8b2-4856-bed9-9c0dbb1d95c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca00228e350>]}
[0m23:34:13.967466 [info ] [Thread-2 (]: 2 of 3 OK created sql table model public_gold.hourly_demand_heatmap ............ [[32mSELECT 4[0m in 0.37s]
[0m23:34:13.971214 [debug] [Thread-2 (]: Finished running node model.nyc_taxi.hourly_demand_heatmap
[0m23:34:13.969749 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public_gold.daily_trip_summary ............... [[32mSELECT 6[0m in 0.38s]
[0m23:34:13.972682 [debug] [Thread-1 (]: Finished running node model.nyc_taxi.daily_trip_summary
[0m23:34:13.977525 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:13.980526 [debug] [MainThread]: On master: BEGIN
[0m23:34:13.982227 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:34:13.997586 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:34:13.998325 [debug] [MainThread]: On master: COMMIT
[0m23:34:13.998837 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:13.999252 [debug] [MainThread]: On master: COMMIT
[0m23:34:14.001728 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:34:14.002260 [debug] [MainThread]: On master: Close
[0m23:34:14.003963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:14.006558 [debug] [MainThread]: Connection 'model.nyc_taxi.hourly_demand_heatmap' was properly closed.
[0m23:34:14.007049 [debug] [MainThread]: Connection 'model.nyc_taxi.daily_trip_summary' was properly closed.
[0m23:34:14.007528 [debug] [MainThread]: Connection 'model.nyc_taxi.payment_analysis' was properly closed.
[0m23:34:14.008102 [info ] [MainThread]: 
[0m23:34:14.008668 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m23:34:14.010230 [debug] [MainThread]: Command end result
[0m23:34:14.033565 [info ] [MainThread]: 
[0m23:34:14.034621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:34:14.035400 [info ] [MainThread]: 
[0m23:34:14.036134 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:34:14.037452 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.99680245, "process_user_time": 2.736212, "process_kernel_time": 0.114008, "process_mem_max_rss": "108768", "process_in_blocks": "16", "process_out_blocks": "2888"}
[0m23:34:14.038163 [debug] [MainThread]: Command `dbt run` succeeded at 23:34:14.037999 after 1.00 seconds
[0m23:34:14.038680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca005d26290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca002789300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca002543f40>]}
[0m23:34:14.039205 [debug] [MainThread]: Flushing usage events
[0m23:35:45.354478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72652c263af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72652a4cd8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72652a4cd840>]}


============================== 23:35:45.357765 | 954a0b67-4150-4c7e-8798-cf582d08ff1b ==============================
[0m23:35:45.357765 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:35:45.358431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /dbt --project-dir /dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:35:45.535001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '954a0b67-4150-4c7e-8798-cf582d08ff1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726528c86e00>]}
[0m23:35:45.625152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '954a0b67-4150-4c7e-8798-cf582d08ff1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726528a85d80>]}
[0m23:35:45.626278 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m23:35:45.642705 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:35:45.674666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:35:45.675059 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:35:45.675912 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_taxi.bronze
[0m23:35:45.681686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '954a0b67-4150-4c7e-8798-cf582d08ff1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72652875cac0>]}
[0m23:35:45.696452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '954a0b67-4150-4c7e-8798-cf582d08ff1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726528928b20>]}
[0m23:35:45.696915 [info ] [MainThread]: Found 4 models, 51 tests, 1 source, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m23:35:45.697317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '954a0b67-4150-4c7e-8798-cf582d08ff1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726528928dc0>]}
[0m23:35:45.700925 [info ] [MainThread]: 
[0m23:35:45.701765 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:35:45.703210 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw_public_silver'
[0m23:35:45.717040 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw_public_gold'
[0m23:35:45.718765 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:35:45.738621 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: BEGIN
[0m23:35:45.737695 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:35:45.741590 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: BEGIN
[0m23:35:45.740626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:45.742044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:45.758712 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:35:45.759333 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:35:45.759814 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_gold"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m23:35:45.761957 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:35:45.762597 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:35:45.764020 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_silver"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m23:35:45.769950 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m23:35:45.770913 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:45.772885 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: ROLLBACK
[0m23:35:45.774428 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: ROLLBACK
[0m23:35:45.775026 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: Close
[0m23:35:45.777056 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: Close
[0m23:35:45.786791 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:45.787213 [debug] [MainThread]: On master: BEGIN
[0m23:35:45.787660 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:35:45.802894 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:35:45.804521 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:45.805794 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:35:45.814089 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:35:45.815985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '954a0b67-4150-4c7e-8798-cf582d08ff1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726528b98cd0>]}
[0m23:35:45.816754 [debug] [MainThread]: On master: ROLLBACK
[0m23:35:45.817315 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:45.817773 [debug] [MainThread]: On master: BEGIN
[0m23:35:45.818506 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:35:45.819019 [debug] [MainThread]: On master: COMMIT
[0m23:35:45.819463 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:45.819875 [debug] [MainThread]: On master: COMMIT
[0m23:35:45.820405 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:35:45.820841 [debug] [MainThread]: On master: Close
[0m23:35:45.823899 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:35:45.824566 [info ] [MainThread]: 
[0m23:35:45.828824 [debug] [Thread-1 (]: Began running node test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8
[0m23:35:45.829950 [debug] [Thread-2 (]: Began running node test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019
[0m23:35:45.833923 [debug] [Thread-4 (]: Began running node test.nyc_taxi.assert_dropoff_after_pickup
[0m23:35:45.830513 [debug] [Thread-3 (]: Began running node test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7
[0m23:35:45.829473 [info ] [Thread-1 (]: 1 of 51 START test accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6  [RUN]
[0m23:35:45.836291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw_public_gold, now test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8)
[0m23:35:45.834762 [info ] [Thread-4 (]: 4 of 51 START test assert_dropoff_after_pickup ................................. [RUN]
[0m23:35:45.833215 [info ] [Thread-2 (]: 2 of 51 START test accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other  [RUN]
[0m23:35:45.840574 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw_public_silver, now test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019)
[0m23:35:45.837307 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8
[0m23:35:45.841142 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019
[0m23:35:45.835409 [info ] [Thread-3 (]: 3 of 51 START test accepted_values_cleaned_taxi_trips_vendor_id__1__2 .......... [RUN]
[0m23:35:45.839672 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.nyc_taxi.assert_dropoff_after_pickup'
[0m23:35:45.893751 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8"
[0m23:35:45.900847 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019"
[0m23:35:45.901688 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7'
[0m23:35:45.902800 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7
[0m23:35:45.902129 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.assert_dropoff_after_pickup
[0m23:35:45.907501 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7"
[0m23:35:45.910330 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.assert_dropoff_after_pickup"
[0m23:35:45.910983 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019 (compile): 23:35:45.894091 => 23:35:45.910744
[0m23:35:45.912539 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019
[0m23:35:45.911391 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8 (compile): 23:35:45.841511 => 23:35:45.911181
[0m23:35:45.924252 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8
[0m23:35:45.911941 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7 (compile): 23:35:45.903247 => 23:35:45.911736
[0m23:35:45.935594 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7
[0m23:35:45.951001 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019"
[0m23:35:45.952493 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7"
[0m23:35:45.954867 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8"
[0m23:35:45.955552 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.assert_dropoff_after_pickup (compile): 23:35:45.907956 => 23:35:45.955203
[0m23:35:45.956786 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.assert_dropoff_after_pickup
[0m23:35:45.957585 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019"
[0m23:35:45.957947 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7"
[0m23:35:45.961467 [debug] [Thread-3 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7: BEGIN
[0m23:35:45.960241 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.assert_dropoff_after_pickup"
[0m23:35:45.961079 [debug] [Thread-2 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019: BEGIN
[0m23:35:45.962397 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:45.960734 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8"
[0m23:35:45.961816 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:35:45.965193 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.assert_dropoff_after_pickup"
[0m23:35:45.965723 [debug] [Thread-4 (]: On test.nyc_taxi.assert_dropoff_after_pickup: BEGIN
[0m23:35:45.964034 [debug] [Thread-1 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8: BEGIN
[0m23:35:45.966729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:45.966185 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:35:45.974128 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:45.974867 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7"
[0m23:35:45.975440 [debug] [Thread-3 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        vendor_id as value_field,
        count(*) as n_records

    from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
    group by vendor_id

)

select *
from all_values
where value_field not in (
    '1','2'
)



      
    ) dbt_internal_test
[0m23:35:45.979234 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:45.982742 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7 (execute): 23:35:45.936004 => 23:35:45.982412
[0m23:35:45.983393 [debug] [Thread-3 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7: ROLLBACK
[0m23:35:45.984179 [debug] [Thread-3 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7: Close
[0m23:35:45.984694 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:45.987031 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019"
[0m23:35:45.985313 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:45.986428 [info ] [Thread-3 (]: 3 of 51 PASS accepted_values_cleaned_taxi_trips_vendor_id__1__2 ................ [[32mPASS[0m in 0.08s]
[0m23:35:45.985029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:45.987614 [debug] [Thread-2 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type_label as value_field,
        count(*) as n_records

    from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
    group by payment_type_label

)

select *
from all_values
where value_field not in (
    'Credit Card','Cash','No Charge','Dispute','Unknown','Voided Trip','Other'
)



      
    ) dbt_internal_test
[0m23:35:45.988213 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.assert_dropoff_after_pickup"
[0m23:35:45.989748 [debug] [Thread-4 (]: On test.nyc_taxi.assert_dropoff_after_pickup: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.assert_dropoff_after_pickup"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Singular test: No trips should have dropoff BEFORE pickup
-- File: tests/assert_dropoff_after_pickup.sql

SELECT
    trip_id,
    pickup_datetime,
    dropoff_datetime,
    trip_duration_mins
FROM "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
WHERE dropoff_datetime <= pickup_datetime
   OR trip_duration_mins <= 0
      
    ) dbt_internal_test
[0m23:35:45.988795 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7
[0m23:35:45.989178 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8"
[0m23:35:45.991714 [debug] [Thread-1 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type_code as value_field,
        count(*) as n_records

    from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
    group by payment_type_code

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6'
)



      
    ) dbt_internal_test
[0m23:35:45.990539 [debug] [Thread-3 (]: Began running node test.nyc_taxi.assert_gold_coverage
[0m23:35:45.994913 [info ] [Thread-3 (]: 5 of 51 START test assert_gold_coverage ........................................ [RUN]
[0m23:35:45.996212 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7, now test.nyc_taxi.assert_gold_coverage)
[0m23:35:45.997583 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.assert_gold_coverage
[0m23:35:45.999366 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.004395 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.assert_gold_coverage"
[0m23:35:46.005064 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.005547 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.007555 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019 (execute): 23:35:45.913069 => 23:35:46.007171
[0m23:35:46.009622 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.assert_dropoff_after_pickup (execute): 23:35:45.958146 => 23:35:46.009392
[0m23:35:46.010052 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.assert_gold_coverage (compile): 23:35:45.999660 => 23:35:46.009858
[0m23:35:46.011364 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8 (execute): 23:35:45.924681 => 23:35:46.011141
[0m23:35:46.012990 [debug] [Thread-1 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8: ROLLBACK
[0m23:35:46.011776 [debug] [Thread-2 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019: ROLLBACK
[0m23:35:46.012608 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.assert_gold_coverage
[0m23:35:46.012194 [debug] [Thread-4 (]: On test.nyc_taxi.assert_dropoff_after_pickup: ROLLBACK
[0m23:35:46.013538 [debug] [Thread-2 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019: Close
[0m23:35:46.013936 [debug] [Thread-1 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8: Close
[0m23:35:46.016302 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.assert_gold_coverage"
[0m23:35:46.020002 [debug] [Thread-4 (]: On test.nyc_taxi.assert_dropoff_after_pickup: Close
[0m23:35:46.019580 [info ] [Thread-2 (]: 2 of 51 PASS accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other  [[32mPASS[0m in 0.18s]
[0m23:35:46.024667 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019
[0m23:35:46.027450 [debug] [Thread-2 (]: Began running node test.nyc_taxi.assert_total_amount_gte_fare
[0m23:35:46.021037 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.assert_gold_coverage"
[0m23:35:46.028595 [debug] [Thread-3 (]: On test.nyc_taxi.assert_gold_coverage: BEGIN
[0m23:35:46.023193 [info ] [Thread-1 (]: 1 of 51 PASS accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6  [[32mPASS[0m in 0.19s]
[0m23:35:46.030033 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8
[0m23:35:46.030714 [debug] [Thread-1 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad
[0m23:35:46.029159 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:46.026826 [info ] [Thread-4 (]: 4 of 51 PASS assert_dropoff_after_pickup ....................................... [[32mPASS[0m in 0.19s]
[0m23:35:46.032994 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.assert_dropoff_after_pickup
[0m23:35:46.033619 [debug] [Thread-4 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388
[0m23:35:46.027974 [info ] [Thread-2 (]: 6 of 51 START test assert_total_amount_gte_fare ................................ [RUN]
[0m23:35:46.031867 [info ] [Thread-1 (]: 7 of 51 START test dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0  [RUN]
[0m23:35:46.039969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8, now test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad)
[0m23:35:46.036039 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019, now test.nyc_taxi.assert_total_amount_gte_fare)
[0m23:35:46.041848 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.assert_total_amount_gte_fare
[0m23:35:46.034822 [info ] [Thread-4 (]: 8 of 51 START test dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1  [RUN]
[0m23:35:46.040675 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad
[0m23:35:46.048240 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.assert_total_amount_gte_fare"
[0m23:35:46.049123 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.assert_dropoff_after_pickup, now test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388)
[0m23:35:46.049497 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.058328 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad"
[0m23:35:46.058876 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388
[0m23:35:46.059301 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.assert_total_amount_gte_fare (compile): 23:35:46.042219 => 23:35:46.059096
[0m23:35:46.059711 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.assert_gold_coverage"
[0m23:35:46.064448 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388"
[0m23:35:46.064916 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.assert_total_amount_gte_fare
[0m23:35:46.065572 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad (compile): 23:35:46.049752 => 23:35:46.065245
[0m23:35:46.066318 [debug] [Thread-3 (]: On test.nyc_taxi.assert_gold_coverage: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.assert_gold_coverage"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Singular test: Every silver trip date should appear in gold summary
-- Detects data loss in the silver â†’ gold transformation
-- File: tests/assert_gold_coverage.sql

WITH silver_dates AS (
    SELECT DISTINCT pickup_date
    FROM "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
),

gold_dates AS (
    SELECT DISTINCT pickup_date
    FROM "nyc_taxi_dw"."public_gold"."daily_trip_summary"
)

SELECT s.pickup_date
FROM silver_dates s
LEFT JOIN gold_dates g ON s.pickup_date = g.pickup_date
WHERE g.pickup_date IS NULL
      
    ) dbt_internal_test
[0m23:35:46.067531 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388 (compile): 23:35:46.060068 => 23:35:46.067218
[0m23:35:46.071571 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.assert_total_amount_gte_fare"
[0m23:35:46.072645 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388
[0m23:35:46.073383 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.assert_total_amount_gte_fare"
[0m23:35:46.072023 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad
[0m23:35:46.076985 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388"
[0m23:35:46.077549 [debug] [Thread-2 (]: On test.nyc_taxi.assert_total_amount_gte_fare: BEGIN
[0m23:35:46.078050 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.080270 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad"
[0m23:35:46.080821 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:46.082389 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.assert_gold_coverage (execute): 23:35:46.014136 => 23:35:46.082151
[0m23:35:46.082762 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388"
[0m23:35:46.084756 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388: BEGIN
[0m23:35:46.083973 [debug] [Thread-3 (]: On test.nyc_taxi.assert_gold_coverage: ROLLBACK
[0m23:35:46.083303 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad"
[0m23:35:46.086000 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad: BEGIN
[0m23:35:46.085291 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:46.086610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:46.088088 [debug] [Thread-3 (]: On test.nyc_taxi.assert_gold_coverage: Close
[0m23:35:46.089563 [info ] [Thread-3 (]: 5 of 51 PASS assert_gold_coverage .............................................. [[32mPASS[0m in 0.09s]
[0m23:35:46.090913 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.assert_gold_coverage
[0m23:35:46.091792 [debug] [Thread-3 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268
[0m23:35:46.093222 [info ] [Thread-3 (]: 9 of 51 START test dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0  [RUN]
[0m23:35:46.096184 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.assert_gold_coverage, now test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268)
[0m23:35:46.098252 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268
[0m23:35:46.106731 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.109231 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268"
[0m23:35:46.110039 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.assert_total_amount_gte_fare"
[0m23:35:46.110746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.111220 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.112083 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268 (compile): 23:35:46.098598 => 23:35:46.111757
[0m23:35:46.112500 [debug] [Thread-2 (]: On test.nyc_taxi.assert_total_amount_gte_fare: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.assert_total_amount_gte_fare"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Singular test: Total amount should always be >= fare_amount
-- (total = fare + tips + surcharges, never less than base fare)
-- File: tests/assert_total_amount_gte_fare.sql

SELECT
    trip_id,
    fare_amount,
    total_amount,
    tip_amount,
    tolls_amount
FROM "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
WHERE total_amount < fare_amount
  AND total_amount > 0
      
    ) dbt_internal_test
[0m23:35:46.112897 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad"
[0m23:35:46.114271 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"

where not(fare_amount >= 0)


      
    ) dbt_internal_test
[0m23:35:46.113709 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268
[0m23:35:46.113298 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388"
[0m23:35:46.124223 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"

where not(tip_percentage BETWEEN 0 AND 1)


      
    ) dbt_internal_test
[0m23:35:46.124768 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.125617 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268"
[0m23:35:46.129081 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268"
[0m23:35:46.126049 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.131764 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad (execute): 23:35:46.078248 => 23:35:46.131439
[0m23:35:46.129680 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268: BEGIN
[0m23:35:46.132946 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:46.128282 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.assert_total_amount_gte_fare (execute): 23:35:46.067856 => 23:35:46.127948
[0m23:35:46.133766 [debug] [Thread-2 (]: On test.nyc_taxi.assert_total_amount_gte_fare: ROLLBACK
[0m23:35:46.132383 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad: ROLLBACK
[0m23:35:46.134676 [debug] [Thread-2 (]: On test.nyc_taxi.assert_total_amount_gte_fare: Close
[0m23:35:46.138708 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad: Close
[0m23:35:46.136228 [info ] [Thread-2 (]: 6 of 51 PASS assert_total_amount_gte_fare ...................................... [[32mPASS[0m in 0.10s]
[0m23:35:46.143054 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.assert_total_amount_gte_fare
[0m23:35:46.144074 [debug] [Thread-2 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17
[0m23:35:46.139782 [info ] [Thread-1 (]: 7 of 51 PASS dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0 ... [[32mPASS[0m in 0.10s]
[0m23:35:46.147108 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad
[0m23:35:46.146301 [info ] [Thread-2 (]: 10 of 51 START test dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0  [RUN]
[0m23:35:46.149818 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.assert_total_amount_gte_fare, now test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17)
[0m23:35:46.148083 [debug] [Thread-1 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2
[0m23:35:46.149011 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.150505 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17
[0m23:35:46.154263 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388 (execute): 23:35:46.073715 => 23:35:46.153936
[0m23:35:46.162993 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388: ROLLBACK
[0m23:35:46.151143 [info ] [Thread-1 (]: 11 of 51 START test dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0  [RUN]
[0m23:35:46.164071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad, now test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2)
[0m23:35:46.166964 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2
[0m23:35:46.166169 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17"
[0m23:35:46.164762 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388: Close
[0m23:35:46.173973 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17 (compile): 23:35:46.156467 => 23:35:46.173646
[0m23:35:46.173103 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2"
[0m23:35:46.174492 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17
[0m23:35:46.167697 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.176482 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2 (compile): 23:35:46.168002 => 23:35:46.176148
[0m23:35:46.175434 [info ] [Thread-4 (]: 8 of 51 PASS dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1  [[32mPASS[0m in 0.13s]
[0m23:35:46.179027 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17"
[0m23:35:46.179489 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268"
[0m23:35:46.179909 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2
[0m23:35:46.180476 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388
[0m23:35:46.184855 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2"
[0m23:35:46.181526 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"

where not(total_amount > 0)


      
    ) dbt_internal_test
[0m23:35:46.181016 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17"
[0m23:35:46.186353 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17: BEGIN
[0m23:35:46.186863 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:46.185511 [debug] [Thread-4 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661
[0m23:35:46.187989 [info ] [Thread-4 (]: 12 of 51 START test dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0  [RUN]
[0m23:35:46.189187 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388, now test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661)
[0m23:35:46.190178 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2"
[0m23:35:46.191104 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661
[0m23:35:46.191978 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2: BEGIN
[0m23:35:46.200426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:46.199468 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661"
[0m23:35:46.192493 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.206308 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268 (execute): 23:35:46.116507 => 23:35:46.205952
[0m23:35:46.209611 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661 (compile): 23:35:46.192882 => 23:35:46.209264
[0m23:35:46.210064 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268: ROLLBACK
[0m23:35:46.210908 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661
[0m23:35:46.211319 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.211652 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.214063 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661"
[0m23:35:46.214405 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268: Close
[0m23:35:46.214799 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17"
[0m23:35:46.215211 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2"
[0m23:35:46.219897 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"

where not(avg_duration_mins > 0)


      
    ) dbt_internal_test
[0m23:35:46.218792 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661"
[0m23:35:46.220572 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661: BEGIN
[0m23:35:46.219321 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"

where not(trip_duration_mins > 0)


      
    ) dbt_internal_test
[0m23:35:46.216207 [info ] [Thread-3 (]: 9 of 51 PASS dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0 .. [[32mPASS[0m in 0.12s]
[0m23:35:46.222586 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268
[0m23:35:46.221143 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:46.221686 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.223170 [debug] [Thread-3 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c
[0m23:35:46.233152 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.235860 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17 (execute): 23:35:46.176885 => 23:35:46.235557
[0m23:35:46.233740 [info ] [Thread-3 (]: 13 of 51 START test dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1  [RUN]
[0m23:35:46.231223 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2 (execute): 23:35:46.181790 => 23:35:46.230892
[0m23:35:46.238787 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2: ROLLBACK
[0m23:35:46.238125 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268, now test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c)
[0m23:35:46.239465 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c
[0m23:35:46.237172 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17: ROLLBACK
[0m23:35:46.236679 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.246664 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661"
[0m23:35:46.245917 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2: Close
[0m23:35:46.251129 [info ] [Thread-1 (]: 11 of 51 PASS dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0  [[32mPASS[0m in 0.09s]
[0m23:35:46.252012 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2
[0m23:35:46.247546 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"

where not(avg_fare_per_trip > 0)


      
    ) dbt_internal_test
[0m23:35:46.248142 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17: Close
[0m23:35:46.252654 [debug] [Thread-1 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6
[0m23:35:46.257416 [info ] [Thread-2 (]: 10 of 51 PASS dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0  [[32mPASS[0m in 0.11s]
[0m23:35:46.254976 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c"
[0m23:35:46.258313 [info ] [Thread-1 (]: 14 of 51 START test dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0  [RUN]
[0m23:35:46.259138 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.261691 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17
[0m23:35:46.266692 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c (compile): 23:35:46.239776 => 23:35:46.266179
[0m23:35:46.267587 [debug] [Thread-2 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6
[0m23:35:46.264030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2, now test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6)
[0m23:35:46.265854 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661 (execute): 23:35:46.211949 => 23:35:46.265507
[0m23:35:46.272883 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661: ROLLBACK
[0m23:35:46.268408 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c
[0m23:35:46.269700 [info ] [Thread-2 (]: 15 of 51 START test dbt_utils_expression_is_true_daily_trip_summary_total_trips___0  [RUN]
[0m23:35:46.272001 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6
[0m23:35:46.278081 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17, now test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6)
[0m23:35:46.276826 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661: Close
[0m23:35:46.276382 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c"
[0m23:35:46.282547 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6"
[0m23:35:46.284938 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c"
[0m23:35:46.284119 [info ] [Thread-4 (]: 12 of 51 PASS dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0  [[32mPASS[0m in 0.10s]
[0m23:35:46.282966 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6
[0m23:35:46.285777 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6 (compile): 23:35:46.278485 => 23:35:46.285463
[0m23:35:46.286241 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c: BEGIN
[0m23:35:46.294039 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:46.292836 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6"
[0m23:35:46.293472 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6
[0m23:35:46.286816 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661
[0m23:35:46.299990 [debug] [Thread-4 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d
[0m23:35:46.299255 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6"
[0m23:35:46.302848 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6"
[0m23:35:46.300772 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6 (compile): 23:35:46.287173 => 23:35:46.300460
[0m23:35:46.301927 [info ] [Thread-4 (]: 16 of 51 START test dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23  [RUN]
[0m23:35:46.304036 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6
[0m23:35:46.303501 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6: BEGIN
[0m23:35:46.304844 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661, now test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d)
[0m23:35:46.307427 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6"
[0m23:35:46.307865 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.308245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:46.308674 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d
[0m23:35:46.309708 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6"
[0m23:35:46.311113 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c"
[0m23:35:46.321960 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"

where not(avg_tip_rate BETWEEN 0 AND 1)


      
    ) dbt_internal_test
[0m23:35:46.319681 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6: BEGIN
[0m23:35:46.319034 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d"
[0m23:35:46.323626 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d (compile): 23:35:46.311573 => 23:35:46.323297
[0m23:35:46.324856 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d
[0m23:35:46.324374 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.322661 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:46.325426 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.329053 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d"
[0m23:35:46.329625 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6"
[0m23:35:46.333863 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"

where not(total_revenue > 0)


      
    ) dbt_internal_test
[0m23:35:46.333134 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c (execute): 23:35:46.273701 => 23:35:46.332812
[0m23:35:46.334576 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c: ROLLBACK
[0m23:35:46.335927 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d"
[0m23:35:46.339602 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.340024 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c: Close
[0m23:35:46.340583 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d: BEGIN
[0m23:35:46.344729 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:46.343836 [info ] [Thread-3 (]: 13 of 51 PASS dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1  [[32mPASS[0m in 0.11s]
[0m23:35:46.346943 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c
[0m23:35:46.342698 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6 (execute): 23:35:46.295086 => 23:35:46.342328
[0m23:35:46.349605 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6: ROLLBACK
[0m23:35:46.348098 [debug] [Thread-3 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67
[0m23:35:46.351551 [info ] [Thread-3 (]: 17 of 51 START test dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0  [RUN]
[0m23:35:46.354569 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c, now test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67)
[0m23:35:46.353689 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6: Close
[0m23:35:46.357238 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67
[0m23:35:46.365309 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.366730 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6"
[0m23:35:46.372798 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"

where not(total_trips > 0)


      
    ) dbt_internal_test
[0m23:35:46.358462 [info ] [Thread-1 (]: 14 of 51 PASS dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0  [[32mPASS[0m in 0.09s]
[0m23:35:46.373913 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6
[0m23:35:46.367629 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.371917 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67"
[0m23:35:46.376109 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67 (compile): 23:35:46.359240 => 23:35:46.375795
[0m23:35:46.376667 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67
[0m23:35:46.375254 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d"
[0m23:35:46.374663 [debug] [Thread-1 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322
[0m23:35:46.380818 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67"
[0m23:35:46.384555 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67"
[0m23:35:46.385111 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67: BEGIN
[0m23:35:46.381476 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."hourly_demand_heatmap"

where not(pickup_hour BETWEEN 0 AND 23)


      
    ) dbt_internal_test
[0m23:35:46.383375 [info ] [Thread-1 (]: 18 of 51 START test dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100  [RUN]
[0m23:35:46.382725 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.385659 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:46.391911 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.391260 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6 (execute): 23:35:46.305189 => 23:35:46.390907
[0m23:35:46.387671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6, now test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322)
[0m23:35:46.397487 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d (execute): 23:35:46.325685 => 23:35:46.395884
[0m23:35:46.400786 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d: ROLLBACK
[0m23:35:46.398521 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6: ROLLBACK
[0m23:35:46.399114 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322
[0m23:35:46.407472 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6: Close
[0m23:35:46.412688 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322"
[0m23:35:46.415603 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322 (compile): 23:35:46.401313 => 23:35:46.415202
[0m23:35:46.413190 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d: Close
[0m23:35:46.414408 [info ] [Thread-2 (]: 15 of 51 PASS dbt_utils_expression_is_true_daily_trip_summary_total_trips___0 .. [[32mPASS[0m in 0.14s]
[0m23:35:46.418778 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6
[0m23:35:46.416898 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.421711 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67"
[0m23:35:46.422384 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."hourly_demand_heatmap"

where not(trip_count > 0)


      
    ) dbt_internal_test
[0m23:35:46.416243 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322
[0m23:35:46.418022 [info ] [Thread-4 (]: 16 of 51 PASS dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23  [[32mPASS[0m in 0.11s]
[0m23:35:46.420323 [debug] [Thread-2 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d
[0m23:35:46.427712 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322"
[0m23:35:46.431257 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322"
[0m23:35:46.431835 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322: BEGIN
[0m23:35:46.428545 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d
[0m23:35:46.432989 [debug] [Thread-4 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8
[0m23:35:46.430122 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.429407 [info ] [Thread-2 (]: 19 of 51 START test dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100  [RUN]
[0m23:35:46.437058 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6, now test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d)
[0m23:35:46.437733 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d
[0m23:35:46.436168 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67 (execute): 23:35:46.376988 => 23:35:46.435854
[0m23:35:46.432397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:46.433744 [info ] [Thread-4 (]: 20 of 51 START test not_null_cleaned_taxi_trips_dropoff_datetime ............... [RUN]
[0m23:35:46.444021 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67: ROLLBACK
[0m23:35:46.447575 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d, now test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8)
[0m23:35:46.446485 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d"
[0m23:35:46.449746 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d (compile): 23:35:46.438162 => 23:35:46.449408
[0m23:35:46.448878 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8
[0m23:35:46.450478 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d
[0m23:35:46.448408 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67: Close
[0m23:35:46.459161 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8"
[0m23:35:46.462381 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d"
[0m23:35:46.466158 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8 (compile): 23:35:46.450885 => 23:35:46.465832
[0m23:35:46.467949 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8
[0m23:35:46.466668 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.467395 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d"
[0m23:35:46.472886 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d: BEGIN
[0m23:35:46.471479 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8"
[0m23:35:46.472285 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322"
[0m23:35:46.463612 [info ] [Thread-3 (]: 17 of 51 PASS dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0  [[32mPASS[0m in 0.11s]
[0m23:35:46.473331 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:46.473983 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8"
[0m23:35:46.474362 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."payment_analysis"

where not(pct_of_total_trips BETWEEN 0 AND 100)


      
    ) dbt_internal_test
[0m23:35:46.474947 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67
[0m23:35:46.476732 [debug] [Thread-3 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9
[0m23:35:46.475549 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8: BEGIN
[0m23:35:46.479169 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:46.478205 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.482613 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322 (execute): 23:35:46.423883 => 23:35:46.482279
[0m23:35:46.483422 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322: ROLLBACK
[0m23:35:46.484321 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.478733 [info ] [Thread-3 (]: 21 of 51 START test not_null_cleaned_taxi_trips_fare_amount .................... [RUN]
[0m23:35:46.485013 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d"
[0m23:35:46.487756 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67, now test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9)
[0m23:35:46.490884 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."payment_analysis"

where not(tip_frequency_pct BETWEEN 0 AND 100)


      
    ) dbt_internal_test
[0m23:35:46.490197 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.492217 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8"
[0m23:35:46.492801 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dropoff_datetime
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where dropoff_datetime is null



      
    ) dbt_internal_test
[0m23:35:46.491684 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9
[0m23:35:46.489140 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322: Close
[0m23:35:46.501836 [info ] [Thread-1 (]: 18 of 51 PASS dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100  [[32mPASS[0m in 0.11s]
[0m23:35:46.502439 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.502833 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.500562 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9"
[0m23:35:46.503480 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322
[0m23:35:46.505095 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d (execute): 23:35:46.459719 => 23:35:46.504872
[0m23:35:46.506466 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8 (execute): 23:35:46.468294 => 23:35:46.506226
[0m23:35:46.509135 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8: ROLLBACK
[0m23:35:46.507617 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9 (compile): 23:35:46.493304 => 23:35:46.507423
[0m23:35:46.508373 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d: ROLLBACK
[0m23:35:46.507194 [debug] [Thread-1 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc
[0m23:35:46.509943 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9
[0m23:35:46.510277 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8: Close
[0m23:35:46.510790 [info ] [Thread-1 (]: 22 of 51 START test not_null_cleaned_taxi_trips_passenger_count ................ [RUN]
[0m23:35:46.515668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322, now test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc)
[0m23:35:46.513840 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9"
[0m23:35:46.511330 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d: Close
[0m23:35:46.516139 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc
[0m23:35:46.514898 [info ] [Thread-4 (]: 20 of 51 PASS not_null_cleaned_taxi_trips_dropoff_datetime ..................... [[32mPASS[0m in 0.07s]
[0m23:35:46.526216 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8
[0m23:35:46.530314 [debug] [Thread-4 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f
[0m23:35:46.525215 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9"
[0m23:35:46.518318 [info ] [Thread-2 (]: 19 of 51 PASS dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100  [[32mPASS[0m in 0.08s]
[0m23:35:46.533308 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d
[0m23:35:46.531163 [info ] [Thread-4 (]: 23 of 51 START test not_null_cleaned_taxi_trips_payment_type_label ............. [RUN]
[0m23:35:46.529724 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc"
[0m23:35:46.532356 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9: BEGIN
[0m23:35:46.535039 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8, now test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f)
[0m23:35:46.534018 [debug] [Thread-2 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f
[0m23:35:46.537577 [info ] [Thread-2 (]: 24 of 51 START test not_null_cleaned_taxi_trips_pickup_datetime ................ [RUN]
[0m23:35:46.536822 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f
[0m23:35:46.536327 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc (compile): 23:35:46.518708 => 23:35:46.536047
[0m23:35:46.535742 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:46.538822 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d, now test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f)
[0m23:35:46.545787 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f
[0m23:35:46.545018 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc
[0m23:35:46.558215 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f"
[0m23:35:46.559865 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f"
[0m23:35:46.562707 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc"
[0m23:35:46.563069 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.563991 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f (compile): 23:35:46.546131 => 23:35:46.563769
[0m23:35:46.564596 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f (compile): 23:35:46.539247 => 23:35:46.564234
[0m23:35:46.564945 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9"
[0m23:35:46.565390 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc"
[0m23:35:46.565804 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f
[0m23:35:46.566222 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f
[0m23:35:46.566644 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fare_amount
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where fare_amount is null



      
    ) dbt_internal_test
[0m23:35:46.567028 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc: BEGIN
[0m23:35:46.572076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:46.569249 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f"
[0m23:35:46.573088 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f"
[0m23:35:46.573604 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f: BEGIN
[0m23:35:46.571538 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f"
[0m23:35:46.575325 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f"
[0m23:35:46.575829 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f: BEGIN
[0m23:35:46.576259 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:46.574314 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:46.577886 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.583041 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9 (execute): 23:35:46.511556 => 23:35:46.581161
[0m23:35:46.583763 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9: ROLLBACK
[0m23:35:46.584418 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9: Close
[0m23:35:46.587832 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.588524 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc"
[0m23:35:46.589036 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select passenger_count
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where passenger_count is null



      
    ) dbt_internal_test
[0m23:35:46.597109 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.597733 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f"
[0m23:35:46.598371 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_datetime
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where pickup_datetime is null



      
    ) dbt_internal_test
[0m23:35:46.606527 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.602052 [info ] [Thread-3 (]: 21 of 51 PASS not_null_cleaned_taxi_trips_fare_amount .......................... [[32mPASS[0m in 0.12s]
[0m23:35:46.608489 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.613622 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9
[0m23:35:46.617352 [debug] [Thread-3 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2
[0m23:35:46.612551 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.616659 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f (execute): 23:35:46.567260 => 23:35:46.616282
[0m23:35:46.611893 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc (execute): 23:35:46.560555 => 23:35:46.611540
[0m23:35:46.622579 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f"
[0m23:35:46.626712 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type_label
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where payment_type_label is null



      
    ) dbt_internal_test
[0m23:35:46.623796 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc: ROLLBACK
[0m23:35:46.617924 [info ] [Thread-3 (]: 25 of 51 START test not_null_cleaned_taxi_trips_total_amount ................... [RUN]
[0m23:35:46.623136 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f: ROLLBACK
[0m23:35:46.632228 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc: Close
[0m23:35:46.628324 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9, now test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2)
[0m23:35:46.634066 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f: Close
[0m23:35:46.637192 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.636711 [info ] [Thread-1 (]: 22 of 51 PASS not_null_cleaned_taxi_trips_passenger_count ...................... [[32mPASS[0m in 0.12s]
[0m23:35:46.638939 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2
[0m23:35:46.642732 [info ] [Thread-2 (]: 24 of 51 PASS not_null_cleaned_taxi_trips_pickup_datetime ...................... [[32mPASS[0m in 0.10s]
[0m23:35:46.660151 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f
[0m23:35:46.651057 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc
[0m23:35:46.651933 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f (execute): 23:35:46.569549 => 23:35:46.648206
[0m23:35:46.664787 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f: ROLLBACK
[0m23:35:46.664170 [debug] [Thread-1 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493
[0m23:35:46.660916 [debug] [Thread-2 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e
[0m23:35:46.666792 [info ] [Thread-2 (]: 26 of 51 START test not_null_cleaned_taxi_trips_trip_distance_miles ............ [RUN]
[0m23:35:46.667814 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f, now test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e)
[0m23:35:46.665476 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f: Close
[0m23:35:46.663504 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2"
[0m23:35:46.665949 [info ] [Thread-1 (]: 27 of 51 START test not_null_cleaned_taxi_trips_trip_duration_mins ............. [RUN]
[0m23:35:46.668362 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e
[0m23:35:46.670397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc, now test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493)
[0m23:35:46.669450 [info ] [Thread-4 (]: 23 of 51 PASS not_null_cleaned_taxi_trips_payment_type_label ................... [[32mPASS[0m in 0.13s]
[0m23:35:46.675968 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e"
[0m23:35:46.676549 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2 (compile): 23:35:46.652661 => 23:35:46.676306
[0m23:35:46.676857 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493
[0m23:35:46.677410 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f
[0m23:35:46.677966 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e (compile): 23:35:46.670719 => 23:35:46.677762
[0m23:35:46.678278 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2
[0m23:35:46.682408 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493"
[0m23:35:46.682915 [debug] [Thread-4 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e
[0m23:35:46.683402 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e
[0m23:35:46.685740 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2"
[0m23:35:46.686367 [info ] [Thread-4 (]: 28 of 51 START test not_null_cleaned_taxi_trips_trip_id ........................ [RUN]
[0m23:35:46.688803 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e"
[0m23:35:46.689218 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493 (compile): 23:35:46.678530 => 23:35:46.689023
[0m23:35:46.689998 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f, now test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e)
[0m23:35:46.690396 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2"
[0m23:35:46.690940 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493
[0m23:35:46.691296 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e"
[0m23:35:46.691689 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e
[0m23:35:46.692153 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2: BEGIN
[0m23:35:46.695442 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493"
[0m23:35:46.695906 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e: BEGIN
[0m23:35:46.699801 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e"
[0m23:35:46.700213 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:46.700752 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:46.701249 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493"
[0m23:35:46.703080 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493: BEGIN
[0m23:35:46.701962 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e (compile): 23:35:46.696168 => 23:35:46.701673
[0m23:35:46.704537 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e
[0m23:35:46.703586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:46.709268 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e"
[0m23:35:46.710270 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e"
[0m23:35:46.711035 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e: BEGIN
[0m23:35:46.712025 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:46.714855 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.715780 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2"
[0m23:35:46.717731 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_amount
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where total_amount is null



      
    ) dbt_internal_test
[0m23:35:46.716229 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.718442 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e"
[0m23:35:46.719980 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_distance_miles
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where trip_distance_miles is null



      
    ) dbt_internal_test
[0m23:35:46.720927 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.721465 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493"
[0m23:35:46.721957 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_duration_mins
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where trip_duration_mins is null



      
    ) dbt_internal_test
[0m23:35:46.726574 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.727514 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.727976 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.729959 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e (execute): 23:35:46.686774 => 23:35:46.729653
[0m23:35:46.734695 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e: ROLLBACK
[0m23:35:46.735316 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.736221 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e"
[0m23:35:46.734087 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2 (execute): 23:35:46.683650 => 23:35:46.733758
[0m23:35:46.732166 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493 (execute): 23:35:46.692401 => 23:35:46.731867
[0m23:35:46.743721 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493: ROLLBACK
[0m23:35:46.742594 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e: Close
[0m23:35:46.743133 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2: ROLLBACK
[0m23:35:46.738200 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_id
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where trip_id is null



      
    ) dbt_internal_test
[0m23:35:46.750266 [info ] [Thread-2 (]: 26 of 51 PASS not_null_cleaned_taxi_trips_trip_distance_miles .................. [[32mPASS[0m in 0.08s]
[0m23:35:46.753597 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e
[0m23:35:46.750895 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493: Close
[0m23:35:46.755287 [info ] [Thread-1 (]: 27 of 51 PASS not_null_cleaned_taxi_trips_trip_duration_mins ................... [[32mPASS[0m in 0.09s]
[0m23:35:46.756041 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493
[0m23:35:46.754188 [debug] [Thread-2 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5
[0m23:35:46.751323 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2: Close
[0m23:35:46.758034 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.757095 [debug] [Thread-1 (]: Began running node test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795
[0m23:35:46.761880 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e (execute): 23:35:46.704850 => 23:35:46.761591
[0m23:35:46.758719 [info ] [Thread-2 (]: 29 of 51 START test not_null_cleaned_taxi_trips_vendor_id ...................... [RUN]
[0m23:35:46.766582 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e, now test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5)
[0m23:35:46.767089 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5
[0m23:35:46.759920 [info ] [Thread-3 (]: 25 of 51 PASS not_null_cleaned_taxi_trips_total_amount ......................... [[32mPASS[0m in 0.13s]
[0m23:35:46.774162 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2
[0m23:35:46.765667 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e: ROLLBACK
[0m23:35:46.762660 [info ] [Thread-1 (]: 30 of 51 START test not_null_daily_trip_summary_avg_duration_mins .............. [RUN]
[0m23:35:46.776479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493, now test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795)
[0m23:35:46.777020 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795
[0m23:35:46.775279 [debug] [Thread-3 (]: Began running node test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff
[0m23:35:46.783777 [info ] [Thread-3 (]: 31 of 51 START test not_null_daily_trip_summary_avg_fare_per_trip .............. [RUN]
[0m23:35:46.782665 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795"
[0m23:35:46.783148 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e: Close
[0m23:35:46.784789 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2, now test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff)
[0m23:35:46.787617 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff
[0m23:35:46.787093 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795 (compile): 23:35:46.777328 => 23:35:46.786782
[0m23:35:46.786273 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5"
[0m23:35:46.793851 [info ] [Thread-4 (]: 28 of 51 PASS not_null_cleaned_taxi_trips_trip_id .............................. [[32mPASS[0m in 0.10s]
[0m23:35:46.792840 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff"
[0m23:35:46.794616 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795
[0m23:35:46.795304 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e
[0m23:35:46.799978 [debug] [Thread-4 (]: Began running node test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f
[0m23:35:46.796333 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff (compile): 23:35:46.787895 => 23:35:46.796122
[0m23:35:46.799253 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795"
[0m23:35:46.795869 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5 (compile): 23:35:46.767432 => 23:35:46.795652
[0m23:35:46.802976 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5
[0m23:35:46.801436 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff
[0m23:35:46.802152 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795"
[0m23:35:46.800727 [info ] [Thread-4 (]: 32 of 51 START test not_null_daily_trip_summary_payment_type_label ............. [RUN]
[0m23:35:46.808505 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5"
[0m23:35:46.814293 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff"
[0m23:35:46.814747 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795: BEGIN
[0m23:35:46.815412 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e, now test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f)
[0m23:35:46.817578 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f
[0m23:35:46.816089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:46.817120 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5"
[0m23:35:46.816654 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff"
[0m23:35:46.825383 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff: BEGIN
[0m23:35:46.825865 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:46.823578 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f"
[0m23:35:46.826944 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f (compile): 23:35:46.817866 => 23:35:46.826622
[0m23:35:46.827491 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f
[0m23:35:46.824489 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5: BEGIN
[0m23:35:46.833775 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:46.836859 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f"
[0m23:35:46.841547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.843024 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795"
[0m23:35:46.842541 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f"
[0m23:35:46.844214 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_duration_mins
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where avg_duration_mins is null



      
    ) dbt_internal_test
[0m23:35:46.844860 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f: BEGIN
[0m23:35:46.845614 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:46.850503 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.851018 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.855995 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff"
[0m23:35:46.856618 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_fare_per_trip
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where avg_fare_per_trip is null



      
    ) dbt_internal_test
[0m23:35:46.853373 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795 (execute): 23:35:46.796534 => 23:35:46.852968
[0m23:35:46.857639 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.858093 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.858498 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.858900 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795: ROLLBACK
[0m23:35:46.859306 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f"
[0m23:35:46.859712 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5"
[0m23:35:46.861148 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff (execute): 23:35:46.808868 => 23:35:46.860929
[0m23:35:46.861677 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type_label
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where payment_type_label is null



      
    ) dbt_internal_test
[0m23:35:46.862054 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795: Close
[0m23:35:46.864031 [info ] [Thread-1 (]: 30 of 51 PASS not_null_daily_trip_summary_avg_duration_mins .................... [[32mPASS[0m in 0.09s]
[0m23:35:46.864779 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795
[0m23:35:46.862450 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where vendor_id is null



      
    ) dbt_internal_test
[0m23:35:46.862880 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff: ROLLBACK
[0m23:35:46.866234 [debug] [Thread-1 (]: Began running node test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793
[0m23:35:46.866652 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.867360 [info ] [Thread-1 (]: 33 of 51 START test not_null_daily_trip_summary_pickup_date .................... [RUN]
[0m23:35:46.869568 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f (execute): 23:35:46.827809 => 23:35:46.869304
[0m23:35:46.871524 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f: ROLLBACK
[0m23:35:46.870418 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff: Close
[0m23:35:46.871028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795, now test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793)
[0m23:35:46.869900 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:46.873369 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793
[0m23:35:46.875497 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5 (execute): 23:35:46.804907 => 23:35:46.875173
[0m23:35:46.881473 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5: ROLLBACK
[0m23:35:46.880889 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f: Close
[0m23:35:46.882737 [info ] [Thread-4 (]: 32 of 51 PASS not_null_daily_trip_summary_payment_type_label ................... [[32mPASS[0m in 0.07s]
[0m23:35:46.872798 [info ] [Thread-3 (]: 31 of 51 PASS not_null_daily_trip_summary_avg_fare_per_trip .................... [[32mPASS[0m in 0.09s]
[0m23:35:46.880426 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793"
[0m23:35:46.885511 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793 (compile): 23:35:46.875952 => 23:35:46.885196
[0m23:35:46.886444 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793
[0m23:35:46.883840 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f
[0m23:35:46.891370 [debug] [Thread-4 (]: Began running node test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d
[0m23:35:46.884652 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff
[0m23:35:46.885972 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5: Close
[0m23:35:46.893718 [warn ] [Thread-2 (]: 29 of 51 WARN 9103 not_null_cleaned_taxi_trips_vendor_id ....................... [[33mWARN 9103[0m in 0.13s]
[0m23:35:46.894464 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5
[0m23:35:46.890627 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793"
[0m23:35:46.891969 [info ] [Thread-4 (]: 34 of 51 START test not_null_daily_trip_summary_summary_id ..................... [RUN]
[0m23:35:46.892615 [debug] [Thread-3 (]: Began running node test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3
[0m23:35:46.895003 [debug] [Thread-2 (]: Began running node test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd
[0m23:35:46.896097 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f, now test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d)
[0m23:35:46.896641 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793"
[0m23:35:46.896984 [info ] [Thread-3 (]: 35 of 51 START test not_null_daily_trip_summary_total_revenue .................. [RUN]
[0m23:35:46.897572 [info ] [Thread-2 (]: 36 of 51 START test not_null_daily_trip_summary_total_trips .................... [RUN]
[0m23:35:46.899494 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff, now test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3)
[0m23:35:46.898575 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793: BEGIN
[0m23:35:46.901654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:46.898115 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d
[0m23:35:46.901119 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3
[0m23:35:46.900714 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5, now test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd)
[0m23:35:46.915681 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3"
[0m23:35:46.918307 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d"
[0m23:35:46.918873 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd
[0m23:35:46.919777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:46.920793 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d (compile): 23:35:46.902308 => 23:35:46.920475
[0m23:35:46.983200 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3 (compile): 23:35:46.908934 => 23:35:46.982707
[0m23:35:46.988151 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd"
[0m23:35:46.988700 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793"
[0m23:35:46.989154 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d
[0m23:35:46.989565 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3
[0m23:35:46.990117 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_date
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where pickup_date is null



      
    ) dbt_internal_test
[0m23:35:46.990774 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd (compile): 23:35:46.921051 => 23:35:46.990425
[0m23:35:46.994430 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d"
[0m23:35:46.997857 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3"
[0m23:35:46.998550 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd
[0m23:35:46.999725 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.002817 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd"
[0m23:35:47.003197 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d"
[0m23:35:47.003720 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3"
[0m23:35:47.008284 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3: BEGIN
[0m23:35:47.005597 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793 (execute): 23:35:46.886778 => 23:35:47.005224
[0m23:35:47.007685 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd"
[0m23:35:47.006879 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d: BEGIN
[0m23:35:47.008796 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:47.009266 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793: ROLLBACK
[0m23:35:47.009687 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd: BEGIN
[0m23:35:47.010080 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:47.010878 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:47.011549 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793: Close
[0m23:35:47.014730 [info ] [Thread-1 (]: 33 of 51 PASS not_null_daily_trip_summary_pickup_date .......................... [[32mPASS[0m in 0.14s]
[0m23:35:47.019786 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793
[0m23:35:47.021251 [debug] [Thread-1 (]: Began running node test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c
[0m23:35:47.026708 [info ] [Thread-1 (]: 37 of 51 START test not_null_daily_trip_summary_vendor_name .................... [RUN]
[0m23:35:47.028546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793, now test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c)
[0m23:35:47.029050 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.030677 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c
[0m23:35:47.032534 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.031467 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd"
[0m23:35:47.032061 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.041917 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3"
[0m23:35:47.042489 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_revenue
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where total_revenue is null



      
    ) dbt_internal_test
[0m23:35:47.041323 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_trips
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where total_trips is null



      
    ) dbt_internal_test
[0m23:35:47.040673 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c"
[0m23:35:47.038611 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d"
[0m23:35:47.043549 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_id
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where summary_id is null



      
    ) dbt_internal_test
[0m23:35:47.044445 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c (compile): 23:35:47.033126 => 23:35:47.044004
[0m23:35:47.046758 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c
[0m23:35:47.045690 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.046114 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.050100 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c"
[0m23:35:47.050588 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.052449 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3 (execute): 23:35:46.994846 => 23:35:47.052093
[0m23:35:47.054297 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd (execute): 23:35:47.000109 => 23:35:47.054072
[0m23:35:47.057662 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd: ROLLBACK
[0m23:35:47.056480 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c"
[0m23:35:47.057054 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3: ROLLBACK
[0m23:35:47.055933 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d (execute): 23:35:46.991226 => 23:35:47.055724
[0m23:35:47.058400 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd: Close
[0m23:35:47.058730 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c: BEGIN
[0m23:35:47.061811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:47.059206 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d: ROLLBACK
[0m23:35:47.062630 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3: Close
[0m23:35:47.061320 [info ] [Thread-2 (]: 36 of 51 PASS not_null_daily_trip_summary_total_trips .......................... [[32mPASS[0m in 0.16s]
[0m23:35:47.063901 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd
[0m23:35:47.066987 [debug] [Thread-2 (]: Began running node test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb
[0m23:35:47.064883 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d: Close
[0m23:35:47.065989 [info ] [Thread-3 (]: 35 of 51 PASS not_null_daily_trip_summary_total_revenue ........................ [[32mPASS[0m in 0.17s]
[0m23:35:47.072064 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3
[0m23:35:47.067838 [info ] [Thread-2 (]: 38 of 51 START test not_null_hourly_demand_heatmap_pickup_hour ................. [RUN]
[0m23:35:47.070320 [info ] [Thread-4 (]: 34 of 51 PASS not_null_daily_trip_summary_summary_id ........................... [[32mPASS[0m in 0.17s]
[0m23:35:47.073565 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.074154 [debug] [Thread-3 (]: Began running node test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2
[0m23:35:47.074885 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd, now test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb)
[0m23:35:47.075463 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d
[0m23:35:47.075845 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c"
[0m23:35:47.078128 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_name
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where vendor_name is null



      
    ) dbt_internal_test
[0m23:35:47.076957 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb
[0m23:35:47.077502 [debug] [Thread-4 (]: Began running node test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569
[0m23:35:47.076242 [info ] [Thread-3 (]: 39 of 51 START test not_null_hourly_demand_heatmap_trip_count .................. [RUN]
[0m23:35:47.085699 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.086486 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb"
[0m23:35:47.086857 [info ] [Thread-4 (]: 40 of 51 START test not_null_payment_analysis_payment_type_label ............... [RUN]
[0m23:35:47.087652 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3, now test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2)
[0m23:35:47.089275 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c (execute): 23:35:47.047156 => 23:35:47.089058
[0m23:35:47.090046 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d, now test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569)
[0m23:35:47.090621 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb (compile): 23:35:47.079473 => 23:35:47.090389
[0m23:35:47.090933 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2
[0m23:35:47.091301 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c: ROLLBACK
[0m23:35:47.099377 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2"
[0m23:35:47.101550 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2 (compile): 23:35:47.092407 => 23:35:47.101205
[0m23:35:47.100017 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c: Close
[0m23:35:47.092171 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb
[0m23:35:47.102169 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2
[0m23:35:47.091789 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569
[0m23:35:47.112760 [info ] [Thread-1 (]: 37 of 51 PASS not_null_daily_trip_summary_vendor_name .......................... [[32mPASS[0m in 0.08s]
[0m23:35:47.117071 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2"
[0m23:35:47.134910 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2"
[0m23:35:47.129545 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c
[0m23:35:47.132409 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569"
[0m23:35:47.118565 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb"
[0m23:35:47.139132 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb"
[0m23:35:47.139690 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb: BEGIN
[0m23:35:47.136014 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2: BEGIN
[0m23:35:47.142061 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:47.140180 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:47.137289 [debug] [Thread-1 (]: Began running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325
[0m23:35:47.143631 [info ] [Thread-1 (]: 41 of 51 START test source_not_null_bronze_raw_taxi_trips_batch_id ............. [RUN]
[0m23:35:47.141479 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569 (compile): 23:35:47.120694 => 23:35:47.141131
[0m23:35:47.146578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c, now test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325)
[0m23:35:47.152548 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325
[0m23:35:47.149090 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569
[0m23:35:47.172048 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325"
[0m23:35:47.177244 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325 (compile): 23:35:47.152891 => 23:35:47.176922
[0m23:35:47.177859 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325
[0m23:35:47.175853 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.175286 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569"
[0m23:35:47.176278 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.183412 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2"
[0m23:35:47.184009 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_count
from "nyc_taxi_dw"."public_gold"."hourly_demand_heatmap"
where trip_count is null



      
    ) dbt_internal_test
[0m23:35:47.181988 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325"
[0m23:35:47.188276 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325"
[0m23:35:47.189598 [debug] [Thread-1 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325: BEGIN
[0m23:35:47.182656 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb"
[0m23:35:47.191112 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_hour
from "nyc_taxi_dw"."public_gold"."hourly_demand_heatmap"
where pickup_hour is null



      
    ) dbt_internal_test
[0m23:35:47.185026 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569"
[0m23:35:47.191716 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.192322 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569: BEGIN
[0m23:35:47.198583 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:47.190183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:47.197380 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2 (execute): 23:35:47.113205 => 23:35:47.195196
[0m23:35:47.199571 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.200491 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2: ROLLBACK
[0m23:35:47.202995 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb (execute): 23:35:47.102685 => 23:35:47.202207
[0m23:35:47.204572 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb: ROLLBACK
[0m23:35:47.205001 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2: Close
[0m23:35:47.206237 [info ] [Thread-3 (]: 39 of 51 PASS not_null_hourly_demand_heatmap_trip_count ........................ [[32mPASS[0m in 0.12s]
[0m23:35:47.207360 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2
[0m23:35:47.208071 [debug] [Thread-3 (]: Began running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9
[0m23:35:47.208643 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb: Close
[0m23:35:47.209124 [info ] [Thread-3 (]: 42 of 51 START test source_not_null_bronze_raw_taxi_trips_ingested_at .......... [RUN]
[0m23:35:47.211540 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2, now test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9)
[0m23:35:47.210432 [info ] [Thread-2 (]: 38 of 51 PASS not_null_hourly_demand_heatmap_pickup_hour ....................... [[32mPASS[0m in 0.14s]
[0m23:35:47.212544 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9
[0m23:35:47.213284 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb
[0m23:35:47.225428 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.229906 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9"
[0m23:35:47.231191 [debug] [Thread-2 (]: Began running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae
[0m23:35:47.234065 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9 (compile): 23:35:47.216158 => 23:35:47.233755
[0m23:35:47.232545 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569"
[0m23:35:47.233375 [info ] [Thread-2 (]: 43 of 51 START test source_not_null_bronze_raw_taxi_trips_ingestion_id ......... [RUN]
[0m23:35:47.231982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.234784 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9
[0m23:35:47.235555 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type_label
from "nyc_taxi_dw"."public_gold"."payment_analysis"
where payment_type_label is null



      
    ) dbt_internal_test
[0m23:35:47.238429 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb, now test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae)
[0m23:35:47.239085 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325"
[0m23:35:47.244629 [debug] [Thread-1 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select batch_id
from "nyc_taxi_dw"."bronze"."raw_taxi_trips"
where batch_id is null



      
    ) dbt_internal_test
[0m23:35:47.241921 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9"
[0m23:35:47.244208 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae
[0m23:35:47.243807 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.245549 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9"
[0m23:35:47.251176 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae"
[0m23:35:47.253566 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569 (execute): 23:35:47.160680 => 23:35:47.253292
[0m23:35:47.253924 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.254350 [debug] [Thread-3 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9: BEGIN
[0m23:35:47.254972 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae (compile): 23:35:47.245985 => 23:35:47.254758
[0m23:35:47.255301 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569: ROLLBACK
[0m23:35:47.256650 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325 (execute): 23:35:47.178171 => 23:35:47.256437
[0m23:35:47.257041 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:47.257452 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae
[0m23:35:47.257993 [debug] [Thread-1 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325: ROLLBACK
[0m23:35:47.258324 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569: Close
[0m23:35:47.263622 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae"
[0m23:35:47.266190 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae"
[0m23:35:47.266794 [debug] [Thread-1 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325: Close
[0m23:35:47.265037 [info ] [Thread-4 (]: 40 of 51 PASS not_null_payment_analysis_payment_type_label ..................... [[32mPASS[0m in 0.18s]
[0m23:35:47.269922 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569
[0m23:35:47.267382 [debug] [Thread-2 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae: BEGIN
[0m23:35:47.271319 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:47.270745 [debug] [Thread-4 (]: Began running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505
[0m23:35:47.268847 [info ] [Thread-1 (]: 41 of 51 PASS source_not_null_bronze_raw_taxi_trips_batch_id ................... [[32mPASS[0m in 0.12s]
[0m23:35:47.273169 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325
[0m23:35:47.272236 [info ] [Thread-4 (]: 44 of 51 START test source_not_null_bronze_raw_taxi_trips_total_amount ......... [RUN]
[0m23:35:47.274742 [debug] [Thread-1 (]: Began running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6
[0m23:35:47.277495 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569, now test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505)
[0m23:35:47.278942 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.281260 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9"
[0m23:35:47.278273 [info ] [Thread-1 (]: 45 of 51 START test source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime  [RUN]
[0m23:35:47.279503 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505
[0m23:35:47.283228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325, now test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6)
[0m23:35:47.281853 [debug] [Thread-3 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingested_at
from "nyc_taxi_dw"."bronze"."raw_taxi_trips"
where ingested_at is null



      
    ) dbt_internal_test
[0m23:35:47.290644 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505"
[0m23:35:47.292367 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505 (compile): 23:35:47.283639 => 23:35:47.292031
[0m23:35:47.292887 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505
[0m23:35:47.291512 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6
[0m23:35:47.291060 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.295401 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505"
[0m23:35:47.295827 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.299813 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6"
[0m23:35:47.300258 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae"
[0m23:35:47.302005 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9 (execute): 23:35:47.239409 => 23:35:47.301782
[0m23:35:47.302564 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505"
[0m23:35:47.303049 [debug] [Thread-2 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingestion_id
from "nyc_taxi_dw"."bronze"."raw_taxi_trips"
where ingestion_id is null



      
    ) dbt_internal_test
[0m23:35:47.303509 [debug] [Thread-3 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9: ROLLBACK
[0m23:35:47.303882 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6 (compile): 23:35:47.296031 => 23:35:47.303695
[0m23:35:47.304992 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6
[0m23:35:47.304252 [debug] [Thread-4 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505: BEGIN
[0m23:35:47.307797 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6"
[0m23:35:47.308256 [debug] [Thread-3 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9: Close
[0m23:35:47.308595 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:47.308923 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.309553 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6"
[0m23:35:47.315885 [debug] [Thread-1 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6: BEGIN
[0m23:35:47.316527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:47.313378 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae (execute): 23:35:47.258767 => 23:35:47.312981
[0m23:35:47.314887 [info ] [Thread-3 (]: 42 of 51 PASS source_not_null_bronze_raw_taxi_trips_ingested_at ................ [[32mPASS[0m in 0.10s]
[0m23:35:47.318065 [debug] [Thread-2 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae: ROLLBACK
[0m23:35:47.319309 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9
[0m23:35:47.322121 [debug] [Thread-3 (]: Began running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a
[0m23:35:47.324472 [debug] [Thread-2 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae: Close
[0m23:35:47.323984 [info ] [Thread-3 (]: 46 of 51 START test source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime . [RUN]
[0m23:35:47.328317 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9, now test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a)
[0m23:35:47.331333 [info ] [Thread-2 (]: 43 of 51 PASS source_not_null_bronze_raw_taxi_trips_ingestion_id ............... [[32mPASS[0m in 0.09s]
[0m23:35:47.333860 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a
[0m23:35:47.335705 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae
[0m23:35:47.336541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.347318 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6"
[0m23:35:47.345806 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a"
[0m23:35:47.346663 [debug] [Thread-2 (]: Began running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935
[0m23:35:47.337980 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.350209 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505"
[0m23:35:47.349040 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a (compile): 23:35:47.338281 => 23:35:47.348743
[0m23:35:47.348042 [debug] [Thread-1 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tpep_dropoff_datetime
from "nyc_taxi_dw"."bronze"."raw_taxi_trips"
where tpep_dropoff_datetime is null



      
    ) dbt_internal_test
[0m23:35:47.349654 [info ] [Thread-2 (]: 47 of 51 START test source_not_null_bronze_raw_taxi_trips_vendor_id ............ [RUN]
[0m23:35:47.352807 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae, now test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935)
[0m23:35:47.351157 [debug] [Thread-4 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_amount
from "nyc_taxi_dw"."bronze"."raw_taxi_trips"
where total_amount is null



      
    ) dbt_internal_test
[0m23:35:47.351777 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a
[0m23:35:47.354590 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935
[0m23:35:47.360905 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a"
[0m23:35:47.362027 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.361587 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.369040 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a"
[0m23:35:47.373808 [debug] [Thread-3 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a: BEGIN
[0m23:35:47.374349 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:47.373236 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6 (execute): 23:35:47.305356 => 23:35:47.372913
[0m23:35:47.369477 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935"
[0m23:35:47.371618 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505 (execute): 23:35:47.293190 => 23:35:47.371312
[0m23:35:47.377182 [debug] [Thread-4 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505: ROLLBACK
[0m23:35:47.376588 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935 (compile): 23:35:47.362398 => 23:35:47.376270
[0m23:35:47.375285 [debug] [Thread-1 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6: ROLLBACK
[0m23:35:47.377875 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935
[0m23:35:47.379404 [debug] [Thread-4 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505: Close
[0m23:35:47.379891 [debug] [Thread-1 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6: Close
[0m23:35:47.384843 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935"
[0m23:35:47.386049 [info ] [Thread-4 (]: 44 of 51 PASS source_not_null_bronze_raw_taxi_trips_total_amount ............... [[32mPASS[0m in 0.11s]
[0m23:35:47.389014 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505
[0m23:35:47.390471 [debug] [Thread-4 (]: Began running node test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b
[0m23:35:47.391020 [info ] [Thread-4 (]: 48 of 51 START test source_unique_bronze_raw_taxi_trips_ingestion_id ........... [RUN]
[0m23:35:47.387083 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.389728 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935"
[0m23:35:47.388083 [info ] [Thread-1 (]: 45 of 51 PASS source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime ...... [[32mPASS[0m in 0.11s]
[0m23:35:47.394790 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6
[0m23:35:47.395442 [debug] [Thread-1 (]: Began running node test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986
[0m23:35:47.393901 [debug] [Thread-2 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935: BEGIN
[0m23:35:47.392042 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505, now test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b)
[0m23:35:47.397745 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b
[0m23:35:47.397037 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:47.392966 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a"
[0m23:35:47.396039 [info ] [Thread-1 (]: 49 of 51 START test unique_cleaned_taxi_trips_trip_id .......................... [RUN]
[0m23:35:47.405653 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b"
[0m23:35:47.408559 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b (compile): 23:35:47.398166 => 23:35:47.408206
[0m23:35:47.409232 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b
[0m23:35:47.406451 [debug] [Thread-3 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tpep_pickup_datetime
from "nyc_taxi_dw"."bronze"."raw_taxi_trips"
where tpep_pickup_datetime is null



      
    ) dbt_internal_test
[0m23:35:47.407607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6, now test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986)
[0m23:35:47.413290 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b"
[0m23:35:47.413994 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986
[0m23:35:47.415314 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b"
[0m23:35:47.421455 [debug] [Thread-4 (]: On test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b: BEGIN
[0m23:35:47.422042 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:47.424574 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.423690 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986"
[0m23:35:47.422597 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.431579 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935"
[0m23:35:47.428226 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a (execute): 23:35:47.355138 => 23:35:47.427895
[0m23:35:47.434773 [debug] [Thread-3 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a: ROLLBACK
[0m23:35:47.434132 [debug] [Thread-2 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from "nyc_taxi_dw"."bronze"."raw_taxi_trips"
where vendor_id is null



      
    ) dbt_internal_test
[0m23:35:47.430839 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986 (compile): 23:35:47.415744 => 23:35:47.430058
[0m23:35:47.435891 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986
[0m23:35:47.442047 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.445750 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935 (execute): 23:35:47.380204 => 23:35:47.445396
[0m23:35:47.443588 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986"
[0m23:35:47.442683 [debug] [Thread-3 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a: Close
[0m23:35:47.448808 [info ] [Thread-3 (]: 46 of 51 PASS source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime ....... [[32mPASS[0m in 0.12s]
[0m23:35:47.449692 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a
[0m23:35:47.446825 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.452175 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b"
[0m23:35:47.453041 [debug] [Thread-4 (]: On test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ingestion_id as unique_field,
    count(*) as n_records

from "nyc_taxi_dw"."bronze"."raw_taxi_trips"
where ingestion_id is not null
group by ingestion_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:47.450598 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986"
[0m23:35:47.453875 [debug] [Thread-1 (]: On test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986: BEGIN
[0m23:35:47.454470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:47.447441 [debug] [Thread-2 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935: ROLLBACK
[0m23:35:47.451630 [debug] [Thread-3 (]: Began running node test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc
[0m23:35:47.455940 [debug] [Thread-2 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935: Close
[0m23:35:47.455436 [info ] [Thread-3 (]: 50 of 51 START test unique_daily_trip_summary_summary_id ....................... [RUN]
[0m23:35:47.459987 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a, now test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc)
[0m23:35:47.457297 [warn ] [Thread-2 (]: 47 of 51 WARN 10000 source_not_null_bronze_raw_taxi_trips_vendor_id ............ [[33mWARN 10000[0m in 0.10s]
[0m23:35:47.461696 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc
[0m23:35:47.463559 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935
[0m23:35:47.472028 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc"
[0m23:35:47.472456 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.473150 [debug] [Thread-2 (]: Began running node test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b
[0m23:35:47.473487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.475125 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b (execute): 23:35:47.409618 => 23:35:47.474905
[0m23:35:47.475696 [info ] [Thread-2 (]: 51 of 51 START test unique_payment_analysis_payment_type_label ................. [RUN]
[0m23:35:47.476302 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc (compile): 23:35:47.463954 => 23:35:47.476008
[0m23:35:47.476732 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986"
[0m23:35:47.477119 [debug] [Thread-4 (]: On test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b: ROLLBACK
[0m23:35:47.477776 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935, now test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b)
[0m23:35:47.478190 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc
[0m23:35:47.478647 [debug] [Thread-1 (]: On test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:47.479182 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b
[0m23:35:47.479525 [debug] [Thread-4 (]: On test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b: Close
[0m23:35:47.484529 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc"
[0m23:35:47.493583 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b"
[0m23:35:47.495236 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b (compile): 23:35:47.486007 => 23:35:47.494931
[0m23:35:47.495942 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc"
[0m23:35:47.494134 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.496856 [info ] [Thread-4 (]: 48 of 51 PASS source_unique_bronze_raw_taxi_trips_ingestion_id ................. [[32mPASS[0m in 0.11s]
[0m23:35:47.497459 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b
[0m23:35:47.497859 [debug] [Thread-3 (]: On test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc: BEGIN
[0m23:35:47.499325 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986 (execute): 23:35:47.436312 => 23:35:47.499112
[0m23:35:47.508558 [debug] [Thread-1 (]: On test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986: ROLLBACK
[0m23:35:47.499905 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b
[0m23:35:47.507463 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b"
[0m23:35:47.507964 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:47.509639 [debug] [Thread-1 (]: On test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986: Close
[0m23:35:47.512245 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b"
[0m23:35:47.513582 [debug] [Thread-2 (]: On test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b: BEGIN
[0m23:35:47.514358 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:47.511302 [info ] [Thread-1 (]: 49 of 51 PASS unique_cleaned_taxi_trips_trip_id ................................ [[32mPASS[0m in 0.10s]
[0m23:35:47.515436 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986
[0m23:35:47.518998 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.519757 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc"
[0m23:35:47.520259 [debug] [Thread-3 (]: On test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_id as unique_field,
    count(*) as n_records

from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where summary_id is not null
group by summary_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:47.525776 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.528368 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc (execute): 23:35:47.479754 => 23:35:47.528031
[0m23:35:47.528801 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.529984 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b"
[0m23:35:47.529386 [debug] [Thread-3 (]: On test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc: ROLLBACK
[0m23:35:47.530661 [debug] [Thread-2 (]: On test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_type_label as unique_field,
    count(*) as n_records

from "nyc_taxi_dw"."public_gold"."payment_analysis"
where payment_type_label is not null
group by payment_type_label
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:47.531425 [debug] [Thread-3 (]: On test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc: Close
[0m23:35:47.535534 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:35:47.533808 [info ] [Thread-3 (]: 50 of 51 PASS unique_daily_trip_summary_summary_id ............................. [[32mPASS[0m in 0.07s]
[0m23:35:47.538864 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc
[0m23:35:47.538024 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b (execute): 23:35:47.500138 => 23:35:47.537713
[0m23:35:47.539582 [debug] [Thread-2 (]: On test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b: ROLLBACK
[0m23:35:47.540168 [debug] [Thread-2 (]: On test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b: Close
[0m23:35:47.542246 [info ] [Thread-2 (]: 51 of 51 PASS unique_payment_analysis_payment_type_label ....................... [[32mPASS[0m in 0.06s]
[0m23:35:47.543639 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b
[0m23:35:47.546371 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:47.546739 [debug] [MainThread]: On master: BEGIN
[0m23:35:47.547042 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:35:47.552675 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:35:47.553246 [debug] [MainThread]: On master: COMMIT
[0m23:35:47.553769 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:47.554188 [debug] [MainThread]: On master: COMMIT
[0m23:35:47.554613 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:35:47.554916 [debug] [MainThread]: On master: Close
[0m23:35:47.555718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:47.556119 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b' was properly closed.
[0m23:35:47.556487 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986' was properly closed.
[0m23:35:47.556825 [debug] [MainThread]: Connection 'test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b' was properly closed.
[0m23:35:47.557156 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc' was properly closed.
[0m23:35:47.557587 [info ] [MainThread]: 
[0m23:35:47.557936 [info ] [MainThread]: Finished running 51 tests in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m23:35:47.565004 [debug] [MainThread]: Command end result
[0m23:35:47.584113 [info ] [MainThread]: 
[0m23:35:47.584780 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m23:35:47.585266 [info ] [MainThread]: 
[0m23:35:47.585762 [warn ] [MainThread]: [33mWarning in test not_null_cleaned_taxi_trips_vendor_id (models/silver/schema.yml)[0m
[0m23:35:47.586202 [warn ] [MainThread]: Got 9103 results, configured to warn if != 0
[0m23:35:47.586627 [info ] [MainThread]: 
[0m23:35:47.587053 [info ] [MainThread]:   compiled Code at target/compiled/nyc_taxi/models/silver/schema.yml/not_null_cleaned_taxi_trips_vendor_id.sql
[0m23:35:47.587487 [info ] [MainThread]: 
[0m23:35:47.587926 [warn ] [MainThread]: [33mWarning in test source_not_null_bronze_raw_taxi_trips_vendor_id (models/bronze/sources.yml)[0m
[0m23:35:47.588319 [warn ] [MainThread]: Got 10000 results, configured to warn if != 0
[0m23:35:47.588741 [info ] [MainThread]: 
[0m23:35:47.589126 [info ] [MainThread]:   compiled Code at target/compiled/nyc_taxi/models/bronze/sources.yml/source_not_null_bronze_raw_taxi_trips_vendor_id.sql
[0m23:35:47.589867 [info ] [MainThread]: 
[0m23:35:47.590397 [info ] [MainThread]: Done. PASS=49 WARN=2 ERROR=0 SKIP=0 TOTAL=51
[0m23:35:47.591561 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.2923498, "process_user_time": 3.834653, "process_kernel_time": 0.239542, "process_mem_max_rss": "111244", "process_in_blocks": "2536", "process_out_blocks": "4040"}
[0m23:35:47.592123 [debug] [MainThread]: Command `dbt test` succeeded at 23:35:47.591966 after 2.29 seconds
[0m23:35:47.592608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72652c263af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726528c4a170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726528c4b0d0>]}
[0m23:35:47.593165 [debug] [MainThread]: Flushing usage events
[0m23:43:31.815960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71073010fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107308e2230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71072e40a830>]}


============================== 23:43:31.831160 | 79a94b24-0eb4-4a13-9c4c-e556fdbd1e25 ==============================
[0m23:43:31.831160 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:43:31.832491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt --select silver', 'send_anonymous_usage_stats': 'True'}
[0m23:43:32.092990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79a94b24-0eb4-4a13-9c4c-e556fdbd1e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7107308e2230>]}
[0m23:43:32.182975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79a94b24-0eb4-4a13-9c4c-e556fdbd1e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71072c8f9ed0>]}
[0m23:43:32.184247 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m23:43:32.201760 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:43:32.274790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:43:32.275245 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:43:32.276213 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_taxi.bronze
[0m23:43:32.282224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79a94b24-0eb4-4a13-9c4c-e556fdbd1e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71072c5d0dc0>]}
[0m23:43:32.311728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79a94b24-0eb4-4a13-9c4c-e556fdbd1e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71072c794e20>]}
[0m23:43:32.312265 [info ] [MainThread]: Found 4 models, 51 tests, 1 source, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m23:43:32.312792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79a94b24-0eb4-4a13-9c4c-e556fdbd1e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71072c7950f0>]}
[0m23:43:32.315117 [info ] [MainThread]: 
[0m23:43:32.316319 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:43:32.317809 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw'
[0m23:43:32.337741 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw"
[0m23:43:32.338225 [debug] [ThreadPool]: On list_nyc_taxi_dw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:43:32.338726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:32.356665 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:43:32.357978 [debug] [ThreadPool]: On list_nyc_taxi_dw: Close
[0m23:43:32.359418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw, now create_nyc_taxi_dw_public_silver)
[0m23:43:32.360303 [debug] [ThreadPool]: Creating schema "database: "nyc_taxi_dw"
schema: "public_silver"
"
[0m23:43:32.365809 [debug] [ThreadPool]: Using postgres connection "create_nyc_taxi_dw_public_silver"
[0m23:43:32.366139 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_silver: BEGIN
[0m23:43:32.366442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:43:32.371077 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:43:32.371420 [debug] [ThreadPool]: Using postgres connection "create_nyc_taxi_dw_public_silver"
[0m23:43:32.371723 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "create_nyc_taxi_dw_public_silver"} */
create schema if not exists "public_silver"
[0m23:43:32.389274 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:43:32.391443 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_silver: COMMIT
[0m23:43:32.391837 [debug] [ThreadPool]: Using postgres connection "create_nyc_taxi_dw_public_silver"
[0m23:43:32.392149 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_silver: COMMIT
[0m23:43:32.394081 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:43:32.394430 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_silver: Close
[0m23:43:32.397484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nyc_taxi_dw_public_silver, now list_nyc_taxi_dw_public_silver)
[0m23:43:32.404828 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:43:32.405551 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw_public_gold'
[0m23:43:32.405834 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: BEGIN
[0m23:43:32.407924 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:43:32.408268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:43:32.408626 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: BEGIN
[0m23:43:32.409141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:32.415948 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:43:32.416249 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:43:32.416623 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:43:32.417018 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:43:32.417398 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_gold"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m23:43:32.417977 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_silver"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m23:43:32.439376 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:43:32.441366 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: ROLLBACK
[0m23:43:32.441918 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:43:32.443433 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: ROLLBACK
[0m23:43:32.443804 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: Close
[0m23:43:32.445611 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: Close
[0m23:43:32.454541 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:32.454948 [debug] [MainThread]: On master: BEGIN
[0m23:43:32.455305 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:43:32.464774 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:32.465217 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:32.465810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:43:32.477588 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:43:32.479710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79a94b24-0eb4-4a13-9c4c-e556fdbd1e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71072c794f70>]}
[0m23:43:32.480391 [debug] [MainThread]: On master: ROLLBACK
[0m23:43:32.480988 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:32.481508 [debug] [MainThread]: On master: BEGIN
[0m23:43:32.482208 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:32.482692 [debug] [MainThread]: On master: COMMIT
[0m23:43:32.483109 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:32.483528 [debug] [MainThread]: On master: COMMIT
[0m23:43:32.484095 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:43:32.484620 [debug] [MainThread]: On master: Close
[0m23:43:32.487240 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:43:32.487777 [info ] [MainThread]: 
[0m23:43:32.498987 [debug] [Thread-1 (]: Began running node model.nyc_taxi.cleaned_taxi_trips
[0m23:43:32.499747 [info ] [Thread-1 (]: 1 of 1 START sql table model public_silver.cleaned_taxi_trips .................. [RUN]
[0m23:43:32.500854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw_public_silver, now model.nyc_taxi.cleaned_taxi_trips)
[0m23:43:32.501423 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi.cleaned_taxi_trips
[0m23:43:32.574679 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi.cleaned_taxi_trips"
[0m23:43:32.575402 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.cleaned_taxi_trips (compile): 23:43:32.501801 => 23:43:32.575141
[0m23:43:32.575799 [debug] [Thread-1 (]: Began executing node model.nyc_taxi.cleaned_taxi_trips
[0m23:43:32.610581 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi.cleaned_taxi_trips"
[0m23:43:32.611206 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:43:32.611611 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: BEGIN
[0m23:43:32.611961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:32.618586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:32.619257 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:43:32.621187 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

  
    

  create  table "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips__dbt_tmp"
  
  
    as
  
  (
    

/*
  Silver Layer: cleaned_taxi_trips
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Transforms raw bronze strings into typed, cleaned, validated records.
  Business rules applied:
    - Cast all numeric strings to NUMERIC/INTEGER
    - Parse datetimes from ISO strings
    - Derive trip duration, speed, per-mile cost
    - Map payment_type codes to labels
    - Filter obvious bad records (negative fares, zero distance, etc.)
    - Deduplicate on business key
*/

WITH source AS (

    SELECT *
    FROM "nyc_taxi_dw"."bronze"."raw_taxi_trips"

),

cast_and_clean AS (

    SELECT
        ingestion_id,
        batch_id,
        ingested_at,

        -- Vendor (safe cast: only cast if looks like a small integer)
        CASE WHEN TRIM(COALESCE(vendor_id, '')) ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(vendor_id)::NUMERIC::INTEGER END            AS vendor_id,

        -- Timestamps
        tpep_pickup_datetime::TIMESTAMP                            AS pickup_datetime,
        tpep_dropoff_datetime::TIMESTAMP                           AS dropoff_datetime,

        -- Passengers & distance
        CASE WHEN TRIM(COALESCE(passenger_count, '')) ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(passenger_count)::NUMERIC::INTEGER END      AS passenger_count,
        CASE WHEN TRIM(COALESCE(trip_distance, '')) ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(trip_distance)::NUMERIC(10,2) END           AS trip_distance_miles,

        -- Location IDs
        CASE WHEN TRIM(COALESCE(pu_location_id, '')) ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(pu_location_id)::NUMERIC::INTEGER END       AS pickup_location_id,
        CASE WHEN TRIM(COALESCE(do_location_id, '')) ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(do_location_id)::NUMERIC::INTEGER END       AS dropoff_location_id,

        -- Rate & flags
        CASE WHEN TRIM(COALESCE(rate_code_id, '')) ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(rate_code_id)::NUMERIC::INTEGER END         AS rate_code_id,
        TRIM(store_and_fwd_flag)                                   AS store_and_fwd_flag,

        -- Payment
        CASE WHEN TRIM(COALESCE(payment_type, '')) ~ '^[0-9]+(\.0+)?$'
             THEN TRIM(payment_type)::NUMERIC::INTEGER END         AS payment_type_code,
        CASE TRIM(payment_type)
            WHEN '1' THEN 'Credit Card'
            WHEN '2' THEN 'Cash'
            WHEN '3' THEN 'No Charge'
            WHEN '4' THEN 'Dispute'
            WHEN '5' THEN 'Unknown'
            WHEN '6' THEN 'Voided Trip'
            ELSE          'Other'
        END                                                        AS payment_type_label,

        -- Fare components (safe cast: NULL if not a valid decimal)
        CASE WHEN fare_amount ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(fare_amount)::NUMERIC(10,2) END             AS fare_amount,
        CASE WHEN extra ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(extra)::NUMERIC(10,2) END                   AS extra,
        CASE WHEN mta_tax ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(mta_tax)::NUMERIC(10,2) END                 AS mta_tax,
        CASE WHEN tip_amount ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(tip_amount)::NUMERIC(10,2) END              AS tip_amount,
        CASE WHEN tolls_amount ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(tolls_amount)::NUMERIC(10,2) END            AS tolls_amount,
        CASE WHEN improvement_surcharge ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(improvement_surcharge)::NUMERIC(10,2) END   AS improvement_surcharge,
        CASE WHEN congestion_surcharge ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(congestion_surcharge)::NUMERIC(10,2) END    AS congestion_surcharge,
        CASE WHEN airport_fee ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(airport_fee)::NUMERIC(10,2) END             AS airport_fee,
        CASE WHEN total_amount ~ '^-?[0-9]+(\.?[0-9]+)?$'
             THEN TRIM(total_amount)::NUMERIC(10,2) END            AS total_amount

    FROM source
    WHERE tpep_pickup_datetime IS NOT NULL
      AND tpep_dropoff_datetime IS NOT NULL
      AND total_amount IS NOT NULL

),

enrich AS (

    SELECT
        *,
        -- Derived metrics
        EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) / 60.0
                                                                    AS trip_duration_mins,
        CASE
            WHEN trip_distance_miles > 0
             AND EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) > 0
            THEN trip_distance_miles
                 / (EXTRACT(EPOCH FROM (dropoff_datetime - pickup_datetime)) / 3600.0)
            ELSE NULL
        END                                                         AS avg_speed_mph,
        CASE
            WHEN trip_distance_miles > 0
            THEN total_amount / trip_distance_miles
            ELSE NULL
        END                                                         AS cost_per_mile,
        CASE
            WHEN total_amount > 0
            THEN tip_amount / total_amount
            ELSE 0
        END                                                         AS tip_percentage,

        -- Date parts for partitioning / BI
        DATE(pickup_datetime)                                       AS pickup_date,
        EXTRACT(HOUR FROM pickup_datetime)::BIGINT                 AS pickup_hour,
        TO_CHAR(pickup_datetime, 'Day')                            AS pickup_day_of_week,
        EXTRACT(MONTH FROM pickup_datetime)::BIGINT                AS pickup_month,
        EXTRACT(YEAR FROM pickup_datetime)::BIGINT                 AS pickup_year

    FROM cast_and_clean

),

deduplicated AS (

    SELECT *,
        ROW_NUMBER() OVER (
            PARTITION BY pickup_datetime, dropoff_datetime, vendor_id, total_amount
            ORDER BY ingestion_id DESC
        ) AS rn
    FROM enrich

),

validated AS (

    SELECT *
    FROM deduplicated
    WHERE rn = 1
      -- Business rule filters
      AND total_amount  > 0
      AND fare_amount   >= 0
      AND trip_distance_miles >= 0
      AND passenger_count BETWEEN 0 AND 20
      AND trip_duration_mins BETWEEN 1 AND 360  -- 1 min to 6 hrs
      AND pickup_datetime < dropoff_datetime

)

SELECT
    -- Surrogate key
    md5(cast(coalesce(cast(pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(total_amount as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                                           AS trip_id,

    ingestion_id,
    batch_id,
    ingested_at,
    vendor_id,
    pickup_datetime,
    dropoff_datetime,
    pickup_date,
    pickup_hour,
    pickup_day_of_week,
    pickup_month,
    pickup_year,
    passenger_count,
    trip_distance_miles,
    pickup_location_id,
    dropoff_location_id,
    rate_code_id,
    store_and_fwd_flag,
    payment_type_code,
    payment_type_label,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    congestion_surcharge,
    airport_fee,
    total_amount,
    trip_duration_mins,
    avg_speed_mph,
    cost_per_mile,
    tip_percentage

FROM validated
  );
  
[0m23:43:32.907071 [debug] [Thread-1 (]: SQL status: SELECT 9103 in 0.0 seconds
[0m23:43:32.913415 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:43:32.913840 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */
alter table "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips__dbt_tmp" rename to "cleaned_taxi_trips"
[0m23:43:32.914518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:32.931184 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:43:32.931736 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

    create  index if not exists
  "fd1962e5f0f842c4b11c0f769da53241"
  on "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips" using btree
  (pickup_datetime);
  
[0m23:43:32.940826 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:43:32.942499 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:43:32.942885 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

    create  index if not exists
  "97c3dc6966574d0d4e8887fdf3d8ab11"
  on "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips" using btree
  (vendor_id);
  
[0m23:43:32.947740 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:43:32.949363 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:43:32.949741 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

    create  index if not exists
  "1e9ef4fcacab13e49b674dc9ca489573"
  on "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips" using btree
  (payment_type_code);
  
[0m23:43:32.956591 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:43:32.958626 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:43:32.959012 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */

        ANALYZE "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
      
[0m23:43:33.059919 [debug] [Thread-1 (]: SQL status: ANALYZE in 0.0 seconds
[0m23:43:33.073380 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: COMMIT
[0m23:43:33.074269 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:43:33.074965 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: COMMIT
[0m23:43:33.096563 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:43:33.108425 [debug] [Thread-1 (]: Applying DROP to: "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips__dbt_backup"
[0m23:43:33.115875 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.cleaned_taxi_trips"
[0m23:43:33.116460 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.cleaned_taxi_trips"} */
drop table if exists "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips__dbt_backup" cascade
[0m23:43:33.118419 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:43:33.120628 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.cleaned_taxi_trips (execute): 23:43:32.576016 => 23:43:33.120280
[0m23:43:33.121192 [debug] [Thread-1 (]: On model.nyc_taxi.cleaned_taxi_trips: Close
[0m23:43:33.123087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79a94b24-0eb4-4a13-9c4c-e556fdbd1e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71072c61bac0>]}
[0m23:43:33.126485 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_silver.cleaned_taxi_trips ............. [[32mSELECT 9103[0m in 0.62s]
[0m23:43:33.127577 [debug] [Thread-1 (]: Finished running node model.nyc_taxi.cleaned_taxi_trips
[0m23:43:33.131059 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:33.131907 [debug] [MainThread]: On master: BEGIN
[0m23:43:33.132331 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:43:33.145206 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:33.145838 [debug] [MainThread]: On master: COMMIT
[0m23:43:33.146457 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:33.146981 [debug] [MainThread]: On master: COMMIT
[0m23:43:33.147565 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:43:33.148023 [debug] [MainThread]: On master: Close
[0m23:43:33.149954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:33.150681 [debug] [MainThread]: Connection 'model.nyc_taxi.cleaned_taxi_trips' was properly closed.
[0m23:43:33.151077 [debug] [MainThread]: Connection 'list_nyc_taxi_dw_public_gold' was properly closed.
[0m23:43:33.151469 [info ] [MainThread]: 
[0m23:43:33.151962 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m23:43:33.152904 [debug] [MainThread]: Command end result
[0m23:43:33.168277 [info ] [MainThread]: 
[0m23:43:33.168937 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:43:33.169465 [info ] [MainThread]: 
[0m23:43:33.169910 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:43:33.170962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4132653, "process_user_time": 2.837075, "process_kernel_time": 0.202147, "process_mem_max_rss": "107284", "process_in_blocks": "87952", "process_out_blocks": "3528"}
[0m23:43:33.171531 [debug] [MainThread]: Command `dbt run` succeeded at 23:43:33.171410 after 1.41 seconds
[0m23:43:33.171888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71073010fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71072c61bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71072c5f8250>]}
[0m23:43:33.172268 [debug] [MainThread]: Flushing usage events
[0m23:43:46.383508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f10644e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f104685840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f1046857e0>]}


============================== 23:43:46.386510 | bfd3bfe7-2671-4f07-9caa-2bb3a82faa69 ==============================
[0m23:43:46.386510 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:43:46.387120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /dbt --project-dir /dbt --select gold', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:43:46.567584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfd3bfe7-2671-4f07-9caa-2bb3a82faa69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f104685900>]}
[0m23:43:46.658056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfd3bfe7-2671-4f07-9caa-2bb3a82faa69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f102e28100>]}
[0m23:43:46.658879 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m23:43:46.672329 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:43:46.703007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:43:46.703437 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:43:46.704324 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_taxi.bronze
[0m23:43:46.710348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfd3bfe7-2671-4f07-9caa-2bb3a82faa69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f102b0ffd0>]}
[0m23:43:46.731258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfd3bfe7-2671-4f07-9caa-2bb3a82faa69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f102ad4940>]}
[0m23:43:46.732086 [info ] [MainThread]: Found 4 models, 51 tests, 1 source, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m23:43:46.732631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfd3bfe7-2671-4f07-9caa-2bb3a82faa69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f102ad4be0>]}
[0m23:43:46.735138 [info ] [MainThread]: 
[0m23:43:46.736133 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:43:46.737880 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw'
[0m23:43:46.749860 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw"
[0m23:43:46.750358 [debug] [ThreadPool]: On list_nyc_taxi_dw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:43:46.750693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:46.757143 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m23:43:46.758400 [debug] [ThreadPool]: On list_nyc_taxi_dw: Close
[0m23:43:46.759827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw, now create_nyc_taxi_dw_public_gold)
[0m23:43:46.760699 [debug] [ThreadPool]: Creating schema "database: "nyc_taxi_dw"
schema: "public_gold"
"
[0m23:43:46.766438 [debug] [ThreadPool]: Using postgres connection "create_nyc_taxi_dw_public_gold"
[0m23:43:46.766917 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_gold: BEGIN
[0m23:43:46.767322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:43:46.773487 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:43:46.773906 [debug] [ThreadPool]: Using postgres connection "create_nyc_taxi_dw_public_gold"
[0m23:43:46.774219 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_gold: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "create_nyc_taxi_dw_public_gold"} */
create schema if not exists "public_gold"
[0m23:43:46.774897 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m23:43:46.775811 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_gold: COMMIT
[0m23:43:46.776171 [debug] [ThreadPool]: Using postgres connection "create_nyc_taxi_dw_public_gold"
[0m23:43:46.776509 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_gold: COMMIT
[0m23:43:46.784251 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m23:43:46.784630 [debug] [ThreadPool]: On create_nyc_taxi_dw_public_gold: Close
[0m23:43:46.787426 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw_public_silver'
[0m23:43:46.795163 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:43:46.795793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nyc_taxi_dw_public_gold, now list_nyc_taxi_dw_public_gold)
[0m23:43:46.796199 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: BEGIN
[0m23:43:46.798288 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:43:46.798668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:46.799004 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: BEGIN
[0m23:43:46.799507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:43:46.806978 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:43:46.807330 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:43:46.807720 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:43:46.808053 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:43:46.808425 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_gold"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m23:43:46.808814 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_silver"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m23:43:46.812744 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m23:43:46.814591 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: ROLLBACK
[0m23:43:46.815127 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:43:46.816923 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: ROLLBACK
[0m23:43:46.817431 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: Close
[0m23:43:46.818585 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: Close
[0m23:43:46.827031 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:46.827465 [debug] [MainThread]: On master: BEGIN
[0m23:43:46.828026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:43:46.835138 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:46.835695 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:46.836324 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:43:46.841357 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:43:46.843062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfd3bfe7-2671-4f07-9caa-2bb3a82faa69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f102865f00>]}
[0m23:43:46.843667 [debug] [MainThread]: On master: ROLLBACK
[0m23:43:46.844121 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:46.844458 [debug] [MainThread]: On master: BEGIN
[0m23:43:46.845019 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:46.845451 [debug] [MainThread]: On master: COMMIT
[0m23:43:46.845901 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:46.846367 [debug] [MainThread]: On master: COMMIT
[0m23:43:46.846950 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:43:46.847437 [debug] [MainThread]: On master: Close
[0m23:43:46.848672 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:43:46.850153 [info ] [MainThread]: 
[0m23:43:46.900249 [debug] [Thread-1 (]: Began running node model.nyc_taxi.daily_trip_summary
[0m23:43:46.900716 [debug] [Thread-2 (]: Began running node model.nyc_taxi.hourly_demand_heatmap
[0m23:43:46.901135 [debug] [Thread-3 (]: Began running node model.nyc_taxi.payment_analysis
[0m23:43:46.901792 [info ] [Thread-1 (]: 1 of 3 START sql table model public_gold.daily_trip_summary .................... [RUN]
[0m23:43:46.902567 [info ] [Thread-2 (]: 2 of 3 START sql table model public_gold.hourly_demand_heatmap ................. [RUN]
[0m23:43:46.904420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw_public_gold, now model.nyc_taxi.daily_trip_summary)
[0m23:43:46.905628 [debug] [Thread-1 (]: Began compiling node model.nyc_taxi.daily_trip_summary
[0m23:43:46.905189 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw_public_silver, now model.nyc_taxi.hourly_demand_heatmap)
[0m23:43:46.913211 [debug] [Thread-2 (]: Began compiling node model.nyc_taxi.hourly_demand_heatmap
[0m23:43:46.903274 [info ] [Thread-3 (]: 3 of 3 START sql table model public_gold.payment_analysis ...................... [RUN]
[0m23:43:46.918638 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_taxi.hourly_demand_heatmap"
[0m23:43:46.926580 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nyc_taxi.payment_analysis'
[0m23:43:46.936404 [debug] [Thread-3 (]: Began compiling node model.nyc_taxi.payment_analysis
[0m23:43:46.961237 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_taxi.payment_analysis"
[0m23:43:46.975673 [debug] [Thread-2 (]: Timing info for model.nyc_taxi.hourly_demand_heatmap (compile): 23:43:46.913674 => 23:43:46.975241
[0m23:43:46.976747 [debug] [Thread-3 (]: Timing info for model.nyc_taxi.payment_analysis (compile): 23:43:46.936832 => 23:43:46.976393
[0m23:43:46.978954 [debug] [Thread-3 (]: Began executing node model.nyc_taxi.payment_analysis
[0m23:43:46.978120 [debug] [Thread-2 (]: Began executing node model.nyc_taxi.hourly_demand_heatmap
[0m23:43:46.977632 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_taxi.daily_trip_summary"
[0m23:43:47.038205 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.daily_trip_summary (compile): 23:43:46.905854 => 23:43:47.037762
[0m23:43:47.064454 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_taxi.hourly_demand_heatmap"
[0m23:43:47.065576 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_taxi.payment_analysis"
[0m23:43:47.065977 [debug] [Thread-1 (]: Began executing node model.nyc_taxi.daily_trip_summary
[0m23:43:47.073998 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_taxi.daily_trip_summary"
[0m23:43:47.078923 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.daily_trip_summary"
[0m23:43:47.082258 [debug] [Thread-1 (]: On model.nyc_taxi.daily_trip_summary: BEGIN
[0m23:43:47.081056 [debug] [Thread-3 (]: Using postgres connection "model.nyc_taxi.payment_analysis"
[0m23:43:47.083386 [debug] [Thread-3 (]: On model.nyc_taxi.payment_analysis: BEGIN
[0m23:43:47.081768 [debug] [Thread-2 (]: Using postgres connection "model.nyc_taxi.hourly_demand_heatmap"
[0m23:43:47.084450 [debug] [Thread-2 (]: On model.nyc_taxi.hourly_demand_heatmap: BEGIN
[0m23:43:47.082839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:47.083907 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:43:47.084985 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:43:47.095957 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:47.096710 [debug] [Thread-2 (]: Using postgres connection "model.nyc_taxi.hourly_demand_heatmap"
[0m23:43:47.097445 [debug] [Thread-2 (]: On model.nyc_taxi.hourly_demand_heatmap: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.hourly_demand_heatmap"} */

  
    

  create  table "nyc_taxi_dw"."public_gold"."hourly_demand_heatmap__dbt_tmp"
  
  
    as
  
  (
    

/*
  Gold Layer: hourly_demand_heatmap
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Hour-of-day Ã— Day-of-week demand matrix for Power BI heatmap visuals.
*/

WITH base AS (

    SELECT
        pickup_hour,
        pickup_day_of_week,
        pickup_date,
        EXTRACT(DOW FROM pickup_datetime)::INTEGER AS day_of_week_num,
        total_amount,
        trip_distance_miles,
        trip_duration_mins
    FROM "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"

)

SELECT
    pickup_hour,
    pickup_day_of_week,
    day_of_week_num,
    COUNT(*)                                          AS trip_count,
    ROUND(AVG(total_amount)::NUMERIC, 2)             AS avg_fare,
    ROUND(AVG(trip_distance_miles)::NUMERIC, 2)      AS avg_distance,
    ROUND(AVG(trip_duration_mins)::NUMERIC, 2)       AS avg_duration_mins,
    ROUND(SUM(total_amount)::NUMERIC, 2)             AS total_revenue,
    NOW()                                             AS last_updated_at

FROM base
GROUP BY pickup_hour, pickup_day_of_week, day_of_week_num
ORDER BY day_of_week_num, pickup_hour
  );
  
[0m23:43:47.106151 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:47.107239 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.daily_trip_summary"
[0m23:43:47.108131 [debug] [Thread-1 (]: On model.nyc_taxi.daily_trip_summary: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.daily_trip_summary"} */

  
    

  create  table "nyc_taxi_dw"."public_gold"."daily_trip_summary__dbt_tmp"
  
  
    as
  
  (
    

/*
  Gold Layer: daily_trip_summary
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Business-ready daily aggregation of NYC taxi trips.
  Directly consumed by Power BI dashboards.
  Metrics: trips, revenue, tips, distances, duration, passenger counts.
*/

WITH base AS (

    SELECT *
    FROM "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"

),

daily_agg AS (

    SELECT
        pickup_date,
        pickup_year,
        pickup_month,
        vendor_id,
        payment_type_label,

        -- Volume
        COUNT(*)                                                AS total_trips,
        SUM(passenger_count)                                    AS total_passengers,

        -- Revenue
        ROUND(SUM(total_amount)::NUMERIC, 2)                   AS total_revenue,
        ROUND(AVG(total_amount)::NUMERIC, 2)                   AS avg_fare_per_trip,
        ROUND(SUM(fare_amount)::NUMERIC, 2)                    AS total_base_fare,
        ROUND(SUM(tip_amount)::NUMERIC, 2)                     AS total_tips,
        ROUND(AVG(tip_percentage)::NUMERIC, 4)                 AS avg_tip_rate,
        ROUND(SUM(tolls_amount)::NUMERIC, 2)                   AS total_tolls,
        ROUND(SUM(congestion_surcharge)::NUMERIC, 2)           AS total_congestion_surcharge,

        -- Distance
        ROUND(SUM(trip_distance_miles)::NUMERIC, 2)            AS total_distance_miles,
        ROUND(AVG(trip_distance_miles)::NUMERIC, 2)            AS avg_distance_miles,

        -- Duration
        ROUND(AVG(trip_duration_mins)::NUMERIC, 2)             AS avg_duration_mins,
        ROUND(SUM(trip_duration_mins)::NUMERIC, 2)             AS total_duration_mins,

        -- Speed & cost efficiency
        ROUND(AVG(avg_speed_mph)::NUMERIC, 2)                  AS avg_speed_mph,
        ROUND(AVG(cost_per_mile)::NUMERIC, 2)                  AS avg_cost_per_mile,

        -- Peak hour (mode)
        MODE() WITHIN GROUP (ORDER BY pickup_hour)             AS peak_pickup_hour

    FROM base
    GROUP BY
        pickup_date,
        pickup_year,
        pickup_month,
        vendor_id,
        payment_type_label

)

SELECT
    -- Surrogate key
    md5(cast(coalesce(cast(pickup_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(payment_type_label as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))                                                       AS summary_id,

    pickup_date,
    pickup_year,
    pickup_month,
    TO_CHAR(pickup_date, 'Month')                              AS month_name,
    TO_CHAR(pickup_date, 'Day')                                AS day_of_week,
    vendor_id,
    CASE vendor_id
        WHEN 1 THEN 'Creative Mobile Technologies'
        WHEN 2 THEN 'VeriFone Inc.'
        ELSE        'Unknown Vendor'
    END                                                         AS vendor_name,
    payment_type_label,
    total_trips,
    total_passengers,
    total_revenue,
    avg_fare_per_trip,
    total_base_fare,
    total_tips,
    avg_tip_rate,
    total_tolls,
    total_congestion_surcharge,
    total_distance_miles,
    avg_distance_miles,
    avg_duration_mins,
    total_duration_mins,
    avg_speed_mph,
    avg_cost_per_mile,
    peak_pickup_hour,
    NOW()                                                       AS last_updated_at

FROM daily_agg
  );
  
[0m23:43:47.109039 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:47.109699 [debug] [Thread-3 (]: Using postgres connection "model.nyc_taxi.payment_analysis"
[0m23:43:47.110410 [debug] [Thread-3 (]: On model.nyc_taxi.payment_analysis: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.payment_analysis"} */

  
    

  create  table "nyc_taxi_dw"."public_gold"."payment_analysis__dbt_tmp"
  
  
    as
  
  (
    

/*
  Gold Layer: payment_analysis
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Payment type breakdown with tipping behavior analysis.
  Drives donut charts and tip behavior dashboards in Power BI.
*/

WITH base AS (

    SELECT *
    FROM "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"

),

payment_agg AS (

    SELECT
        payment_type_code,
        payment_type_label,
        COUNT(*)                                           AS trip_count,
        ROUND(SUM(total_amount)::NUMERIC, 2)              AS total_revenue,
        ROUND(AVG(total_amount)::NUMERIC, 2)              AS avg_fare,
        ROUND(SUM(tip_amount)::NUMERIC, 2)                AS total_tips,
        ROUND(AVG(tip_amount)::NUMERIC, 2)                AS avg_tip,
        ROUND(AVG(tip_percentage)::NUMERIC, 4)            AS avg_tip_rate,
        COUNT(*) FILTER (WHERE tip_amount > 0)            AS tipped_trips,
        ROUND(AVG(trip_distance_miles)::NUMERIC, 2)       AS avg_distance,
        ROUND(AVG(trip_duration_mins)::NUMERIC, 2)        AS avg_duration_mins
    FROM base
    GROUP BY payment_type_code, payment_type_label

),

totals AS (
    SELECT SUM(trip_count) AS grand_total_trips,
           SUM(total_revenue) AS grand_total_revenue
    FROM payment_agg
)

SELECT
    p.*,
    ROUND((p.trip_count::NUMERIC / t.grand_total_trips) * 100, 2) AS pct_of_total_trips,
    ROUND((p.total_revenue::NUMERIC / t.grand_total_revenue) * 100, 2) AS pct_of_total_revenue,
    ROUND((p.tipped_trips::NUMERIC / NULLIF(p.trip_count, 0)) * 100, 2) AS tip_frequency_pct,
    NOW() AS last_updated_at
FROM payment_agg p
CROSS JOIN totals t
ORDER BY trip_count DESC
  );
  
[0m23:43:47.123287 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.0 seconds
[0m23:43:47.144160 [debug] [Thread-2 (]: Using postgres connection "model.nyc_taxi.hourly_demand_heatmap"
[0m23:43:47.144869 [debug] [Thread-2 (]: On model.nyc_taxi.hourly_demand_heatmap: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.hourly_demand_heatmap"} */
alter table "nyc_taxi_dw"."public_gold"."hourly_demand_heatmap__dbt_tmp" rename to "hourly_demand_heatmap"
[0m23:43:47.145497 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.0 seconds
[0m23:43:47.150427 [debug] [Thread-3 (]: Using postgres connection "model.nyc_taxi.payment_analysis"
[0m23:43:47.150954 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:47.151486 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m23:43:47.152038 [debug] [Thread-3 (]: On model.nyc_taxi.payment_analysis: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.payment_analysis"} */
alter table "nyc_taxi_dw"."public_gold"."payment_analysis__dbt_tmp" rename to "payment_analysis"
[0m23:43:47.162455 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.daily_trip_summary"
[0m23:43:47.170671 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:47.177518 [debug] [Thread-1 (]: On model.nyc_taxi.daily_trip_summary: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.daily_trip_summary"} */
alter table "nyc_taxi_dw"."public_gold"."daily_trip_summary__dbt_tmp" rename to "daily_trip_summary"
[0m23:43:47.179579 [debug] [Thread-2 (]: On model.nyc_taxi.hourly_demand_heatmap: COMMIT
[0m23:43:47.182407 [debug] [Thread-3 (]: On model.nyc_taxi.payment_analysis: COMMIT
[0m23:43:47.183004 [debug] [Thread-2 (]: Using postgres connection "model.nyc_taxi.hourly_demand_heatmap"
[0m23:43:47.183500 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:47.183824 [debug] [Thread-3 (]: Using postgres connection "model.nyc_taxi.payment_analysis"
[0m23:43:47.184201 [debug] [Thread-2 (]: On model.nyc_taxi.hourly_demand_heatmap: COMMIT
[0m23:43:47.193747 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.daily_trip_summary"
[0m23:43:47.195037 [debug] [Thread-1 (]: On model.nyc_taxi.daily_trip_summary: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.daily_trip_summary"} */

    create  index if not exists
  "f4f714f59187509983cfd90ae8930e6c"
  on "nyc_taxi_dw"."public_gold"."daily_trip_summary" using btree
  (pickup_date);
  
[0m23:43:47.194460 [debug] [Thread-3 (]: On model.nyc_taxi.payment_analysis: COMMIT
[0m23:43:47.196446 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:43:47.197085 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:43:47.203857 [debug] [Thread-2 (]: Applying DROP to: "nyc_taxi_dw"."public_gold"."hourly_demand_heatmap__dbt_backup"
[0m23:43:47.204222 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:43:47.206765 [debug] [Thread-3 (]: Applying DROP to: "nyc_taxi_dw"."public_gold"."payment_analysis__dbt_backup"
[0m23:43:47.211036 [debug] [Thread-2 (]: Using postgres connection "model.nyc_taxi.hourly_demand_heatmap"
[0m23:43:47.212884 [debug] [Thread-1 (]: On model.nyc_taxi.daily_trip_summary: COMMIT
[0m23:43:47.213873 [debug] [Thread-3 (]: Using postgres connection "model.nyc_taxi.payment_analysis"
[0m23:43:47.214306 [debug] [Thread-2 (]: On model.nyc_taxi.hourly_demand_heatmap: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.hourly_demand_heatmap"} */
drop table if exists "nyc_taxi_dw"."public_gold"."hourly_demand_heatmap__dbt_backup" cascade
[0m23:43:47.214744 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.daily_trip_summary"
[0m23:43:47.215133 [debug] [Thread-3 (]: On model.nyc_taxi.payment_analysis: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.payment_analysis"} */
drop table if exists "nyc_taxi_dw"."public_gold"."payment_analysis__dbt_backup" cascade
[0m23:43:47.215707 [debug] [Thread-1 (]: On model.nyc_taxi.daily_trip_summary: COMMIT
[0m23:43:47.216065 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:43:47.218485 [debug] [Thread-2 (]: Timing info for model.nyc_taxi.hourly_demand_heatmap (execute): 23:43:46.993697 => 23:43:47.218186
[0m23:43:47.219496 [debug] [Thread-2 (]: On model.nyc_taxi.hourly_demand_heatmap: Close
[0m23:43:47.219011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:43:47.219931 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:43:47.223983 [debug] [Thread-1 (]: Applying DROP to: "nyc_taxi_dw"."public_gold"."daily_trip_summary__dbt_backup"
[0m23:43:47.228333 [debug] [Thread-1 (]: Using postgres connection "model.nyc_taxi.daily_trip_summary"
[0m23:43:47.227184 [debug] [Thread-3 (]: Timing info for model.nyc_taxi.payment_analysis (execute): 23:43:46.979391 => 23:43:47.226907
[0m23:43:47.229548 [debug] [Thread-3 (]: On model.nyc_taxi.payment_analysis: Close
[0m23:43:47.230662 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfd3bfe7-2671-4f07-9caa-2bb3a82faa69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f102d415d0>]}
[0m23:43:47.224839 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfd3bfe7-2671-4f07-9caa-2bb3a82faa69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f102854730>]}
[0m23:43:47.234094 [info ] [Thread-2 (]: 2 of 3 OK created sql table model public_gold.hourly_demand_heatmap ............ [[32mSELECT 4[0m in 0.32s]
[0m23:43:47.228867 [debug] [Thread-1 (]: On model.nyc_taxi.daily_trip_summary: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "model.nyc_taxi.daily_trip_summary"} */
drop table if exists "nyc_taxi_dw"."public_gold"."daily_trip_summary__dbt_backup" cascade
[0m23:43:47.235905 [debug] [Thread-2 (]: Finished running node model.nyc_taxi.hourly_demand_heatmap
[0m23:43:47.234975 [info ] [Thread-3 (]: 3 of 3 OK created sql table model public_gold.payment_analysis ................. [[32mSELECT 4[0m in 0.30s]
[0m23:43:47.237059 [debug] [Thread-3 (]: Finished running node model.nyc_taxi.payment_analysis
[0m23:43:47.237564 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:43:47.240008 [debug] [Thread-1 (]: Timing info for model.nyc_taxi.daily_trip_summary (execute): 23:43:47.066492 => 23:43:47.239682
[0m23:43:47.240687 [debug] [Thread-1 (]: On model.nyc_taxi.daily_trip_summary: Close
[0m23:43:47.243593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfd3bfe7-2671-4f07-9caa-2bb3a82faa69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f1028ad330>]}
[0m23:43:47.245508 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public_gold.daily_trip_summary ............... [[32mSELECT 6[0m in 0.34s]
[0m23:43:47.247385 [debug] [Thread-1 (]: Finished running node model.nyc_taxi.daily_trip_summary
[0m23:43:47.249407 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:47.249986 [debug] [MainThread]: On master: BEGIN
[0m23:43:47.250438 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:43:47.257666 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:47.258174 [debug] [MainThread]: On master: COMMIT
[0m23:43:47.258641 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:47.259053 [debug] [MainThread]: On master: COMMIT
[0m23:43:47.259500 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:43:47.259832 [debug] [MainThread]: On master: Close
[0m23:43:47.260646 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:47.261032 [debug] [MainThread]: Connection 'model.nyc_taxi.daily_trip_summary' was properly closed.
[0m23:43:47.261371 [debug] [MainThread]: Connection 'model.nyc_taxi.hourly_demand_heatmap' was properly closed.
[0m23:43:47.261706 [debug] [MainThread]: Connection 'model.nyc_taxi.payment_analysis' was properly closed.
[0m23:43:47.262184 [info ] [MainThread]: 
[0m23:43:47.262708 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m23:43:47.263736 [debug] [MainThread]: Command end result
[0m23:43:47.276771 [info ] [MainThread]: 
[0m23:43:47.277318 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:43:47.277800 [info ] [MainThread]: 
[0m23:43:47.278251 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:43:47.279138 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9359018, "process_user_time": 2.775367, "process_kernel_time": 0.135697, "process_mem_max_rss": "108408", "process_in_blocks": "32", "process_out_blocks": "2880"}
[0m23:43:47.279673 [debug] [MainThread]: Command `dbt run` succeeded at 23:43:47.279550 after 0.94 seconds
[0m23:43:47.280010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f10644e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f102d415d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f102e28100>]}
[0m23:43:47.280398 [debug] [MainThread]: Flushing usage events
[0m23:44:15.083219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e127ee290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e10a5a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e10a5a170>]}


============================== 23:44:15.086747 | 6ed349dd-ff68-4706-ad6f-bb06310e1b3c ==============================
[0m23:44:15.086747 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:44:15.087506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /dbt --project-dir /dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:44:15.310456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ed349dd-ff68-4706-ad6f-bb06310e1b3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e114723e0>]}
[0m23:44:15.403103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ed349dd-ff68-4706-ad6f-bb06310e1b3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e0f016b30>]}
[0m23:44:15.403908 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m23:44:15.416148 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:44:15.454427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:44:15.454784 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:44:15.455862 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_taxi.bronze
[0m23:44:15.469966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ed349dd-ff68-4706-ad6f-bb06310e1b3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e0ecec9a0>]}
[0m23:44:15.494124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ed349dd-ff68-4706-ad6f-bb06310e1b3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e0eeb4940>]}
[0m23:44:15.494843 [info ] [MainThread]: Found 4 models, 51 tests, 1 source, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m23:44:15.495660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ed349dd-ff68-4706-ad6f-bb06310e1b3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e0eeb4d00>]}
[0m23:44:15.501286 [info ] [MainThread]: 
[0m23:44:15.502526 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:44:15.504420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw_public_silver'
[0m23:44:15.506130 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_taxi_dw_public_gold'
[0m23:44:15.536743 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:44:15.537150 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:44:15.538112 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: BEGIN
[0m23:44:15.538583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:15.537644 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: BEGIN
[0m23:44:15.539994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:15.551043 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:44:15.551620 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_gold"
[0m23:44:15.552145 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_gold"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m23:44:15.552981 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:44:15.555509 [debug] [ThreadPool]: Using postgres connection "list_nyc_taxi_dw_public_silver"
[0m23:44:15.556046 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "list_nyc_taxi_dw_public_silver"} */
select
      'nyc_taxi_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'nyc_taxi_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m23:44:15.557866 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m23:44:15.559790 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: ROLLBACK
[0m23:44:15.560431 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_gold: Close
[0m23:44:15.563556 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:15.566002 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: ROLLBACK
[0m23:44:15.566792 [debug] [ThreadPool]: On list_nyc_taxi_dw_public_silver: Close
[0m23:44:15.576500 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:15.576941 [debug] [MainThread]: On master: BEGIN
[0m23:44:15.577352 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:44:15.585172 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:44:15.585541 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:15.585914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:44:15.589412 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:44:15.590395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ed349dd-ff68-4706-ad6f-bb06310e1b3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e10a09ab0>]}
[0m23:44:15.590834 [debug] [MainThread]: On master: ROLLBACK
[0m23:44:15.591261 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:15.591587 [debug] [MainThread]: On master: BEGIN
[0m23:44:15.592080 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:44:15.592418 [debug] [MainThread]: On master: COMMIT
[0m23:44:15.592715 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:15.592989 [debug] [MainThread]: On master: COMMIT
[0m23:44:15.593386 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:44:15.593682 [debug] [MainThread]: On master: Close
[0m23:44:15.594451 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m23:44:15.595046 [info ] [MainThread]: 
[0m23:44:15.598046 [debug] [Thread-1 (]: Began running node test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8
[0m23:44:15.598434 [debug] [Thread-2 (]: Began running node test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019
[0m23:44:15.598860 [debug] [Thread-3 (]: Began running node test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7
[0m23:44:15.599204 [info ] [Thread-1 (]: 1 of 51 START test accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6  [RUN]
[0m23:44:15.600306 [debug] [Thread-4 (]: Began running node test.nyc_taxi.assert_dropoff_after_pickup
[0m23:44:15.601905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw_public_silver, now test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8)
[0m23:44:15.602698 [info ] [Thread-4 (]: 4 of 51 START test assert_dropoff_after_pickup ................................. [RUN]
[0m23:44:15.599832 [info ] [Thread-2 (]: 2 of 51 START test accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other  [RUN]
[0m23:44:15.604581 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.nyc_taxi.assert_dropoff_after_pickup'
[0m23:44:15.606182 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.assert_dropoff_after_pickup
[0m23:44:15.603557 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8
[0m23:44:15.600844 [info ] [Thread-3 (]: 3 of 51 START test accepted_values_cleaned_taxi_trips_vendor_id__1__2 .......... [RUN]
[0m23:44:15.605548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nyc_taxi_dw_public_gold, now test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019)
[0m23:44:15.658072 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.assert_dropoff_after_pickup"
[0m23:44:15.665595 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7'
[0m23:44:15.672037 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7
[0m23:44:15.671395 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019
[0m23:44:15.671004 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8"
[0m23:44:15.676773 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7"
[0m23:44:15.684555 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019"
[0m23:44:15.685558 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.assert_dropoff_after_pickup (compile): 23:44:15.606664 => 23:44:15.685100
[0m23:44:15.686477 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.assert_dropoff_after_pickup
[0m23:44:15.695194 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7 (compile): 23:44:15.672584 => 23:44:15.694818
[0m23:44:15.704823 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7
[0m23:44:15.697440 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019 (compile): 23:44:15.677155 => 23:44:15.697026
[0m23:44:15.717031 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019
[0m23:44:15.698305 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8 (compile): 23:44:15.658420 => 23:44:15.697868
[0m23:44:15.730987 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8
[0m23:44:15.740742 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019"
[0m23:44:15.741770 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.assert_dropoff_after_pickup"
[0m23:44:15.751026 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8"
[0m23:44:15.754135 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7"
[0m23:44:15.781758 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8"
[0m23:44:15.782438 [debug] [Thread-1 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8: BEGIN
[0m23:44:15.782955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:15.783817 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7"
[0m23:44:15.784269 [debug] [Thread-3 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7: BEGIN
[0m23:44:15.784821 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:44:15.787746 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019"
[0m23:44:15.788326 [debug] [Thread-2 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019: BEGIN
[0m23:44:15.788893 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:44:15.789674 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.assert_dropoff_after_pickup"
[0m23:44:15.790177 [debug] [Thread-4 (]: On test.nyc_taxi.assert_dropoff_after_pickup: BEGIN
[0m23:44:15.790672 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:44:15.822100 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:15.822886 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8"
[0m23:44:15.824909 [debug] [Thread-1 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type_code as value_field,
        count(*) as n_records

    from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
    group by payment_type_code

)

select *
from all_values
where value_field not in (
    '1','2','3','4','5','6'
)



      
    ) dbt_internal_test
[0m23:44:15.828631 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:15.825613 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:15.829835 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019"
[0m23:44:15.829180 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.assert_dropoff_after_pickup"
[0m23:44:15.833760 [debug] [Thread-4 (]: On test.nyc_taxi.assert_dropoff_after_pickup: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.assert_dropoff_after_pickup"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Singular test: No trips should have dropoff BEFORE pickup
-- File: tests/assert_dropoff_after_pickup.sql

SELECT
    trip_id,
    pickup_datetime,
    dropoff_datetime,
    trip_duration_mins
FROM "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
WHERE dropoff_datetime <= pickup_datetime
   OR trip_duration_mins <= 0
      
    ) dbt_internal_test
[0m23:44:15.831487 [debug] [Thread-2 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_type_label as value_field,
        count(*) as n_records

    from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
    group by payment_type_label

)

select *
from all_values
where value_field not in (
    'Credit Card','Cash','No Charge','Dispute','Unknown','Voided Trip','Other'
)



      
    ) dbt_internal_test
[0m23:44:15.837196 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:15.840160 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8 (execute): 23:44:15.731330 => 23:44:15.839792
[0m23:44:15.840769 [debug] [Thread-1 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8: ROLLBACK
[0m23:44:15.844639 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:15.845191 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7"
[0m23:44:15.845793 [debug] [Thread-3 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        vendor_id as value_field,
        count(*) as n_records

    from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
    group by vendor_id

)

select *
from all_values
where value_field not in (
    '1','2'
)



      
    ) dbt_internal_test
[0m23:44:15.847926 [debug] [Thread-1 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8: Close
[0m23:44:15.851091 [info ] [Thread-1 (]: 1 of 51 PASS accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6  [[32mPASS[0m in 0.25s]
[0m23:44:15.853068 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8
[0m23:44:15.854951 [debug] [Thread-1 (]: Began running node test.nyc_taxi.assert_gold_coverage
[0m23:44:15.856716 [info ] [Thread-1 (]: 5 of 51 START test assert_gold_coverage ........................................ [RUN]
[0m23:44:15.858507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_code__1__2__3__4__5__6.8662eb07f8, now test.nyc_taxi.assert_gold_coverage)
[0m23:44:15.859569 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.assert_gold_coverage
[0m23:44:15.869554 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:15.869094 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.assert_gold_coverage"
[0m23:44:15.872914 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.assert_gold_coverage (compile): 23:44:15.860511 => 23:44:15.872621
[0m23:44:15.871998 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019 (execute): 23:44:15.717415 => 23:44:15.871631
[0m23:44:15.874281 [debug] [Thread-2 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019: ROLLBACK
[0m23:44:15.873604 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.assert_gold_coverage
[0m23:44:15.880219 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.assert_gold_coverage"
[0m23:44:15.881872 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.assert_gold_coverage"
[0m23:44:15.880712 [debug] [Thread-2 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019: Close
[0m23:44:15.881130 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:15.882287 [debug] [Thread-1 (]: On test.nyc_taxi.assert_gold_coverage: BEGIN
[0m23:44:15.883005 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:15.888266 [info ] [Thread-2 (]: 2 of 51 PASS accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other  [[32mPASS[0m in 0.28s]
[0m23:44:15.892308 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019
[0m23:44:15.888958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:15.886188 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7 (execute): 23:44:15.705176 => 23:44:15.885888
[0m23:44:15.895592 [debug] [Thread-3 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7: ROLLBACK
[0m23:44:15.891183 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.assert_dropoff_after_pickup (execute): 23:44:15.687052 => 23:44:15.890853
[0m23:44:15.896966 [debug] [Thread-4 (]: On test.nyc_taxi.assert_dropoff_after_pickup: ROLLBACK
[0m23:44:15.898294 [debug] [Thread-3 (]: On test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7: Close
[0m23:44:15.893552 [debug] [Thread-2 (]: Began running node test.nyc_taxi.assert_total_amount_gte_fare
[0m23:44:15.904591 [debug] [Thread-4 (]: On test.nyc_taxi.assert_dropoff_after_pickup: Close
[0m23:44:15.901810 [info ] [Thread-2 (]: 6 of 51 START test assert_total_amount_gte_fare ................................ [RUN]
[0m23:44:15.912370 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_cleaned_taxi_trips_payment_type_label__Credit_Card__Cash__No_Charge__Dispute__Unknown__Voided_Trip__Other.ff5eafa019, now test.nyc_taxi.assert_total_amount_gte_fare)
[0m23:44:15.910155 [info ] [Thread-3 (]: 3 of 51 PASS accepted_values_cleaned_taxi_trips_vendor_id__1__2 ................ [[32mPASS[0m in 0.25s]
[0m23:44:15.913120 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.assert_total_amount_gte_fare
[0m23:44:15.905724 [info ] [Thread-4 (]: 4 of 51 PASS assert_dropoff_after_pickup ....................................... [[32mPASS[0m in 0.30s]
[0m23:44:15.915166 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7
[0m23:44:15.921946 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.assert_dropoff_after_pickup
[0m23:44:15.926556 [debug] [Thread-4 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388
[0m23:44:15.925305 [debug] [Thread-3 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad
[0m23:44:15.924617 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.assert_total_amount_gte_fare"
[0m23:44:15.929082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:15.929950 [info ] [Thread-3 (]: 7 of 51 START test dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0  [RUN]
[0m23:44:15.931933 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.assert_gold_coverage"
[0m23:44:15.931273 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.assert_total_amount_gte_fare (compile): 23:44:15.915936 => 23:44:15.930857
[0m23:44:15.927092 [info ] [Thread-4 (]: 8 of 51 START test dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1  [RUN]
[0m23:44:15.935268 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.assert_dropoff_after_pickup, now test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388)
[0m23:44:15.935836 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388
[0m23:44:15.934380 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.assert_total_amount_gte_fare
[0m23:44:15.932979 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_cleaned_taxi_trips_vendor_id__1__2.e2230a07a7, now test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad)
[0m23:44:15.945718 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad
[0m23:44:15.933719 [debug] [Thread-1 (]: On test.nyc_taxi.assert_gold_coverage: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.assert_gold_coverage"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Singular test: Every silver trip date should appear in gold summary
-- Detects data loss in the silver â†’ gold transformation
-- File: tests/assert_gold_coverage.sql

WITH silver_dates AS (
    SELECT DISTINCT pickup_date
    FROM "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
),

gold_dates AS (
    SELECT DISTINCT pickup_date
    FROM "nyc_taxi_dw"."public_gold"."daily_trip_summary"
)

SELECT s.pickup_date
FROM silver_dates s
LEFT JOIN gold_dates g ON s.pickup_date = g.pickup_date
WHERE g.pickup_date IS NULL
      
    ) dbt_internal_test
[0m23:44:15.945106 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.assert_total_amount_gte_fare"
[0m23:44:15.973217 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.assert_total_amount_gte_fare"
[0m23:44:15.973821 [debug] [Thread-2 (]: On test.nyc_taxi.assert_total_amount_gte_fare: BEGIN
[0m23:44:15.965787 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:15.974293 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:44:15.981271 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388"
[0m23:44:15.982565 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388 (compile): 23:44:15.936163 => 23:44:15.982182
[0m23:44:15.978701 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.assert_gold_coverage (execute): 23:44:15.874857 => 23:44:15.976297
[0m23:44:15.980429 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad"
[0m23:44:15.983185 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388
[0m23:44:15.983821 [debug] [Thread-1 (]: On test.nyc_taxi.assert_gold_coverage: ROLLBACK
[0m23:44:15.984694 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad (compile): 23:44:15.946050 => 23:44:15.984295
[0m23:44:15.999072 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad
[0m23:44:16.000434 [debug] [Thread-1 (]: On test.nyc_taxi.assert_gold_coverage: Close
[0m23:44:16.007149 [info ] [Thread-1 (]: 5 of 51 PASS assert_gold_coverage .............................................. [[32mPASS[0m in 0.15s]
[0m23:44:16.005725 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad"
[0m23:44:16.001794 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.007949 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.assert_gold_coverage
[0m23:44:16.001006 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388"
[0m23:44:16.010671 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.assert_total_amount_gte_fare"
[0m23:44:16.011281 [debug] [Thread-1 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268
[0m23:44:16.011668 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad"
[0m23:44:16.012824 [info ] [Thread-1 (]: 9 of 51 START test dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0  [RUN]
[0m23:44:16.012283 [debug] [Thread-2 (]: On test.nyc_taxi.assert_total_amount_gte_fare: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.assert_total_amount_gte_fare"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Singular test: Total amount should always be >= fare_amount
-- (total = fare + tips + surcharges, never less than base fare)
-- File: tests/assert_total_amount_gte_fare.sql

SELECT
    trip_id,
    fare_amount,
    total_amount,
    tip_amount,
    tolls_amount
FROM "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
WHERE total_amount < fare_amount
  AND total_amount > 0
      
    ) dbt_internal_test
[0m23:44:16.013432 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad: BEGIN
[0m23:44:16.015619 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:44:16.013969 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388"
[0m23:44:16.016651 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388: BEGIN
[0m23:44:16.014969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.assert_gold_coverage, now test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268)
[0m23:44:16.022222 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268
[0m23:44:16.017127 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:44:16.035688 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268"
[0m23:44:16.039898 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.043020 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.assert_total_amount_gte_fare (execute): 23:44:15.941547 => 23:44:16.042595
[0m23:44:16.044578 [debug] [Thread-2 (]: On test.nyc_taxi.assert_total_amount_gte_fare: ROLLBACK
[0m23:44:16.043791 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268 (compile): 23:44:16.022637 => 23:44:16.043395
[0m23:44:16.045278 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268
[0m23:44:16.046304 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.052894 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad"
[0m23:44:16.053555 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"

where not(fare_amount >= 0)


      
    ) dbt_internal_test
[0m23:44:16.046888 [debug] [Thread-2 (]: On test.nyc_taxi.assert_total_amount_gte_fare: Close
[0m23:44:16.056150 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.060417 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388"
[0m23:44:16.061005 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"

where not(tip_percentage BETWEEN 0 AND 1)


      
    ) dbt_internal_test
[0m23:44:16.058034 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268"
[0m23:44:16.055692 [info ] [Thread-2 (]: 6 of 51 PASS assert_total_amount_gte_fare ...................................... [[32mPASS[0m in 0.14s]
[0m23:44:16.062520 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.assert_total_amount_gte_fare
[0m23:44:16.063139 [debug] [Thread-2 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17
[0m23:44:16.064727 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268"
[0m23:44:16.066672 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268: BEGIN
[0m23:44:16.065358 [info ] [Thread-2 (]: 10 of 51 START test dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0  [RUN]
[0m23:44:16.067687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:16.068837 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.assert_total_amount_gte_fare, now test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17)
[0m23:44:16.071081 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17
[0m23:44:16.079896 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17"
[0m23:44:16.081250 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17 (compile): 23:44:16.072009 => 23:44:16.080735
[0m23:44:16.082104 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17
[0m23:44:16.088114 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17"
[0m23:44:16.089597 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.093655 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388 (execute): 23:44:15.986416 => 23:44:16.093307
[0m23:44:16.094145 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.094699 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17"
[0m23:44:16.095232 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388: ROLLBACK
[0m23:44:16.098704 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.099195 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268"
[0m23:44:16.099749 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"

where not(total_amount > 0)


      
    ) dbt_internal_test
[0m23:44:16.101573 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388: Close
[0m23:44:16.097881 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17: BEGIN
[0m23:44:16.097211 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad (execute): 23:44:16.002211 => 23:44:16.096899
[0m23:44:16.103825 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad: ROLLBACK
[0m23:44:16.103245 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:44:16.102715 [info ] [Thread-4 (]: 8 of 51 PASS dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1  [[32mPASS[0m in 0.17s]
[0m23:44:16.105154 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388
[0m23:44:16.109426 [debug] [Thread-4 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2
[0m23:44:16.108736 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad: Close
[0m23:44:16.110736 [info ] [Thread-4 (]: 11 of 51 START test dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0  [RUN]
[0m23:44:16.113496 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_tip_percentage__BETWEEN_0_AND_1.57f0973388, now test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2)
[0m23:44:16.111797 [info ] [Thread-3 (]: 7 of 51 PASS dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0 ... [[32mPASS[0m in 0.18s]
[0m23:44:16.115798 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad
[0m23:44:16.114961 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2
[0m23:44:16.117364 [debug] [Thread-3 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661
[0m23:44:16.125760 [info ] [Thread-3 (]: 12 of 51 START test dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0  [RUN]
[0m23:44:16.127017 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_fare_amount___0.deb7e3bdad, now test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661)
[0m23:44:16.134833 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661
[0m23:44:16.134190 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2"
[0m23:44:16.142182 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2 (compile): 23:44:16.117817 => 23:44:16.141826
[0m23:44:16.144909 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2
[0m23:44:16.144387 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661"
[0m23:44:16.149758 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661 (compile): 23:44:16.135182 => 23:44:16.149415
[0m23:44:16.143051 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.151033 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17"
[0m23:44:16.151682 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"

where not(trip_duration_mins > 0)


      
    ) dbt_internal_test
[0m23:44:16.141129 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.150395 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661
[0m23:44:16.148741 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2"
[0m23:44:16.154155 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268 (execute): 23:44:16.047227 => 23:44:16.153816
[0m23:44:16.163306 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268: ROLLBACK
[0m23:44:16.162805 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2"
[0m23:44:16.164194 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2: BEGIN
[0m23:44:16.164772 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:44:16.166576 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268: Close
[0m23:44:16.159995 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661"
[0m23:44:16.170089 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661"
[0m23:44:16.174493 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661: BEGIN
[0m23:44:16.175034 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:44:16.167777 [info ] [Thread-1 (]: 9 of 51 PASS dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0 .. [[32mPASS[0m in 0.15s]
[0m23:44:16.178811 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268
[0m23:44:16.179626 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.184630 [debug] [Thread-1 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c
[0m23:44:16.198237 [info ] [Thread-1 (]: 13 of 51 START test dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1  [RUN]
[0m23:44:16.197548 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17 (execute): 23:44:16.082636 => 23:44:16.194996
[0m23:44:16.202281 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17: ROLLBACK
[0m23:44:16.200974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_total_amount___0.3d68174268, now test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c)
[0m23:44:16.203751 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c
[0m23:44:16.211854 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17: Close
[0m23:44:16.213567 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.240769 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661"
[0m23:44:16.216807 [info ] [Thread-2 (]: 10 of 51 PASS dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0  [[32mPASS[0m in 0.15s]
[0m23:44:16.248985 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17
[0m23:44:16.212758 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.256045 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2"
[0m23:44:16.253140 [debug] [Thread-2 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6
[0m23:44:16.245889 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"

where not(avg_fare_per_trip > 0)


      
    ) dbt_internal_test
[0m23:44:16.255176 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c"
[0m23:44:16.261756 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c (compile): 23:44:16.204676 => 23:44:16.261475
[0m23:44:16.263966 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.257723 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"

where not(avg_duration_mins > 0)


      
    ) dbt_internal_test
[0m23:44:16.264982 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c
[0m23:44:16.259167 [info ] [Thread-2 (]: 14 of 51 START test dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0  [RUN]
[0m23:44:16.287428 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_cleaned_taxi_trips_trip_duration_mins___0.a05602df17, now test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6)
[0m23:44:16.296019 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6
[0m23:44:16.269488 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661 (execute): 23:44:16.156647 => 23:44:16.269026
[0m23:44:16.303969 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661: ROLLBACK
[0m23:44:16.303416 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c"
[0m23:44:16.295511 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.305816 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661: Close
[0m23:44:16.317437 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c"
[0m23:44:16.305177 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6"
[0m23:44:16.318995 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6 (compile): 23:44:16.296433 => 23:44:16.318671
[0m23:44:16.309978 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2 (execute): 23:44:16.145351 => 23:44:16.309650
[0m23:44:16.320309 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2: ROLLBACK
[0m23:44:16.315049 [info ] [Thread-3 (]: 12 of 51 PASS dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0  [[32mPASS[0m in 0.19s]
[0m23:44:16.318089 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c: BEGIN
[0m23:44:16.322936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:16.321077 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2: Close
[0m23:44:16.319606 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6
[0m23:44:16.322072 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661
[0m23:44:16.339040 [debug] [Thread-3 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6
[0m23:44:16.342936 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6"
[0m23:44:16.337449 [info ] [Thread-4 (]: 11 of 51 PASS dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0  [[32mPASS[0m in 0.22s]
[0m23:44:16.345819 [info ] [Thread-3 (]: 15 of 51 START test dbt_utils_expression_is_true_daily_trip_summary_total_trips___0  [RUN]
[0m23:44:16.355748 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_fare_per_trip___0.856a7ba661, now test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6)
[0m23:44:16.353036 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2
[0m23:44:16.354619 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6"
[0m23:44:16.359316 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6: BEGIN
[0m23:44:16.359782 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:44:16.347926 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.360871 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c"
[0m23:44:16.361478 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"

where not(avg_tip_rate BETWEEN 0 AND 1)


      
    ) dbt_internal_test
[0m23:44:16.358762 [debug] [Thread-4 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d
[0m23:44:16.357992 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6
[0m23:44:16.363583 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.372615 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6"
[0m23:44:16.364295 [info ] [Thread-4 (]: 16 of 51 START test dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23  [RUN]
[0m23:44:16.379131 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.377796 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c (execute): 23:44:16.271539 => 23:44:16.376150
[0m23:44:16.379979 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6 (compile): 23:44:16.364739 => 23:44:16.379717
[0m23:44:16.380563 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_duration_mins___0.a2c2f996b2, now test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d)
[0m23:44:16.380983 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6"
[0m23:44:16.381421 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c: ROLLBACK
[0m23:44:16.381848 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6
[0m23:44:16.382238 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d
[0m23:44:16.382657 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"

where not(total_revenue > 0)


      
    ) dbt_internal_test
[0m23:44:16.383154 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c: Close
[0m23:44:16.385561 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6"
[0m23:44:16.393555 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6"
[0m23:44:16.394088 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.392423 [info ] [Thread-1 (]: 13 of 51 PASS dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1  [[32mPASS[0m in 0.19s]
[0m23:44:16.394650 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6: BEGIN
[0m23:44:16.391203 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d"
[0m23:44:16.396170 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6 (execute): 23:44:16.326300 => 23:44:16.395949
[0m23:44:16.396728 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c
[0m23:44:16.397111 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:44:16.397679 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6: ROLLBACK
[0m23:44:16.398082 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d (compile): 23:44:16.385843 => 23:44:16.397887
[0m23:44:16.398539 [debug] [Thread-1 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67
[0m23:44:16.399412 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d
[0m23:44:16.400276 [info ] [Thread-1 (]: 17 of 51 START test dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0  [RUN]
[0m23:44:16.407036 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6: Close
[0m23:44:16.408005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_avg_tip_rate__BETWEEN_0_AND_1.547e4c5f6c, now test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67)
[0m23:44:16.411550 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67
[0m23:44:16.409031 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d"
[0m23:44:16.411071 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.417035 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6"
[0m23:44:16.410652 [info ] [Thread-2 (]: 14 of 51 PASS dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0  [[32mPASS[0m in 0.13s]
[0m23:44:16.417873 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d"
[0m23:44:16.416020 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67"
[0m23:44:16.424207 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67 (compile): 23:44:16.411912 => 23:44:16.423862
[0m23:44:16.422606 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d: BEGIN
[0m23:44:16.418410 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"

where not(total_trips > 0)


      
    ) dbt_internal_test
[0m23:44:16.424741 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67
[0m23:44:16.426536 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:44:16.419217 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6
[0m23:44:16.434761 [debug] [Thread-2 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322
[0m23:44:16.431908 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.431408 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67"
[0m23:44:16.436249 [info ] [Thread-2 (]: 18 of 51 START test dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100  [RUN]
[0m23:44:16.441869 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_revenue___0.214b3af8b6, now test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322)
[0m23:44:16.442489 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322
[0m23:44:16.439702 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6 (execute): 23:44:16.383370 => 23:44:16.439377
[0m23:44:16.440885 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67"
[0m23:44:16.448467 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6: ROLLBACK
[0m23:44:16.448963 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.449623 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67: BEGIN
[0m23:44:16.454094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:16.452838 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322"
[0m23:44:16.453390 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d"
[0m23:44:16.453722 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6: Close
[0m23:44:16.455007 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."hourly_demand_heatmap"

where not(pickup_hour BETWEEN 0 AND 23)


      
    ) dbt_internal_test
[0m23:44:16.455824 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322 (compile): 23:44:16.442856 => 23:44:16.455514
[0m23:44:16.456523 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322
[0m23:44:16.461149 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322"
[0m23:44:16.463656 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322"
[0m23:44:16.464178 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322: BEGIN
[0m23:44:16.464677 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:44:16.461713 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.468668 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d (execute): 23:44:16.401086 => 23:44:16.468294
[0m23:44:16.462679 [info ] [Thread-3 (]: 15 of 51 PASS dbt_utils_expression_is_true_daily_trip_summary_total_trips___0 .. [[32mPASS[0m in 0.11s]
[0m23:44:16.470949 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6
[0m23:44:16.471622 [debug] [Thread-3 (]: Began running node test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d
[0m23:44:16.470008 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d: ROLLBACK
[0m23:44:16.472080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.475137 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67"
[0m23:44:16.472710 [info ] [Thread-3 (]: 19 of 51 START test dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100  [RUN]
[0m23:44:16.476814 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_daily_trip_summary_total_trips___0.118c022eb6, now test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d)
[0m23:44:16.475811 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."hourly_demand_heatmap"

where not(trip_count > 0)


      
    ) dbt_internal_test
[0m23:44:16.477506 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d
[0m23:44:16.478290 [debug] [Thread-4 (]: On test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d: Close
[0m23:44:16.478853 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.486012 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d"
[0m23:44:16.486479 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.487908 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322"
[0m23:44:16.487435 [info ] [Thread-4 (]: 16 of 51 PASS dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23  [[32mPASS[0m in 0.11s]
[0m23:44:16.488867 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d (compile): 23:44:16.479462 => 23:44:16.488555
[0m23:44:16.490451 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67 (execute): 23:44:16.428191 => 23:44:16.490212
[0m23:44:16.490877 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."payment_analysis"

where not(pct_of_total_trips BETWEEN 0 AND 100)


      
    ) dbt_internal_test
[0m23:44:16.491473 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d
[0m23:44:16.492932 [debug] [Thread-4 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8
[0m23:44:16.492268 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67: ROLLBACK
[0m23:44:16.491877 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d
[0m23:44:16.494360 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.498718 [debug] [Thread-1 (]: On test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67: Close
[0m23:44:16.493608 [info ] [Thread-4 (]: 20 of 51 START test not_null_cleaned_taxi_trips_dropoff_datetime ............... [RUN]
[0m23:44:16.498170 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d"
[0m23:44:16.500712 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322 (execute): 23:44:16.456844 => 23:44:16.500359
[0m23:44:16.502952 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_pickup_hour__BETWEEN_0_AND_23.bd6d19520d, now test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8)
[0m23:44:16.504958 [info ] [Thread-1 (]: 17 of 51 PASS dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0  [[32mPASS[0m in 0.10s]
[0m23:44:16.505758 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322: ROLLBACK
[0m23:44:16.506239 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8
[0m23:44:16.506717 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d"
[0m23:44:16.512990 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d: BEGIN
[0m23:44:16.507181 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67
[0m23:44:16.513528 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:44:16.515362 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8"
[0m23:44:16.515700 [debug] [Thread-2 (]: On test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322: Close
[0m23:44:16.516150 [debug] [Thread-1 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9
[0m23:44:16.520453 [info ] [Thread-1 (]: 21 of 51 START test not_null_cleaned_taxi_trips_fare_amount .................... [RUN]
[0m23:44:16.518154 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8 (compile): 23:44:16.507519 => 23:44:16.517262
[0m23:44:16.522520 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8
[0m23:44:16.519518 [info ] [Thread-2 (]: 18 of 51 PASS dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100  [[32mPASS[0m in 0.08s]
[0m23:44:16.532021 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322
[0m23:44:16.533129 [debug] [Thread-2 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc
[0m23:44:16.521848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_hourly_demand_heatmap_trip_count___0.2fa7e64a67, now test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9)
[0m23:44:16.535218 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9
[0m23:44:16.530328 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8"
[0m23:44:16.541649 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8"
[0m23:44:16.534645 [info ] [Thread-2 (]: 22 of 51 START test not_null_cleaned_taxi_trips_passenger_count ................ [RUN]
[0m23:44:16.542273 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.546992 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d"
[0m23:44:16.543316 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9"
[0m23:44:16.548443 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9 (compile): 23:44:16.535627 => 23:44:16.548107
[0m23:44:16.543902 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8: BEGIN
[0m23:44:16.549608 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:44:16.544733 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_pct_of_total_trips__BETWEEN_0_AND_100.70dfd48322, now test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc)
[0m23:44:16.550367 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc
[0m23:44:16.547627 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "nyc_taxi_dw"."public_gold"."payment_analysis"

where not(tip_frequency_pct BETWEEN 0 AND 100)


      
    ) dbt_internal_test
[0m23:44:16.549026 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9
[0m23:44:16.560591 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9"
[0m23:44:16.561064 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.562227 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc"
[0m23:44:16.562593 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.563088 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9"
[0m23:44:16.564497 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d (execute): 23:44:16.494762 => 23:44:16.564240
[0m23:44:16.565056 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8"
[0m23:44:16.565495 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9: BEGIN
[0m23:44:16.565878 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc (compile): 23:44:16.550888 => 23:44:16.565688
[0m23:44:16.566274 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d: ROLLBACK
[0m23:44:16.566679 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dropoff_datetime
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where dropoff_datetime is null



      
    ) dbt_internal_test
[0m23:44:16.567067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:16.567453 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc
[0m23:44:16.567954 [debug] [Thread-3 (]: On test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d: Close
[0m23:44:16.573073 [info ] [Thread-3 (]: 19 of 51 PASS dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100  [[32mPASS[0m in 0.10s]
[0m23:44:16.574606 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d
[0m23:44:16.573840 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.571925 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc"
[0m23:44:16.578229 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc"
[0m23:44:16.575223 [debug] [Thread-3 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f
[0m23:44:16.579634 [info ] [Thread-3 (]: 23 of 51 START test not_null_cleaned_taxi_trips_payment_type_label ............. [RUN]
[0m23:44:16.580708 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.dbt_utils_expression_is_true_payment_analysis_tip_frequency_pct__BETWEEN_0_AND_100.eb8ea7e35d, now test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f)
[0m23:44:16.577288 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8 (execute): 23:44:16.522949 => 23:44:16.576978
[0m23:44:16.581973 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8: ROLLBACK
[0m23:44:16.579015 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc: BEGIN
[0m23:44:16.582900 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:44:16.583826 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8: Close
[0m23:44:16.581358 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f
[0m23:44:16.595142 [info ] [Thread-4 (]: 20 of 51 PASS not_null_cleaned_taxi_trips_dropoff_datetime ..................... [[32mPASS[0m in 0.09s]
[0m23:44:16.596068 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8
[0m23:44:16.598122 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f"
[0m23:44:16.600809 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f (compile): 23:44:16.584985 => 23:44:16.600448
[0m23:44:16.599735 [debug] [Thread-4 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f
[0m23:44:16.599048 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.603018 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc"
[0m23:44:16.604199 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select passenger_count
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where passenger_count is null



      
    ) dbt_internal_test
[0m23:44:16.602386 [info ] [Thread-4 (]: 24 of 51 START test not_null_cleaned_taxi_trips_pickup_datetime ................ [RUN]
[0m23:44:16.601576 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f
[0m23:44:16.606054 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_dropoff_datetime.38e16127d8, now test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f)
[0m23:44:16.603609 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.613844 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9"
[0m23:44:16.612577 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f"
[0m23:44:16.615867 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f"
[0m23:44:16.615114 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.613212 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f
[0m23:44:16.614474 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select fare_amount
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where fare_amount is null



      
    ) dbt_internal_test
[0m23:44:16.616464 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f: BEGIN
[0m23:44:16.625358 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:44:16.624779 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f"
[0m23:44:16.618622 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc (execute): 23:44:16.568683 => 23:44:16.618278
[0m23:44:16.626752 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc: ROLLBACK
[0m23:44:16.628495 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc: Close
[0m23:44:16.627925 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f (compile): 23:44:16.619009 => 23:44:16.627612
[0m23:44:16.631291 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f
[0m23:44:16.630704 [info ] [Thread-2 (]: 22 of 51 PASS not_null_cleaned_taxi_trips_passenger_count ...................... [[32mPASS[0m in 0.09s]
[0m23:44:16.637689 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc
[0m23:44:16.638226 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.636810 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f"
[0m23:44:16.643482 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f"
[0m23:44:16.641145 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9 (execute): 23:44:16.556329 => 23:44:16.640833
[0m23:44:16.644722 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9: ROLLBACK
[0m23:44:16.644108 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f: BEGIN
[0m23:44:16.638795 [debug] [Thread-2 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2
[0m23:44:16.646072 [info ] [Thread-2 (]: 25 of 51 START test not_null_cleaned_taxi_trips_total_amount ................... [RUN]
[0m23:44:16.646736 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9: Close
[0m23:44:16.645447 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:44:16.647603 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_passenger_count.d399e402fc, now test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2)
[0m23:44:16.652670 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2
[0m23:44:16.651009 [info ] [Thread-1 (]: 21 of 51 PASS not_null_cleaned_taxi_trips_fare_amount .......................... [[32mPASS[0m in 0.13s]
[0m23:44:16.660039 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9
[0m23:44:16.651606 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.661404 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f"
[0m23:44:16.662247 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type_label
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where payment_type_label is null



      
    ) dbt_internal_test
[0m23:44:16.660826 [debug] [Thread-1 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e
[0m23:44:16.664375 [info ] [Thread-1 (]: 26 of 51 START test not_null_cleaned_taxi_trips_trip_distance_miles ............ [RUN]
[0m23:44:16.663659 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2"
[0m23:44:16.667583 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.668381 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f"
[0m23:44:16.667087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_fare_amount.7a24364fc9, now test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e)
[0m23:44:16.670381 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e
[0m23:44:16.669144 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2 (compile): 23:44:16.653440 => 23:44:16.668779
[0m23:44:16.669666 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_datetime
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where pickup_datetime is null



      
    ) dbt_internal_test
[0m23:44:16.675607 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e"
[0m23:44:16.675958 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.676385 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2
[0m23:44:16.678377 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f (execute): 23:44:16.606504 => 23:44:16.678139
[0m23:44:16.678731 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.680961 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2"
[0m23:44:16.681422 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f: ROLLBACK
[0m23:44:16.681927 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e (compile): 23:44:16.670679 => 23:44:16.681698
[0m23:44:16.683205 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f (execute): 23:44:16.631820 => 23:44:16.682992
[0m23:44:16.683866 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2"
[0m23:44:16.684280 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f: Close
[0m23:44:16.684629 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e
[0m23:44:16.685046 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f: ROLLBACK
[0m23:44:16.685460 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2: BEGIN
[0m23:44:16.686500 [info ] [Thread-3 (]: 23 of 51 PASS not_null_cleaned_taxi_trips_payment_type_label ................... [[32mPASS[0m in 0.11s]
[0m23:44:16.690290 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e"
[0m23:44:16.690930 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:44:16.691363 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f: Close
[0m23:44:16.694538 [info ] [Thread-4 (]: 24 of 51 PASS not_null_cleaned_taxi_trips_pickup_datetime ...................... [[32mPASS[0m in 0.09s]
[0m23:44:16.696154 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f
[0m23:44:16.692074 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f
[0m23:44:16.697627 [debug] [Thread-3 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e
[0m23:44:16.693512 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e"
[0m23:44:16.698823 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e: BEGIN
[0m23:44:16.699392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:16.696961 [debug] [Thread-4 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493
[0m23:44:16.700248 [info ] [Thread-4 (]: 27 of 51 START test not_null_cleaned_taxi_trips_trip_duration_mins ............. [RUN]
[0m23:44:16.698271 [info ] [Thread-3 (]: 28 of 51 START test not_null_cleaned_taxi_trips_trip_id ........................ [RUN]
[0m23:44:16.704664 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_payment_type_label.aed0656a2f, now test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e)
[0m23:44:16.708578 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e
[0m23:44:16.701937 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_pickup_datetime.081c499d5f, now test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493)
[0m23:44:16.715753 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493
[0m23:44:16.719987 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e"
[0m23:44:16.727531 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e (compile): 23:44:16.708913 => 23:44:16.727200
[0m23:44:16.728107 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e
[0m23:44:16.726607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.732287 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e"
[0m23:44:16.726120 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.725624 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493"
[0m23:44:16.734280 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493 (compile): 23:44:16.720282 => 23:44:16.733974
[0m23:44:16.732865 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_distance_miles
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where trip_distance_miles is null



      
    ) dbt_internal_test
[0m23:44:16.731730 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e"
[0m23:44:16.733433 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2"
[0m23:44:16.735712 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_amount
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where total_amount is null



      
    ) dbt_internal_test
[0m23:44:16.734816 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493
[0m23:44:16.736521 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e"
[0m23:44:16.742187 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e: BEGIN
[0m23:44:16.742791 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:44:16.741566 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493"
[0m23:44:16.744442 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493"
[0m23:44:16.745008 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493: BEGIN
[0m23:44:16.746028 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:44:16.748698 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.755852 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e (execute): 23:44:16.686930 => 23:44:16.755520
[0m23:44:16.758093 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e: ROLLBACK
[0m23:44:16.764641 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e: Close
[0m23:44:16.765749 [info ] [Thread-1 (]: 26 of 51 PASS not_null_cleaned_taxi_trips_trip_distance_miles .................. [[32mPASS[0m in 0.10s]
[0m23:44:16.767088 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e
[0m23:44:16.767684 [debug] [Thread-1 (]: Began running node test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5
[0m23:44:16.759923 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.758762 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.770652 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e"
[0m23:44:16.759431 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.770085 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2 (execute): 23:44:16.678989 => 23:44:16.769755
[0m23:44:16.768176 [info ] [Thread-1 (]: 29 of 51 START test not_null_cleaned_taxi_trips_vendor_id ...................... [RUN]
[0m23:44:16.771650 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_id
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where trip_id is null



      
    ) dbt_internal_test
[0m23:44:16.772165 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493"
[0m23:44:16.772647 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2: ROLLBACK
[0m23:44:16.773525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_trip_distance_miles.fb40a1356e, now test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5)
[0m23:44:16.776556 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.777085 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_duration_mins
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where trip_duration_mins is null



      
    ) dbt_internal_test
[0m23:44:16.777678 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5
[0m23:44:16.777991 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2: Close
[0m23:44:16.779289 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e (execute): 23:44:16.728475 => 23:44:16.779080
[0m23:44:16.786002 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e: ROLLBACK
[0m23:44:16.785527 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.785068 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5"
[0m23:44:16.788754 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493 (execute): 23:44:16.736958 => 23:44:16.788545
[0m23:44:16.787101 [info ] [Thread-2 (]: 25 of 51 PASS not_null_cleaned_taxi_trips_total_amount ......................... [[32mPASS[0m in 0.14s]
[0m23:44:16.789312 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e: Close
[0m23:44:16.789805 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493: ROLLBACK
[0m23:44:16.790182 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5 (compile): 23:44:16.779657 => 23:44:16.789998
[0m23:44:16.792409 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5
[0m23:44:16.793124 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493: Close
[0m23:44:16.790717 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2
[0m23:44:16.797784 [debug] [Thread-2 (]: Began running node test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795
[0m23:44:16.791734 [info ] [Thread-3 (]: 28 of 51 PASS not_null_cleaned_taxi_trips_trip_id .............................. [[32mPASS[0m in 0.09s]
[0m23:44:16.799290 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e
[0m23:44:16.799855 [debug] [Thread-3 (]: Began running node test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff
[0m23:44:16.796998 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5"
[0m23:44:16.798473 [info ] [Thread-2 (]: 30 of 51 START test not_null_daily_trip_summary_avg_duration_mins .............. [RUN]
[0m23:44:16.800306 [info ] [Thread-3 (]: 31 of 51 START test not_null_daily_trip_summary_avg_fare_per_trip .............. [RUN]
[0m23:44:16.801733 [info ] [Thread-4 (]: 27 of 51 PASS not_null_cleaned_taxi_trips_trip_duration_mins ................... [[32mPASS[0m in 0.10s]
[0m23:44:16.802877 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_total_amount.fe8dbfcbc2, now test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795)
[0m23:44:16.803611 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_trip_id.2c7c86ea9e, now test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff)
[0m23:44:16.803972 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5"
[0m23:44:16.806201 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5: BEGIN
[0m23:44:16.804976 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795
[0m23:44:16.805575 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff
[0m23:44:16.804555 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493
[0m23:44:16.816687 [debug] [Thread-4 (]: Began running node test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f
[0m23:44:16.816108 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff"
[0m23:44:16.806932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:16.817220 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795"
[0m23:44:16.819736 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795 (compile): 23:44:16.807332 => 23:44:16.819418
[0m23:44:16.821100 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795
[0m23:44:16.817912 [info ] [Thread-4 (]: 32 of 51 START test not_null_daily_trip_summary_payment_type_label ............. [RUN]
[0m23:44:16.829722 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_trip_duration_mins.ba235d2493, now test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f)
[0m23:44:16.830304 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f
[0m23:44:16.820363 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff (compile): 23:44:16.812525 => 23:44:16.820074
[0m23:44:16.836191 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff
[0m23:44:16.828776 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795"
[0m23:44:16.839762 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff"
[0m23:44:16.842742 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f"
[0m23:44:16.843480 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795"
[0m23:44:16.845107 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795: BEGIN
[0m23:44:16.845502 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:44:16.844177 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff"
[0m23:44:16.844669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.846011 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f (compile): 23:44:16.830697 => 23:44:16.845791
[0m23:44:16.846641 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff: BEGIN
[0m23:44:16.848372 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:44:16.847795 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f
[0m23:44:16.847217 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5"
[0m23:44:16.853308 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f"
[0m23:44:16.853974 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where vendor_id is null



      
    ) dbt_internal_test
[0m23:44:16.854855 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.855682 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795"
[0m23:44:16.856206 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_duration_mins
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where avg_duration_mins is null



      
    ) dbt_internal_test
[0m23:44:16.857111 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f"
[0m23:44:16.860010 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f: BEGIN
[0m23:44:16.860567 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:44:16.863514 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.866021 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795 (execute): 23:44:16.821927 => 23:44:16.865679
[0m23:44:16.866548 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.867772 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff"
[0m23:44:16.868315 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_fare_per_trip
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where avg_fare_per_trip is null



      
    ) dbt_internal_test
[0m23:44:16.867138 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795: ROLLBACK
[0m23:44:16.869574 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795: Close
[0m23:44:16.871498 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.873298 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5 (execute): 23:44:16.793453 => 23:44:16.873007
[0m23:44:16.873836 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.870822 [info ] [Thread-2 (]: 30 of 51 PASS not_null_daily_trip_summary_avg_duration_mins .................... [[32mPASS[0m in 0.07s]
[0m23:44:16.874458 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5: ROLLBACK
[0m23:44:16.877699 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.876980 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795
[0m23:44:16.876079 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff (execute): 23:44:16.836608 => 23:44:16.875859
[0m23:44:16.878627 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f"
[0m23:44:16.879301 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5: Close
[0m23:44:16.879725 [debug] [Thread-2 (]: Began running node test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793
[0m23:44:16.881169 [info ] [Thread-2 (]: 33 of 51 START test not_null_daily_trip_summary_pickup_date .................... [RUN]
[0m23:44:16.880594 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type_label
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where payment_type_label is null



      
    ) dbt_internal_test
[0m23:44:16.880186 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff: ROLLBACK
[0m23:44:16.883252 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_daily_trip_summary_avg_duration_mins.3ccdf4b795, now test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793)
[0m23:44:16.883983 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793
[0m23:44:16.882435 [warn ] [Thread-1 (]: 29 of 51 WARN 9103 not_null_cleaned_taxi_trips_vendor_id ....................... [[33mWARN 9103[0m in 0.11s]
[0m23:44:16.888328 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793"
[0m23:44:16.890605 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793 (compile): 23:44:16.884327 => 23:44:16.890263
[0m23:44:16.891246 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793
[0m23:44:16.889696 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5
[0m23:44:16.888783 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff: Close
[0m23:44:16.889102 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:16.893776 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793"
[0m23:44:16.897107 [info ] [Thread-3 (]: 31 of 51 PASS not_null_daily_trip_summary_avg_fare_per_trip .................... [[32mPASS[0m in 0.09s]
[0m23:44:16.896245 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f (execute): 23:44:16.849171 => 23:44:16.895947
[0m23:44:16.894282 [debug] [Thread-1 (]: Began running node test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d
[0m23:44:16.897916 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff
[0m23:44:16.898440 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f: ROLLBACK
[0m23:44:16.898814 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793"
[0m23:44:16.899233 [info ] [Thread-1 (]: 34 of 51 START test not_null_daily_trip_summary_summary_id ..................... [RUN]
[0m23:44:16.899817 [debug] [Thread-3 (]: Began running node test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3
[0m23:44:16.900409 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793: BEGIN
[0m23:44:16.900824 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f: Close
[0m23:44:16.901397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_cleaned_taxi_trips_vendor_id.59f76dcca5, now test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d)
[0m23:44:16.904021 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d
[0m23:44:16.902325 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:44:16.903374 [info ] [Thread-4 (]: 32 of 51 PASS not_null_daily_trip_summary_payment_type_label ................... [[32mPASS[0m in 0.07s]
[0m23:44:16.901818 [info ] [Thread-3 (]: 35 of 51 START test not_null_daily_trip_summary_total_revenue .................. [RUN]
[0m23:44:16.911703 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_daily_trip_summary_avg_fare_per_trip.d40a47d6ff, now test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3)
[0m23:44:16.910113 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f
[0m23:44:16.909122 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d"
[0m23:44:16.913174 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3
[0m23:44:16.913868 [debug] [Thread-4 (]: Began running node test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd
[0m23:44:16.914863 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d (compile): 23:44:16.904476 => 23:44:16.914537
[0m23:44:16.923583 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d
[0m23:44:16.989659 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d"
[0m23:44:16.990712 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d"
[0m23:44:16.991862 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d: BEGIN
[0m23:44:16.992391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:16.922895 [info ] [Thread-4 (]: 36 of 51 START test not_null_daily_trip_summary_total_trips .................... [RUN]
[0m23:44:16.991259 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3"
[0m23:44:16.994419 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3 (compile): 23:44:16.915143 => 23:44:16.994095
[0m23:44:16.995436 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3
[0m23:44:16.993556 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_daily_trip_summary_payment_type_label.86e51a291f, now test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd)
[0m23:44:16.994954 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:16.999095 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3"
[0m23:44:16.999683 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd
[0m23:44:17.000289 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793"
[0m23:44:17.000753 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.004784 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd"
[0m23:44:17.005268 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3"
[0m23:44:17.005633 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_date
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where pickup_date is null



      
    ) dbt_internal_test
[0m23:44:17.006032 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d"
[0m23:44:17.008102 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select summary_id
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where summary_id is null



      
    ) dbt_internal_test
[0m23:44:17.007042 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3: BEGIN
[0m23:44:17.009960 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:44:17.007649 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd (compile): 23:44:17.001095 => 23:44:17.007412
[0m23:44:17.010748 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd
[0m23:44:17.009430 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.015796 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.019897 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d (execute): 23:44:16.923956 => 23:44:17.019563
[0m23:44:17.015275 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd"
[0m23:44:17.023970 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd"
[0m23:44:17.024487 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd: BEGIN
[0m23:44:17.024978 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:44:17.017848 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793 (execute): 23:44:16.891642 => 23:44:17.017532
[0m23:44:17.025713 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793: ROLLBACK
[0m23:44:17.026299 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793: Close
[0m23:44:17.023233 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d: ROLLBACK
[0m23:44:17.030260 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.030764 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3"
[0m23:44:17.031980 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_revenue
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where total_revenue is null



      
    ) dbt_internal_test
[0m23:44:17.032764 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d: Close
[0m23:44:17.029543 [info ] [Thread-2 (]: 33 of 51 PASS not_null_daily_trip_summary_pickup_date .......................... [[32mPASS[0m in 0.15s]
[0m23:44:17.037905 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793
[0m23:44:17.034735 [info ] [Thread-1 (]: 34 of 51 PASS not_null_daily_trip_summary_summary_id ........................... [[32mPASS[0m in 0.13s]
[0m23:44:17.041568 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d
[0m23:44:17.042126 [debug] [Thread-1 (]: Began running node test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb
[0m23:44:17.038881 [debug] [Thread-2 (]: Began running node test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c
[0m23:44:17.043943 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.046396 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3 (execute): 23:44:16.995799 => 23:44:17.046039
[0m23:44:17.042695 [info ] [Thread-1 (]: 38 of 51 START test not_null_hourly_demand_heatmap_pickup_hour ................. [RUN]
[0m23:44:17.048621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_daily_trip_summary_summary_id.3a22de7e1d, now test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb)
[0m23:44:17.043517 [info ] [Thread-2 (]: 37 of 51 START test not_null_daily_trip_summary_vendor_name .................... [RUN]
[0m23:44:17.050833 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_daily_trip_summary_pickup_date.8a5c7d8793, now test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c)
[0m23:44:17.051613 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c
[0m23:44:17.047563 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3: ROLLBACK
[0m23:44:17.049988 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.057679 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd"
[0m23:44:17.058211 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_trips
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where total_trips is null



      
    ) dbt_internal_test
[0m23:44:17.059689 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3: Close
[0m23:44:17.061449 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.049196 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb
[0m23:44:17.063385 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd (execute): 23:44:17.011079 => 23:44:17.063052
[0m23:44:17.065042 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c"
[0m23:44:17.060794 [info ] [Thread-3 (]: 35 of 51 PASS not_null_daily_trip_summary_total_revenue ........................ [[32mPASS[0m in 0.15s]
[0m23:44:17.070457 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb"
[0m23:44:17.070940 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd: ROLLBACK
[0m23:44:17.071594 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c (compile): 23:44:17.051920 => 23:44:17.071358
[0m23:44:17.072053 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3
[0m23:44:17.072721 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb (compile): 23:44:17.065521 => 23:44:17.072497
[0m23:44:17.073151 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c
[0m23:44:17.073471 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd: Close
[0m23:44:17.073906 [debug] [Thread-3 (]: Began running node test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2
[0m23:44:17.074360 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb
[0m23:44:17.077587 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c"
[0m23:44:17.078670 [info ] [Thread-4 (]: 36 of 51 PASS not_null_daily_trip_summary_total_trips .......................... [[32mPASS[0m in 0.09s]
[0m23:44:17.081858 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb"
[0m23:44:17.079292 [info ] [Thread-3 (]: 39 of 51 START test not_null_hourly_demand_heatmap_trip_count .................. [RUN]
[0m23:44:17.082668 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd
[0m23:44:17.083599 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_daily_trip_summary_total_revenue.58c30ec7b3, now test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2)
[0m23:44:17.083953 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c"
[0m23:44:17.084425 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb"
[0m23:44:17.084815 [debug] [Thread-4 (]: Began running node test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569
[0m23:44:17.085303 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2
[0m23:44:17.085700 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c: BEGIN
[0m23:44:17.086197 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb: BEGIN
[0m23:44:17.093926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:17.086899 [info ] [Thread-4 (]: 40 of 51 START test not_null_payment_analysis_payment_type_label ............... [RUN]
[0m23:44:17.092693 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2"
[0m23:44:17.093321 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:44:17.097958 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2 (compile): 23:44:17.087474 => 23:44:17.097627
[0m23:44:17.095391 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_daily_trip_summary_total_trips.b11ec7ddcd, now test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569)
[0m23:44:17.099461 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569
[0m23:44:17.098825 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2
[0m23:44:17.108793 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2"
[0m23:44:17.109522 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.109939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.110494 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569"
[0m23:44:17.110818 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c"
[0m23:44:17.111238 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb"
[0m23:44:17.111893 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569 (compile): 23:44:17.099776 => 23:44:17.111662
[0m23:44:17.112359 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2"
[0m23:44:17.112701 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_name
from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where vendor_name is null



      
    ) dbt_internal_test
[0m23:44:17.113112 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_hour
from "nyc_taxi_dw"."public_gold"."hourly_demand_heatmap"
where pickup_hour is null



      
    ) dbt_internal_test
[0m23:44:17.113521 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569
[0m23:44:17.113889 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2: BEGIN
[0m23:44:17.117769 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:44:17.118654 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.117245 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569"
[0m23:44:17.126110 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569"
[0m23:44:17.126768 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569: BEGIN
[0m23:44:17.119827 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.122701 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb (execute): 23:44:17.079823 => 23:44:17.122392
[0m23:44:17.130008 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb: ROLLBACK
[0m23:44:17.127323 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:44:17.129311 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c (execute): 23:44:17.074607 => 23:44:17.129017
[0m23:44:17.132906 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c: ROLLBACK
[0m23:44:17.132212 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.130837 [debug] [Thread-1 (]: On test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb: Close
[0m23:44:17.137057 [info ] [Thread-1 (]: 38 of 51 PASS not_null_hourly_demand_heatmap_pickup_hour ....................... [[32mPASS[0m in 0.09s]
[0m23:44:17.134173 [debug] [Thread-2 (]: On test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c: Close
[0m23:44:17.138276 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb
[0m23:44:17.133583 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2"
[0m23:44:17.140202 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.142995 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569"
[0m23:44:17.141524 [debug] [Thread-1 (]: Began running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325
[0m23:44:17.139647 [info ] [Thread-2 (]: 37 of 51 PASS not_null_daily_trip_summary_vendor_name .......................... [[32mPASS[0m in 0.09s]
[0m23:44:17.142045 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_count
from "nyc_taxi_dw"."public_gold"."hourly_demand_heatmap"
where trip_count is null



      
    ) dbt_internal_test
[0m23:44:17.144408 [info ] [Thread-1 (]: 41 of 51 START test source_not_null_bronze_raw_taxi_trips_batch_id ............. [RUN]
[0m23:44:17.146659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_hourly_demand_heatmap_pickup_hour.934ec823fb, now test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325)
[0m23:44:17.145241 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c
[0m23:44:17.143747 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type_label
from "nyc_taxi_dw"."public_gold"."payment_analysis"
where payment_type_label is null



      
    ) dbt_internal_test
[0m23:44:17.147303 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.149134 [debug] [Thread-2 (]: Began running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9
[0m23:44:17.148328 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325
[0m23:44:17.154258 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.155176 [info ] [Thread-2 (]: 42 of 51 START test source_not_null_bronze_raw_taxi_trips_ingested_at .......... [RUN]
[0m23:44:17.153591 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2 (execute): 23:44:17.106601 => 23:44:17.152117
[0m23:44:17.163768 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569 (execute): 23:44:17.114352 => 23:44:17.163424
[0m23:44:17.168564 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569: ROLLBACK
[0m23:44:17.169272 [debug] [Thread-4 (]: On test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569: Close
[0m23:44:17.166304 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325"
[0m23:44:17.167194 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_daily_trip_summary_vendor_name.37e4743f2c, now test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9)
[0m23:44:17.170173 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9
[0m23:44:17.167953 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2: ROLLBACK
[0m23:44:17.172078 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325 (compile): 23:44:17.155597 => 23:44:17.171785
[0m23:44:17.171194 [info ] [Thread-4 (]: 40 of 51 PASS not_null_payment_analysis_payment_type_label ..................... [[32mPASS[0m in 0.08s]
[0m23:44:17.176410 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9"
[0m23:44:17.177055 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325
[0m23:44:17.177394 [debug] [Thread-3 (]: On test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2: Close
[0m23:44:17.177976 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569
[0m23:44:17.181052 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325"
[0m23:44:17.181634 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9 (compile): 23:44:17.172514 => 23:44:17.181404
[0m23:44:17.183853 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9
[0m23:44:17.183297 [info ] [Thread-3 (]: 39 of 51 PASS not_null_hourly_demand_heatmap_trip_count ........................ [[32mPASS[0m in 0.10s]
[0m23:44:17.182168 [debug] [Thread-4 (]: Began running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae
[0m23:44:17.186413 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9"
[0m23:44:17.188988 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9"
[0m23:44:17.189523 [debug] [Thread-2 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9: BEGIN
[0m23:44:17.190009 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:44:17.188155 [info ] [Thread-4 (]: 43 of 51 START test source_not_null_bronze_raw_taxi_trips_ingestion_id ......... [RUN]
[0m23:44:17.186956 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325"
[0m23:44:17.191989 [debug] [Thread-1 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325: BEGIN
[0m23:44:17.192468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:17.187592 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2
[0m23:44:17.193315 [debug] [Thread-3 (]: Began running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505
[0m23:44:17.193878 [info ] [Thread-3 (]: 44 of 51 START test source_not_null_bronze_raw_taxi_trips_total_amount ......... [RUN]
[0m23:44:17.191289 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_payment_analysis_payment_type_label.6ffc894569, now test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae)
[0m23:44:17.196432 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae
[0m23:44:17.195128 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_hourly_demand_heatmap_trip_count.2bd8cb94d2, now test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505)
[0m23:44:17.202675 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505
[0m23:44:17.212157 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae"
[0m23:44:17.213609 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae (compile): 23:44:17.196800 => 23:44:17.213239
[0m23:44:17.214322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.215250 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505"
[0m23:44:17.218456 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505 (compile): 23:44:17.203011 => 23:44:17.218124
[0m23:44:17.216242 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.219514 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9"
[0m23:44:17.215909 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae
[0m23:44:17.217281 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325"
[0m23:44:17.224599 [debug] [Thread-1 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select batch_id
from "nyc_taxi_dw"."bronze"."raw_taxi_trips"
where batch_id is null



      
    ) dbt_internal_test
[0m23:44:17.220135 [debug] [Thread-2 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingested_at
from "nyc_taxi_dw"."bronze"."raw_taxi_trips"
where ingested_at is null



      
    ) dbt_internal_test
[0m23:44:17.218949 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505
[0m23:44:17.223953 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae"
[0m23:44:17.230298 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.229820 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505"
[0m23:44:17.232618 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325 (execute): 23:44:17.178420 => 23:44:17.232192
[0m23:44:17.233116 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.235762 [debug] [Thread-1 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325: ROLLBACK
[0m23:44:17.235144 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505"
[0m23:44:17.234059 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae"
[0m23:44:17.238721 [debug] [Thread-1 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325: Close
[0m23:44:17.237974 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9 (execute): 23:44:17.184347 => 23:44:17.237666
[0m23:44:17.239200 [debug] [Thread-3 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505: BEGIN
[0m23:44:17.239658 [debug] [Thread-4 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae: BEGIN
[0m23:44:17.240688 [info ] [Thread-1 (]: 41 of 51 PASS source_not_null_bronze_raw_taxi_trips_batch_id ................... [[32mPASS[0m in 0.09s]
[0m23:44:17.241449 [debug] [Thread-2 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9: ROLLBACK
[0m23:44:17.241946 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:44:17.242501 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:44:17.243048 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325
[0m23:44:17.243547 [debug] [Thread-2 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9: Close
[0m23:44:17.246191 [info ] [Thread-2 (]: 42 of 51 PASS source_not_null_bronze_raw_taxi_trips_ingested_at ................ [[32mPASS[0m in 0.08s]
[0m23:44:17.246988 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9
[0m23:44:17.244603 [debug] [Thread-1 (]: Began running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6
[0m23:44:17.249649 [debug] [Thread-2 (]: Began running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a
[0m23:44:17.251418 [info ] [Thread-1 (]: 45 of 51 START test source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime  [RUN]
[0m23:44:17.253697 [info ] [Thread-2 (]: 46 of 51 START test source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime . [RUN]
[0m23:44:17.257751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_batch_id.7cb41b1325, now test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6)
[0m23:44:17.263741 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6
[0m23:44:17.260628 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingested_at.0527552ca9, now test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a)
[0m23:44:17.272852 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a
[0m23:44:17.271130 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6"
[0m23:44:17.272481 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.272023 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.278654 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a"
[0m23:44:17.279285 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae"
[0m23:44:17.279716 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6 (compile): 23:44:17.264395 => 23:44:17.279513
[0m23:44:17.280094 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505"
[0m23:44:17.280681 [debug] [Thread-4 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ingestion_id
from "nyc_taxi_dw"."bronze"."raw_taxi_trips"
where ingestion_id is null



      
    ) dbt_internal_test
[0m23:44:17.281140 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6
[0m23:44:17.281530 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a (compile): 23:44:17.273072 => 23:44:17.281328
[0m23:44:17.281926 [debug] [Thread-3 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_amount
from "nyc_taxi_dw"."bronze"."raw_taxi_trips"
where total_amount is null



      
    ) dbt_internal_test
[0m23:44:17.284849 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6"
[0m23:44:17.285291 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.285669 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a
[0m23:44:17.288698 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6"
[0m23:44:17.288196 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae (execute): 23:44:17.220642 => 23:44:17.287893
[0m23:44:17.291097 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a"
[0m23:44:17.293424 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a"
[0m23:44:17.291835 [debug] [Thread-1 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6: BEGIN
[0m23:44:17.292482 [debug] [Thread-4 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae: ROLLBACK
[0m23:44:17.291447 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.294210 [debug] [Thread-2 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a: BEGIN
[0m23:44:17.294701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:17.296903 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505 (execute): 23:44:17.225248 => 23:44:17.296564
[0m23:44:17.297497 [debug] [Thread-4 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae: Close
[0m23:44:17.297821 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:44:17.298478 [debug] [Thread-3 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505: ROLLBACK
[0m23:44:17.299559 [info ] [Thread-4 (]: 43 of 51 PASS source_not_null_bronze_raw_taxi_trips_ingestion_id ............... [[32mPASS[0m in 0.11s]
[0m23:44:17.302146 [debug] [Thread-3 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505: Close
[0m23:44:17.303028 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae
[0m23:44:17.306310 [info ] [Thread-3 (]: 44 of 51 PASS source_not_null_bronze_raw_taxi_trips_total_amount ............... [[32mPASS[0m in 0.11s]
[0m23:44:17.311295 [debug] [Thread-4 (]: Began running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935
[0m23:44:17.312603 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505
[0m23:44:17.314321 [debug] [Thread-3 (]: Began running node test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b
[0m23:44:17.313685 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.315053 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.313210 [info ] [Thread-4 (]: 47 of 51 START test source_not_null_bronze_raw_taxi_trips_vendor_id ............ [RUN]
[0m23:44:17.315460 [info ] [Thread-3 (]: 48 of 51 START test source_unique_bronze_raw_taxi_trips_ingestion_id ........... [RUN]
[0m23:44:17.318474 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_total_amount.80bfa9d505, now test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b)
[0m23:44:17.316606 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6"
[0m23:44:17.319762 [debug] [Thread-1 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tpep_dropoff_datetime
from "nyc_taxi_dw"."bronze"."raw_taxi_trips"
where tpep_dropoff_datetime is null



      
    ) dbt_internal_test
[0m23:44:17.316141 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a"
[0m23:44:17.320541 [debug] [Thread-2 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tpep_pickup_datetime
from "nyc_taxi_dw"."bronze"."raw_taxi_trips"
where tpep_pickup_datetime is null



      
    ) dbt_internal_test
[0m23:44:17.317487 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_ingestion_id.14d7affcae, now test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935)
[0m23:44:17.319107 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b
[0m23:44:17.321276 [debug] [Thread-4 (]: Began compiling node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935
[0m23:44:17.328718 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.339232 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b"
[0m23:44:17.336643 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.341285 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a (execute): 23:44:17.289059 => 23:44:17.340932
[0m23:44:17.343875 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6 (execute): 23:44:17.282273 => 23:44:17.343580
[0m23:44:17.341687 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935"
[0m23:44:17.344509 [debug] [Thread-2 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a: ROLLBACK
[0m23:44:17.344995 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b (compile): 23:44:17.321677 => 23:44:17.344775
[0m23:44:17.345306 [debug] [Thread-1 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6: ROLLBACK
[0m23:44:17.346013 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935 (compile): 23:44:17.329111 => 23:44:17.345782
[0m23:44:17.347693 [debug] [Thread-4 (]: Began executing node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935
[0m23:44:17.346670 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b
[0m23:44:17.347153 [debug] [Thread-1 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6: Close
[0m23:44:17.346302 [debug] [Thread-2 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a: Close
[0m23:44:17.351821 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935"
[0m23:44:17.360876 [info ] [Thread-1 (]: 45 of 51 PASS source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime ...... [[32mPASS[0m in 0.11s]
[0m23:44:17.358540 [info ] [Thread-2 (]: 46 of 51 PASS source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime ....... [[32mPASS[0m in 0.10s]
[0m23:44:17.362074 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935"
[0m23:44:17.359545 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b"
[0m23:44:17.366881 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b"
[0m23:44:17.367604 [debug] [Thread-3 (]: On test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b: BEGIN
[0m23:44:17.365324 [debug] [Thread-4 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935: BEGIN
[0m23:44:17.368757 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:44:17.363443 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6
[0m23:44:17.368202 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:44:17.364532 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a
[0m23:44:17.369950 [debug] [Thread-1 (]: Began running node test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986
[0m23:44:17.372132 [debug] [Thread-2 (]: Began running node test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc
[0m23:44:17.373621 [info ] [Thread-1 (]: 49 of 51 START test unique_cleaned_taxi_trips_trip_id .......................... [RUN]
[0m23:44:17.376058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_dropoff_datetime.80bdd798b6, now test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986)
[0m23:44:17.374361 [info ] [Thread-2 (]: 50 of 51 START test unique_daily_trip_summary_summary_id ....................... [RUN]
[0m23:44:17.380003 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_tpep_pickup_datetime.d257ed524a, now test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc)
[0m23:44:17.377745 [debug] [Thread-1 (]: Began compiling node test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986
[0m23:44:17.380843 [debug] [Thread-2 (]: Began compiling node test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc
[0m23:44:17.394556 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc"
[0m23:44:17.396783 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986"
[0m23:44:17.397231 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.397569 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.398248 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986 (compile): 23:44:17.381850 => 23:44:17.398015
[0m23:44:17.398565 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b"
[0m23:44:17.398904 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc (compile): 23:44:17.389094 => 23:44:17.398734
[0m23:44:17.399255 [debug] [Thread-4 (]: Using postgres connection "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935"
[0m23:44:17.399643 [debug] [Thread-1 (]: Began executing node test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986
[0m23:44:17.400030 [debug] [Thread-3 (]: On test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ingestion_id as unique_field,
    count(*) as n_records

from "nyc_taxi_dw"."bronze"."raw_taxi_trips"
where ingestion_id is not null
group by ingestion_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:44:17.400434 [debug] [Thread-2 (]: Began executing node test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc
[0m23:44:17.400842 [debug] [Thread-4 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from "nyc_taxi_dw"."bronze"."raw_taxi_trips"
where vendor_id is null



      
    ) dbt_internal_test
[0m23:44:17.403106 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986"
[0m23:44:17.411425 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc"
[0m23:44:17.412225 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986"
[0m23:44:17.412688 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.413064 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.413598 [debug] [Thread-1 (]: On test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986: BEGIN
[0m23:44:17.415015 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b (execute): 23:44:17.352224 => 23:44:17.414801
[0m23:44:17.415493 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc"
[0m23:44:17.420738 [debug] [Thread-2 (]: On test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc: BEGIN
[0m23:44:17.418970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:17.422588 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:44:17.416844 [debug] [Thread-4 (]: Timing info for test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935 (execute): 23:44:17.348034 => 23:44:17.416555
[0m23:44:17.423760 [debug] [Thread-4 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935: ROLLBACK
[0m23:44:17.419610 [debug] [Thread-3 (]: On test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b: ROLLBACK
[0m23:44:17.424779 [debug] [Thread-3 (]: On test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b: Close
[0m23:44:17.425296 [debug] [Thread-4 (]: On test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935: Close
[0m23:44:17.426646 [info ] [Thread-3 (]: 48 of 51 PASS source_unique_bronze_raw_taxi_trips_ingestion_id ................. [[32mPASS[0m in 0.11s]
[0m23:44:17.431048 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b
[0m23:44:17.432769 [debug] [Thread-3 (]: Began running node test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b
[0m23:44:17.427732 [warn ] [Thread-4 (]: 47 of 51 WARN 10000 source_not_null_bronze_raw_taxi_trips_vendor_id ............ [[33mWARN 10000[0m in 0.11s]
[0m23:44:17.435721 [debug] [Thread-4 (]: Finished running node test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935
[0m23:44:17.434591 [info ] [Thread-3 (]: 51 of 51 START test unique_payment_analysis_payment_type_label ................. [RUN]
[0m23:44:17.437424 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.439951 [debug] [Thread-2 (]: Using postgres connection "test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc"
[0m23:44:17.438806 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_taxi.source_unique_bronze_raw_taxi_trips_ingestion_id.b1aa8b427b, now test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b)
[0m23:44:17.441281 [debug] [Thread-3 (]: Began compiling node test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b
[0m23:44:17.440644 [debug] [Thread-2 (]: On test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    summary_id as unique_field,
    count(*) as n_records

from "nyc_taxi_dw"."public_gold"."daily_trip_summary"
where summary_id is not null
group by summary_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:44:17.439397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.447831 [debug] [Thread-1 (]: Using postgres connection "test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986"
[0m23:44:17.448413 [debug] [Thread-1 (]: On test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "nyc_taxi_dw"."public_silver"."cleaned_taxi_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:44:17.450584 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.447278 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b"
[0m23:44:17.453602 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b (compile): 23:44:17.441599 => 23:44:17.453268
[0m23:44:17.452765 [debug] [Thread-2 (]: Timing info for test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc (execute): 23:44:17.403608 => 23:44:17.452455
[0m23:44:17.454661 [debug] [Thread-2 (]: On test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc: ROLLBACK
[0m23:44:17.454128 [debug] [Thread-3 (]: Began executing node test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b
[0m23:44:17.458329 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b"
[0m23:44:17.458754 [debug] [Thread-2 (]: On test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc: Close
[0m23:44:17.459893 [info ] [Thread-2 (]: 50 of 51 PASS unique_daily_trip_summary_summary_id ............................. [[32mPASS[0m in 0.08s]
[0m23:44:17.461355 [debug] [Thread-2 (]: Finished running node test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc
[0m23:44:17.460631 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b"
[0m23:44:17.461833 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.462400 [debug] [Thread-3 (]: On test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b: BEGIN
[0m23:44:17.464487 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:44:17.463976 [debug] [Thread-1 (]: Timing info for test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986 (execute): 23:44:17.401100 => 23:44:17.463649
[0m23:44:17.465402 [debug] [Thread-1 (]: On test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986: ROLLBACK
[0m23:44:17.466281 [debug] [Thread-1 (]: On test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986: Close
[0m23:44:17.467721 [info ] [Thread-1 (]: 49 of 51 PASS unique_cleaned_taxi_trips_trip_id ................................ [[32mPASS[0m in 0.09s]
[0m23:44:17.471126 [debug] [Thread-1 (]: Finished running node test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986
[0m23:44:17.475176 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.475875 [debug] [Thread-3 (]: Using postgres connection "test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b"
[0m23:44:17.476469 [debug] [Thread-3 (]: On test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "nyc_taxi", "target_name": "prod", "node_id": "test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_type_label as unique_field,
    count(*) as n_records

from "nyc_taxi_dw"."public_gold"."payment_analysis"
where payment_type_label is not null
group by payment_type_label
having count(*) > 1



      
    ) dbt_internal_test
[0m23:44:17.477977 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:44:17.480065 [debug] [Thread-3 (]: Timing info for test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b (execute): 23:44:17.455073 => 23:44:17.479666
[0m23:44:17.480602 [debug] [Thread-3 (]: On test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b: ROLLBACK
[0m23:44:17.481062 [debug] [Thread-3 (]: On test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b: Close
[0m23:44:17.482182 [info ] [Thread-3 (]: 51 of 51 PASS unique_payment_analysis_payment_type_label ....................... [[32mPASS[0m in 0.04s]
[0m23:44:17.483012 [debug] [Thread-3 (]: Finished running node test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b
[0m23:44:17.485199 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:17.485582 [debug] [MainThread]: On master: BEGIN
[0m23:44:17.485899 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:44:17.491065 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:44:17.491614 [debug] [MainThread]: On master: COMMIT
[0m23:44:17.491992 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:17.492289 [debug] [MainThread]: On master: COMMIT
[0m23:44:17.492704 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:44:17.493012 [debug] [MainThread]: On master: Close
[0m23:44:17.493809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:17.494221 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_cleaned_taxi_trips_trip_id.4e673fa986' was properly closed.
[0m23:44:17.494616 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_daily_trip_summary_summary_id.280471c2fc' was properly closed.
[0m23:44:17.495020 [debug] [MainThread]: Connection 'test.nyc_taxi.source_not_null_bronze_raw_taxi_trips_vendor_id.ab0aa85935' was properly closed.
[0m23:44:17.495288 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_payment_analysis_payment_type_label.5a6885a60b' was properly closed.
[0m23:44:17.495670 [info ] [MainThread]: 
[0m23:44:17.496120 [info ] [MainThread]: Finished running 51 tests in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m23:44:17.502778 [debug] [MainThread]: Command end result
[0m23:44:17.514706 [info ] [MainThread]: 
[0m23:44:17.515198 [info ] [MainThread]: [33mCompleted with 2 warnings:[0m
[0m23:44:17.515633 [info ] [MainThread]: 
[0m23:44:17.516027 [warn ] [MainThread]: [33mWarning in test not_null_cleaned_taxi_trips_vendor_id (models/silver/schema.yml)[0m
[0m23:44:17.516446 [warn ] [MainThread]: Got 9103 results, configured to warn if != 0
[0m23:44:17.516904 [info ] [MainThread]: 
[0m23:44:17.517355 [info ] [MainThread]:   compiled Code at target/compiled/nyc_taxi/models/silver/schema.yml/not_null_cleaned_taxi_trips_vendor_id.sql
[0m23:44:17.517801 [info ] [MainThread]: 
[0m23:44:17.518250 [warn ] [MainThread]: [33mWarning in test source_not_null_bronze_raw_taxi_trips_vendor_id (models/bronze/sources.yml)[0m
[0m23:44:17.518725 [warn ] [MainThread]: Got 10000 results, configured to warn if != 0
[0m23:44:17.519156 [info ] [MainThread]: 
[0m23:44:17.519594 [info ] [MainThread]:   compiled Code at target/compiled/nyc_taxi/models/bronze/sources.yml/source_not_null_bronze_raw_taxi_trips_vendor_id.sql
[0m23:44:17.520144 [info ] [MainThread]: 
[0m23:44:17.520635 [info ] [MainThread]: Done. PASS=49 WARN=2 ERROR=0 SKIP=0 TOTAL=51
[0m23:44:17.522702 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.4782844, "process_user_time": 3.749684, "process_kernel_time": 0.211739, "process_mem_max_rss": "111536", "process_in_blocks": "112", "process_out_blocks": "4048"}
[0m23:44:17.524459 [debug] [MainThread]: Command `dbt test` succeeded at 23:44:17.524272 after 2.48 seconds
[0m23:44:17.524951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e127ee290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e0efcae30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4e114723e0>]}
[0m23:44:17.525474 [debug] [MainThread]: Flushing usage events
